Program.Sub.ScreenSU.Start
Gui.F_Est_Maint..create
Gui.F_Est_Maint..caption("Estimator Maintenance")
Gui.F_Est_Maint..size(13305,9165)
Gui.F_Est_Maint..minx(0)
Gui.F_Est_Maint..miny(0)
Gui.F_Est_Maint..position(7980,3150)
Gui.F_Est_Maint..event(UnLoad,f_est_maint_unload)
Gui.F_Est_Maint..forecolor(0)
Gui.F_Est_Maint..BackColor(-2147483633)
Gui.F_Est_Maint..maxbutton(False)
Gui.F_Est_Maint..mousepointer(0)
Gui.F_Est_Maint..sizeable(False)
Gui.F_Est_Maint..ContextMenuCreate("ctxColor")
Gui.F_Est_Maint..ContextMenuAddItem("ctxColor","Add",0,"Add Row")
Gui.F_Est_Maint..ContextMenuAddItem("ctxColor","Delete",0,"Delete Row")
Gui.F_Est_Maint..ContextMenuSetItemEventHandler("ctxColor","Add","MenuClick")
Gui.F_Est_Maint..ContextMenuSetItemEventHandler("ctxColor","Delete","MenuClick")
Gui.F_Est_Maint..ContextMenuCreate("ctxMaterial")
Gui.F_Est_Maint..ContextMenuAddItem("ctxMaterial","Add",0,"Add Row")
Gui.F_Est_Maint..ContextMenuAddItem("ctxMaterial","Delete",0,"Delete Row")
Gui.F_Est_Maint..ContextMenuSetItemEventHandler("ctxMaterial","Add","fgWeb_Cmd")
Gui.F_Est_Maint..ContextMenuSetItemEventHandler("ctxMaterial","Delete","fgWeb_Cmd")
Gui.F_Est_Maint..ContextMenuCreate("ctxLabor")
Gui.F_Est_Maint..ContextMenuAddItem("ctxLabor","Add",0,"Add Row")
Gui.F_Est_Maint..ContextMenuAddItem("ctxLabor","Delete",0,"Delete Row")
Gui.F_Est_Maint..ContextMenuSetItemEventHandler("ctxLabor","Add","fgWeb_Cmd")
Gui.F_Est_Maint..ContextMenuSetItemEventHandler("ctxLabor","Delete","fgWeb_Cmd")
Gui.F_Est_Maint..ContextMenuCreate("ctxOther")
Gui.F_Est_Maint..ContextMenuAddItem("ctxOther","Add",0,"Add Row")
Gui.F_Est_Maint..ContextMenuAddItem("ctxOther","Delete",0,"Delete Row")
Gui.F_Est_Maint..ContextMenuSetItemEventHandler("ctxOther","Add","fgWeb_Cmd")
Gui.F_Est_Maint..ContextMenuSetItemEventHandler("ctxOther","Delete","fgWeb_Cmd")
Gui.F_Est_Maint.tabx1.create(tab)
Gui.F_Est_Maint.tabx1.TabStop(False)
Gui.F_Est_Maint.tabx1.size(12990,8520)
Gui.F_Est_Maint.tabx1.position(45,30)
Gui.F_Est_Maint.tabx1.event(Click,CMDMaterial)
Gui.F_Est_Maint.tabx1.Tabs(6)
Gui.F_Est_Maint.tabx1.SetTab(0)
Gui.F_Est_Maint.tabx1.Caption("Estimator")
Gui.F_Est_Maint.tabx1.SetTab(1)
Gui.F_Est_Maint.tabx1.Caption("Material")
Gui.F_Est_Maint.tabx1.SetTab(2)
Gui.F_Est_Maint.tabx1.Caption("Tooling")
Gui.F_Est_Maint.tabx1.SetTab(3)
Gui.F_Est_Maint.tabx1.Caption("Labor")
Gui.F_Est_Maint.tabx1.SetTab(4)
Gui.F_Est_Maint.tabx1.Caption("Websites")
Gui.F_Est_Maint.tabx1.SetTab(5)
Gui.F_Est_Maint.tabx1.Caption("Sort Code")
Gui.F_Est_Maint.frmWC.create(frame)
Gui.F_Est_Maint.frmWC.TabStop(True)
Gui.F_Est_Maint.frmWC.TabIndex(300)
Gui.F_Est_Maint.frmWC.caption("Workcenter Attributes")
Gui.F_Est_Maint.frmWC.parent("tabx1",3)
Gui.F_Est_Maint.frmWC.size(6240,7065)
Gui.F_Est_Maint.frmWC.position(45,240)
Gui.F_Est_Maint.gsfgLabAddAtt.create(gsGridControl)
Gui.F_Est_Maint.gsfgLabAddAtt.size(3330,6780)
Gui.F_Est_Maint.gsfgLabAddAtt.position(2805,180)
Gui.F_Est_Maint.gsfgLabAddAtt.parent("frmWC")
Gui.F_Est_Maint.lblLabWC.create(label,"Workcenter",True,960,255,1,200,260,True,0,Arial,8,-2147483633,0)
Gui.F_Est_Maint.lblLabWC.parent("frmWC")
Gui.F_Est_Maint.lblLabWC.defaultvalue("")
Gui.F_Est_Maint.txtLabWC.create(textbox,"",True,765,300,0,195,465,True,0,Arial,8,-2147483643,1)
Gui.F_Est_Maint.txtLabWC.parent("frmWC")
Gui.F_Est_Maint.txtLabWC.defaultvalue("")
Gui.F_Est_Maint.txtLabWC.tabstop(True)
Gui.F_Est_Maint.txtLabWC.tabindex(301)
Gui.F_Est_Maint.lbl20.create(label,"Work Group",False,1140,255,1,120,2565,True,0,Arial,8,-2147483633,0)
Gui.F_Est_Maint.lbl20.parent("frmWC")
Gui.F_Est_Maint.lbl20.defaultvalue("")
Gui.F_Est_Maint.ddlLabWG.create(dropdownlist)
Gui.F_Est_Maint.ddlLabWG.size(2580,330)
Gui.F_Est_Maint.ddlLabWG.position(150,2745)
Gui.F_Est_Maint.ddlLabWG.parent("frmWC")
Gui.F_Est_Maint.ddlLabWG.defaultvalue("")
Gui.F_Est_Maint.ddlLabWG.tabstop(False)
Gui.F_Est_Maint.ddlLabWG.Visible(False)
Gui.F_Est_Maint.lbl21.create(label,"Finish Group",False,1290,255,1,120,3165,True,0,Arial,8,-2147483633,0)
Gui.F_Est_Maint.lbl21.parent("frmWC")
Gui.F_Est_Maint.lbl21.defaultvalue("")
Gui.F_Est_Maint.ddlLabFG.create(dropdownlist)
Gui.F_Est_Maint.ddlLabFG.size(2580,330)
Gui.F_Est_Maint.ddlLabFG.position(120,3375)
Gui.F_Est_Maint.ddlLabFG.parent("frmWC")
Gui.F_Est_Maint.ddlLabFG.defaultvalue("")
Gui.F_Est_Maint.ddlLabFG.tabstop(False)
Gui.F_Est_Maint.ddlLabFG.Visible(False)
Gui.F_Est_Maint.cmdLabWC.create(button)
Gui.F_Est_Maint.cmdLabWC.caption("^")
Gui.F_Est_Maint.cmdLabWC.size(390,345)
Gui.F_Est_Maint.cmdLabWC.position(1050,435)
Gui.F_Est_Maint.cmdLabWC.parent("frmWC")
Gui.F_Est_Maint.cmdLabWC.event(Click,CMDLabor)
Gui.F_Est_Maint.cmdLabWC.defaultvalue("")
Gui.F_Est_Maint.cmdLabWC.tabstop(True)
Gui.F_Est_Maint.cmdLabWC.tabindex(302)
Gui.F_Est_Maint.lbl22.create(label,"Location",True,930,255,1,1770,255,True,0,Arial,8,-2147483633,0)
Gui.F_Est_Maint.lbl22.parent("frmWC")
Gui.F_Est_Maint.lbl22.defaultvalue("")
Gui.F_Est_Maint.txtLabWCLoc.create(textbox,"",True,405,300,0,1755,465,True,0,Arial,8,-2147483643,1)
Gui.F_Est_Maint.txtLabWCLoc.parent("frmWC")
Gui.F_Est_Maint.txtLabWCLoc.defaultvalue("")
Gui.F_Est_Maint.txtLabWCLoc.tabstop(True)
Gui.F_Est_Maint.txtLabWCLoc.tabindex(303)
Gui.F_Est_Maint.cmdLabWCLoc.create(button)
Gui.F_Est_Maint.cmdLabWCLoc.caption("^")
Gui.F_Est_Maint.cmdLabWCLoc.size(390,345)
Gui.F_Est_Maint.cmdLabWCLoc.position(2265,435)
Gui.F_Est_Maint.cmdLabWCLoc.parent("frmWC")
Gui.F_Est_Maint.cmdLabWCLoc.event(Click,CMDLabor)
Gui.F_Est_Maint.cmdLabWCLoc.defaultvalue("")
Gui.F_Est_Maint.cmdLabWCLoc.tabstop(True)
Gui.F_Est_Maint.cmdLabWCLoc.tabindex(304)
Gui.F_Est_Maint.cmdLabSaveWC.create(button)
Gui.F_Est_Maint.cmdLabSaveWC.caption("Save WC")
Gui.F_Est_Maint.cmdLabSaveWC.size(915,375)
Gui.F_Est_Maint.cmdLabSaveWC.position(195,900)
Gui.F_Est_Maint.cmdLabSaveWC.parent("frmWC")
Gui.F_Est_Maint.cmdLabSaveWC.event(Click,CMDLabor)
Gui.F_Est_Maint.cmdLabSaveWC.defaultvalue("")
Gui.F_Est_Maint.cmdLabSaveWC.tabstop(True)
Gui.F_Est_Maint.cmdLabSaveWC.tabindex(305)
Gui.F_Est_Maint.cmdLabWCClear.create(button)
Gui.F_Est_Maint.cmdLabWCClear.caption("Clear")
Gui.F_Est_Maint.cmdLabWCClear.size(855,375)
Gui.F_Est_Maint.cmdLabWCClear.position(1185,900)
Gui.F_Est_Maint.cmdLabWCClear.parent("frmWC")
Gui.F_Est_Maint.cmdLabWCClear.event(Click,CMDLabor)
Gui.F_Est_Maint.cmdLabWCClear.defaultvalue("")
Gui.F_Est_Maint.cmdLabWCClear.tabstop(True)
Gui.F_Est_Maint.cmdLabWCClear.tabindex(306)
Gui.F_Est_Maint.frmWGroup.create(frame)
Gui.F_Est_Maint.frmWGroup.caption("Work Group Setup")
Gui.F_Est_Maint.frmWGroup.parent("tabx1",3)
Gui.F_Est_Maint.frmWGroup.size(3825,1440)
Gui.F_Est_Maint.frmWGroup.position(7020,240)
Gui.F_Est_Maint.frmWGroup.Visible(False)
Gui.F_Est_Maint.txtLabWGID.create(textbox,"",False,405,300,0,195,435,False,0,Arial,8,-2147483643,1)
Gui.F_Est_Maint.txtLabWGID.parent("frmWGroup")
Gui.F_Est_Maint.txtLabWGID.defaultvalue("")
Gui.F_Est_Maint.lblWGDesc.create(label,"Description",False,945,255,1,720,225,True,0,Arial,8,-2147483633,0)
Gui.F_Est_Maint.lblWGDesc.parent("frmWGroup")
Gui.F_Est_Maint.lblWGDesc.defaultvalue("")
Gui.F_Est_Maint.txtLabWGDesc.create(textbox,"",False,2610,300,0,705,435,True,0,Arial,8,-2147483643,1)
Gui.F_Est_Maint.txtLabWGDesc.parent("frmWGroup")
Gui.F_Est_Maint.txtLabWGDesc.event(LostFocus,CMDLabor)
Gui.F_Est_Maint.txtLabWGDesc.defaultvalue("")
Gui.F_Est_Maint.txtLabWGDesc.tabstop(False)
Gui.F_Est_Maint.cmdLabWGBrowse.create(button)
Gui.F_Est_Maint.cmdLabWGBrowse.caption("^")
Gui.F_Est_Maint.cmdLabWGBrowse.size(390,345)
Gui.F_Est_Maint.cmdLabWGBrowse.position(3345,385)
Gui.F_Est_Maint.cmdLabWGBrowse.parent("frmWGroup")
Gui.F_Est_Maint.cmdLabWGBrowse.event(Click,CMDLabor)
Gui.F_Est_Maint.cmdLabWGBrowse.defaultvalue("")
Gui.F_Est_Maint.cmdLabWGBrowse.tabstop(False)
Gui.F_Est_Maint.cmdLabWGSave.create(button)
Gui.F_Est_Maint.cmdLabWGSave.caption("Save")
Gui.F_Est_Maint.cmdLabWGSave.size(855,375)
Gui.F_Est_Maint.cmdLabWGSave.position(180,810)
Gui.F_Est_Maint.cmdLabWGSave.parent("frmWGroup")
Gui.F_Est_Maint.cmdLabWGSave.event(Click,CMDLabor)
Gui.F_Est_Maint.cmdLabWGSave.defaultvalue("")
Gui.F_Est_Maint.cmdLabWGSave.tabstop(False)
Gui.F_Est_Maint.cmdLabWGSave.Visible(False)
Gui.F_Est_Maint.lbl25.create(label,"ID",False,270,210,1,195,225,True,0,Arial,8,-2147483633,0)
Gui.F_Est_Maint.lbl25.parent("frmWGroup")
Gui.F_Est_Maint.lbl25.defaultvalue("")
Gui.F_Est_Maint.cmdLabWGClear.create(button)
Gui.F_Est_Maint.cmdLabWGClear.caption("Clear")
Gui.F_Est_Maint.cmdLabWGClear.size(855,375)
Gui.F_Est_Maint.cmdLabWGClear.position(1170,810)
Gui.F_Est_Maint.cmdLabWGClear.parent("frmWGroup")
Gui.F_Est_Maint.cmdLabWGClear.event(Click,CMDLabor)
Gui.F_Est_Maint.cmdLabWGClear.defaultvalue("")
Gui.F_Est_Maint.cmdLabWGClear.tabstop(False)
Gui.F_Est_Maint.cmdLabWGClear.Visible(False)
Gui.F_Est_Maint.frmFGroup.create(frame)
Gui.F_Est_Maint.frmFGroup.caption("Finish Group Setup")
Gui.F_Est_Maint.frmFGroup.parent("tabx1",3)
Gui.F_Est_Maint.frmFGroup.size(3825,1440)
Gui.F_Est_Maint.frmFGroup.position(7005,1785)
Gui.F_Est_Maint.frmFGroup.Visible(False)
Gui.F_Est_Maint.lbl23.create(label,"ID",False,270,210,1,195,225,True,0,Arial,8,-2147483633,0)
Gui.F_Est_Maint.lbl23.parent("frmFGroup")
Gui.F_Est_Maint.lbl23.defaultvalue("")
Gui.F_Est_Maint.txtLabFGID.create(textbox,"",False,405,300,0,195,435,False,0,Arial,8,-2147483643,1)
Gui.F_Est_Maint.txtLabFGID.parent("frmFGroup")
Gui.F_Est_Maint.txtLabFGID.defaultvalue("")
Gui.F_Est_Maint.txtLabFGDesc.create(textbox,"",False,2610,300,0,705,435,True,0,Arial,8,-2147483643,1)
Gui.F_Est_Maint.txtLabFGDesc.parent("frmFGroup")
Gui.F_Est_Maint.txtLabFGDesc.event(LostFocus,CMDLabor)
Gui.F_Est_Maint.txtLabFGDesc.defaultvalue("")
Gui.F_Est_Maint.txtLabFGDesc.tabstop(False)
Gui.F_Est_Maint.lblFGDesc.create(label,"Description",False,945,255,1,720,225,True,0,Arial,8,-2147483633,0)
Gui.F_Est_Maint.lblFGDesc.parent("frmFGroup")
Gui.F_Est_Maint.lblFGDesc.defaultvalue("")
Gui.F_Est_Maint.cmdLabFGSave.create(button)
Gui.F_Est_Maint.cmdLabFGSave.caption("Save")
Gui.F_Est_Maint.cmdLabFGSave.size(855,375)
Gui.F_Est_Maint.cmdLabFGSave.position(180,810)
Gui.F_Est_Maint.cmdLabFGSave.parent("frmFGroup")
Gui.F_Est_Maint.cmdLabFGSave.event(Click,CMDLabor)
Gui.F_Est_Maint.cmdLabFGSave.defaultvalue("")
Gui.F_Est_Maint.cmdLabFGSave.tabstop(False)
Gui.F_Est_Maint.cmdLabFGSave.Visible(False)
Gui.F_Est_Maint.cmdLabFGClear.create(button)
Gui.F_Est_Maint.cmdLabFGClear.caption("Clear")
Gui.F_Est_Maint.cmdLabFGClear.size(855,375)
Gui.F_Est_Maint.cmdLabFGClear.position(1170,810)
Gui.F_Est_Maint.cmdLabFGClear.parent("frmFGroup")
Gui.F_Est_Maint.cmdLabFGClear.event(Click,CMDLabor)
Gui.F_Est_Maint.cmdLabFGClear.defaultvalue("")
Gui.F_Est_Maint.cmdLabFGClear.tabstop(False)
Gui.F_Est_Maint.cmdLabFGClear.Visible(False)
Gui.F_Est_Maint.lbl1.create(label,"Material",True,885,255,1,150,45,True,0,Arial,8,-2147483633,0)
Gui.F_Est_Maint.lbl1.parent("tabx1",4)
Gui.F_Est_Maint.lbl1.defaultvalue("")
Gui.F_Est_Maint.gsfgMaterial.create(GsGridControl)
Gui.F_Est_Maint.gsfgMaterial.size(8340,1815)
Gui.F_Est_Maint.gsfgMaterial.position(150,240)
Gui.F_Est_Maint.gsfgMaterial.parent("tabx1",4)
Gui.F_Est_Maint.gsfgMaterial.ContextMenuAttach("ctxMaterial")
Gui.F_Est_Maint.lbl2.create(label,"Labor",True,570,195,1,150,2140,True,0,Arial,8,-2147483633,0)
Gui.F_Est_Maint.lbl2.parent("tabx1",4)
Gui.F_Est_Maint.lbl2.defaultvalue("")
Gui.F_Est_Maint.gsfgLabor.create(GsGridControl)
Gui.F_Est_Maint.gsfgLabor.size(8340,1785)
Gui.F_Est_Maint.gsfgLabor.position(150,2340)
Gui.F_Est_Maint.gsfgLabor.parent("tabx1",4)
Gui.F_Est_Maint.gsfgLabor.ContextMenuAttach("ctxLabor")
Gui.F_Est_Maint.lbl3.create(label,"Other",True,495,255,1,150,4240,True,0,Arial,8,-2147483633,0)
Gui.F_Est_Maint.lbl3.parent("tabx1",4)
Gui.F_Est_Maint.lbl3.defaultvalue("")
Gui.F_Est_Maint.gsfgOther.create(GsGridControl)
Gui.F_Est_Maint.gsfgOther.size(8355,1785)
Gui.F_Est_Maint.gsfgOther.position(150,4440)
Gui.F_Est_Maint.gsfgOther.parent("tabx1",4)
Gui.F_Est_Maint.gsfgOther.ContextMenuAttach("ctxOther")
Gui.F_Est_Maint.lbl4.create(label,"Additional Workcenter Runtimes",True,3375,255,1,150,45,True,0,Arial,8,-2147483633,0)
Gui.F_Est_Maint.lbl4.parent("tabx1",3)
Gui.F_Est_Maint.lbl4.defaultvalue("")
Gui.F_Est_Maint.lbl5.create(label,"Part",True,465,225,1,150,15,True,0,Arial,8,-2147483633,0)
Gui.F_Est_Maint.lbl5.parent("tabx1",1)
Gui.F_Est_Maint.lbl5.defaultvalue("")
Gui.F_Est_Maint.txtMatPart.create(textbox,"",True,1830,300,0,150,210,True,0,Arial,8,-2147483643,1)
Gui.F_Est_Maint.txtMatPart.parent("tabx1",1)
Gui.F_Est_Maint.txtMatPart.maxLength(20)
Gui.F_Est_Maint.txtMatPart.defaultvalue("")
Gui.F_Est_Maint.txtMatPart.tabstop(True)
Gui.F_Est_Maint.txtMatPart.tabindex(100)
Gui.F_Est_Maint.txtMatLoc.create(textbox,"",True,450,300,0,2055,210,True,0,Arial,8,-2147483643,1)
Gui.F_Est_Maint.txtMatLoc.parent("tabx1",1)
Gui.F_Est_Maint.txtMatLoc.maxLength(2)
Gui.F_Est_Maint.txtMatLoc.event(LostFocus,txtmatloc_lostfocus)
Gui.F_Est_Maint.txtMatLoc.defaultvalue("")
Gui.F_Est_Maint.txtMatLoc.TabStop(True)
Gui.F_Est_Maint.txtMatLoc.TabIndex(101)
Gui.F_Est_Maint.lbl6.create(label,"Loc",True,345,225,1,2055,15,True,0,Arial,8,-2147483633,0)
Gui.F_Est_Maint.lbl6.parent("tabx1",1)
Gui.F_Est_Maint.lbl6.defaultvalue("")
Gui.F_Est_Maint.lbl7.create(label,"Part Description",True,1995,225,1,3120,15,True,0,Arial,8,-2147483633,0)
Gui.F_Est_Maint.lbl7.parent("tabx1",1)
Gui.F_Est_Maint.lbl7.defaultvalue("")
Gui.F_Est_Maint.txtMatDesc.create(textbox,"",True,2835,300,0,3120,210,False,0,Arial,8,-2147483643,1)
Gui.F_Est_Maint.txtMatDesc.parent("tabx1",1)
Gui.F_Est_Maint.txtMatDesc.maxLength(30)
Gui.F_Est_Maint.txtMatDesc.defaultvalue("")
Gui.F_Est_Maint.cmdMatBrowse.create(button)
Gui.F_Est_Maint.cmdMatBrowse.caption("^")
Gui.F_Est_Maint.cmdMatBrowse.size(495,330)
Gui.F_Est_Maint.cmdMatBrowse.position(2535,180)
Gui.F_Est_Maint.cmdMatBrowse.parent("tabx1",1)
Gui.F_Est_Maint.cmdMatBrowse.event(Click,CMDMaterial)
Gui.F_Est_Maint.cmdMatBrowse.defaultvalue("")
Gui.F_Est_Maint.cmdMatBrowse.tabstop(True)
Gui.F_Est_Maint.cmdMatBrowse.tabindex(102)
Gui.F_Est_Maint.lbl9.create(label,"Adhesive Code",True,1200,210,1,150,2205,True,0,Arial,8,-2147483633,0)
Gui.F_Est_Maint.lbl9.parent("tabx1",1)
Gui.F_Est_Maint.lbl9.defaultvalue("")
Gui.F_Est_Maint.txtMatAC.create(textbox,"",True,2070,300,0,150,2400,True,0,Arial,8,-2147483643,1)
Gui.F_Est_Maint.txtMatAC.parent("tabx1",1)
Gui.F_Est_Maint.txtMatAC.maxLength(15)
Gui.F_Est_Maint.txtMatAC.defaultvalue("")
Gui.F_Est_Maint.txtMatAC.tabstop(True)
Gui.F_Est_Maint.txtMatAC.tabindex(107)
Gui.F_Est_Maint.lbl10.create(label,"Liner",True,975,210,1,150,2760,True,0,Arial,8,-2147483633,0)
Gui.F_Est_Maint.lbl10.parent("tabx1",1)
Gui.F_Est_Maint.lbl10.defaultvalue("")
Gui.F_Est_Maint.txtMatLineWeight.create(textbox,"",True,1170,300,0,150,2955,True,0,Arial,8,-2147483643,1)
Gui.F_Est_Maint.txtMatLineWeight.parent("tabx1",1)
Gui.F_Est_Maint.txtMatLineWeight.defaultvalue("0")
Gui.F_Est_Maint.txtMatLineWeight.tabstop(True)
Gui.F_Est_Maint.txtMatLineWeight.tabindex(109)
Gui.F_Est_Maint.lbl11.create(label,"Adhesive Type",True,1230,210,1,150,1650,True,0,Arial,8,-2147483633,0)
Gui.F_Est_Maint.lbl11.parent("tabx1",1)
Gui.F_Est_Maint.lbl11.defaultvalue("")
Gui.F_Est_Maint.txtMatAdType.create(textbox,"",True,3495,300,0,150,1845,True,0,Arial,8,-2147483643,1)
Gui.F_Est_Maint.txtMatAdType.parent("tabx1",1)
Gui.F_Est_Maint.txtMatAdType.maxLength(35)
Gui.F_Est_Maint.txtMatAdType.defaultvalue("")
Gui.F_Est_Maint.txtMatAdType.tabstop(True)
Gui.F_Est_Maint.txtMatAdType.tabindex(106)
Gui.F_Est_Maint.lbl14.create(label,"Min Applic ?F",True,1290,180,1,150,4425,True,0,Arial,8,-2147483633,0)
Gui.F_Est_Maint.lbl14.parent("tabx1",1)
Gui.F_Est_Maint.lbl14.defaultvalue("")
Gui.F_Est_Maint.txtMatMAF.create(textbox,"",True,1215,300,0,150,4620,True,1,Arial,8,-2147483643,1)
Gui.F_Est_Maint.txtMatMAF.parent("tabx1",1)
Gui.F_Est_Maint.txtMatMAF.numericonly(1)
Gui.F_Est_Maint.txtMatMAF.defaultvalue("0")
Gui.F_Est_Maint.txtMatMAF.tabstop(True)
Gui.F_Est_Maint.txtMatMAF.tabindex(114)
Gui.F_Est_Maint.lbl12.create(label,"Service Temp Low ?F",True,1695,180,1,150,4980,True,0,Arial,8,-2147483633,0)
Gui.F_Est_Maint.lbl12.parent("tabx1",1)
Gui.F_Est_Maint.lbl12.defaultvalue("")
Gui.F_Est_Maint.txtMatSTLF.create(textbox,"",True,1635,300,0,150,5175,True,1,Arial,8,-2147483643,1)
Gui.F_Est_Maint.txtMatSTLF.parent("tabx1",1)
Gui.F_Est_Maint.txtMatSTLF.numericonly(1)
Gui.F_Est_Maint.txtMatSTLF.defaultvalue("0")
Gui.F_Est_Maint.txtMatSTLF.tabstop(True)
Gui.F_Est_Maint.txtMatSTLF.tabindex(115)
Gui.F_Est_Maint.lbl13.create(label,"Thickness (Caliper)",True,1665,210,1,150,3300,True,0,Arial,8,-2147483633,0)
Gui.F_Est_Maint.lbl13.parent("tabx1",1)
Gui.F_Est_Maint.lbl13.defaultvalue("")
Gui.F_Est_Maint.txtMatThick.create(textbox,"",True,1410,300,0,150,3495,True,1,Arial,8,-2147483643,1)
Gui.F_Est_Maint.txtMatThick.parent("tabx1",1)
Gui.F_Est_Maint.txtMatThick.numericonly(1)
Gui.F_Est_Maint.txtMatThick.defaultvalue("0")
Gui.F_Est_Maint.txtMatThick.tabstop(True)
Gui.F_Est_Maint.txtMatThick.tabindex(110)
Gui.F_Est_Maint.lbl16.create(label,"Comment",True,1125,210,1,150,6075,True,0,Arial,8,-2147483633,0)
Gui.F_Est_Maint.lbl16.parent("tabx1",1)
Gui.F_Est_Maint.lbl16.defaultvalue("")
Gui.F_Est_Maint.mltMatComment.create(textboxm)
Gui.F_Est_Maint.mltMatComment.size(8925,930)
Gui.F_Est_Maint.mltMatComment.position(150,6300)
Gui.F_Est_Maint.mltMatComment.parent("tabx1",1)
Gui.F_Est_Maint.mltMatComment.maxLength(500)
Gui.F_Est_Maint.mltMatComment.defaultvalue("")
Gui.F_Est_Maint.mltMatComment.tabstop(True)
Gui.F_Est_Maint.mltMatComment.tabindex(117)
Gui.F_Est_Maint.lbl17.create(label,"Service Temp Low ?C",False,1755,180,1,10770,6960,True,0,Arial,8,-2147483633,0)
Gui.F_Est_Maint.lbl17.parent("tabx1",1)
Gui.F_Est_Maint.lbl17.defaultvalue("")
Gui.F_Est_Maint.txtMatSTLC.create(textbox,"",False,1635,300,0,10770,7155,True,1,Arial,8,-2147483643,1)
Gui.F_Est_Maint.txtMatSTLC.parent("tabx1",1)
Gui.F_Est_Maint.txtMatSTLC.numericonly(1)
Gui.F_Est_Maint.txtMatSTLC.defaultvalue("0")
Gui.F_Est_Maint.txtMatSTLC.tabstop(False)
Gui.F_Est_Maint.lbl27.create(label,"Shape",True,840,195,1,135,720,True,0,Arial,8,-2147483633,0)
Gui.F_Est_Maint.lbl27.parent("tabx1",2)
Gui.F_Est_Maint.lbl27.defaultvalue("")
Gui.F_Est_Maint.txtTolShape.create(textbox,"",True,750,300,0,135,915,True,0,Arial,8,-2147483643,1)
Gui.F_Est_Maint.txtTolShape.parent("tabx1",2)
Gui.F_Est_Maint.txtTolShape.defaultvalue("")
Gui.F_Est_Maint.txtTolShape.tabstop(True)
Gui.F_Est_Maint.txtTolShape.tabindex(203)
Gui.F_Est_Maint.lbl28.create(label,"Shape Desc",True,960,210,1,4785,1905,True,0,Arial,8,-2147483633,0)
Gui.F_Est_Maint.lbl28.parent("tabx1",2)
Gui.F_Est_Maint.lbl28.defaultvalue("")
Gui.F_Est_Maint.txtTolShapeDesc.create(textbox,"",True,2835,300,0,4785,2100,True,0,Arial,8,-2147483643,1)
Gui.F_Est_Maint.txtTolShapeDesc.parent("tabx1",2)
Gui.F_Est_Maint.txtTolShapeDesc.maxLength(30)
Gui.F_Est_Maint.txtTolShapeDesc.defaultvalue("")
Gui.F_Est_Maint.txtTolShapeDesc.tabstop(True)
Gui.F_Est_Maint.txtTolShapeDesc.tabindex(213)
Gui.F_Est_Maint.lbl29.create(label,"Tooth Size",True,930,210,1,135,2475,True,0,Arial,8,-2147483633,0)
Gui.F_Est_Maint.lbl29.parent("tabx1",2)
Gui.F_Est_Maint.lbl29.defaultvalue("")
Gui.F_Est_Maint.txtTolToothSize.create(textbox,"",True,780,300,0,135,2670,True,1,Arial,8,-2147483643,1)
Gui.F_Est_Maint.txtTolToothSize.parent("tabx1",2)
Gui.F_Est_Maint.txtTolToothSize.numericonly(1)
Gui.F_Est_Maint.txtTolToothSize.defaultvalue("0")
Gui.F_Est_Maint.txtTolToothSize.TabStop(True)
Gui.F_Est_Maint.txtTolToothSize.TabIndex(214)
Gui.F_Est_Maint.lbl30.create(label,"Cav Across",False,1080,195,1,2475,5550,True,0,Arial,8,-2147483633,0)
Gui.F_Est_Maint.lbl30.parent("tabx1",2)
Gui.F_Est_Maint.lbl30.defaultvalue("")
Gui.F_Est_Maint.txtTolCavAcross.create(textbox,"",False,1005,300,0,2475,5745,True,1,Arial,8,-2147483643,1)
Gui.F_Est_Maint.txtTolCavAcross.parent("tabx1",2)
Gui.F_Est_Maint.txtTolCavAcross.numericonly(2)
Gui.F_Est_Maint.txtTolCavAcross.defaultvalue("0")
Gui.F_Est_Maint.txtTolCavAcross.tabstop(False)
Gui.F_Est_Maint.lbl31.create(label,"Cav Around",False,1110,195,1,3675,5550,True,0,Arial,8,-2147483633,0)
Gui.F_Est_Maint.lbl31.parent("tabx1",2)
Gui.F_Est_Maint.lbl31.defaultvalue("")
Gui.F_Est_Maint.txtTolCavAround.create(textbox,"",False,1005,300,0,3675,5745,True,1,Arial,8,-2147483643,1)
Gui.F_Est_Maint.txtTolCavAround.parent("tabx1",2)
Gui.F_Est_Maint.txtTolCavAround.numericonly(2)
Gui.F_Est_Maint.txtTolCavAround.defaultvalue("0")
Gui.F_Est_Maint.txtTolCavAround.tabstop(False)
Gui.F_Est_Maint.lbl32.create(label,"Corner Radii",True,1170,210,1,135,1905,True,0,Arial,8,-2147483633,0)
Gui.F_Est_Maint.lbl32.parent("tabx1",2)
Gui.F_Est_Maint.lbl32.defaultvalue("")
Gui.F_Est_Maint.txtTolCorner.create(textbox,"",True,1005,300,0,135,2100,True,1,Arial,8,-2147483643,1)
Gui.F_Est_Maint.txtTolCorner.parent("tabx1",2)
Gui.F_Est_Maint.txtTolCorner.numericonly(1)
Gui.F_Est_Maint.txtTolCorner.defaultvalue("0")
Gui.F_Est_Maint.txtTolCorner.tabstop(True)
Gui.F_Est_Maint.txtTolCorner.tabindex(210)
Gui.F_Est_Maint.lbl33.create(label,"Mat Used",True,825,210,1,2835,1905,True,0,Arial,8,-2147483633,0)
Gui.F_Est_Maint.lbl33.parent("tabx1",2)
Gui.F_Est_Maint.lbl33.defaultvalue("")
Gui.F_Est_Maint.txtTolUsed.create(textbox,"",True,1740,300,0,2835,2100,True,0,Arial,8,-2147483643,1)
Gui.F_Est_Maint.txtTolUsed.parent("tabx1",2)
Gui.F_Est_Maint.txtTolUsed.maxLength(20)
Gui.F_Est_Maint.txtTolUsed.defaultvalue("")
Gui.F_Est_Maint.txtTolUsed.tabstop(True)
Gui.F_Est_Maint.txtTolUsed.tabindex(212)
Gui.F_Est_Maint.lbl34.create(label,"Step Across",False,1050,210,1,5640,6660,True,0,Arial,8,-2147483633,0)
Gui.F_Est_Maint.lbl34.parent("tabx1",2)
Gui.F_Est_Maint.lbl34.defaultvalue("")
Gui.F_Est_Maint.txtTolStepAcross.create(textbox,"",False,1020,300,0,5640,6855,True,1,Arial,8,-2147483643,1)
Gui.F_Est_Maint.txtTolStepAcross.parent("tabx1",2)
Gui.F_Est_Maint.txtTolStepAcross.numericonly(1)
Gui.F_Est_Maint.txtTolStepAcross.defaultvalue("0")
Gui.F_Est_Maint.lbl35.create(label,"Step Around",False,1050,210,1,6810,6660,True,0,Arial,8,-2147483633,0)
Gui.F_Est_Maint.lbl35.parent("tabx1",2)
Gui.F_Est_Maint.lbl35.defaultvalue("")
Gui.F_Est_Maint.txtTolStepAround.create(textbox,"",False,1050,300,0,6810,6855,True,1,Arial,8,-2147483643,1)
Gui.F_Est_Maint.txtTolStepAround.parent("tabx1",2)
Gui.F_Est_Maint.txtTolStepAround.numericonly(1)
Gui.F_Est_Maint.txtTolStepAround.defaultvalue("0")
Gui.F_Est_Maint.lbl36.create(label,"ACR Die",False,705,210,1,2475,6105,True,0,Arial,8,-2147483633,0)
Gui.F_Est_Maint.lbl36.parent("tabx1",2)
Gui.F_Est_Maint.lbl36.defaultvalue("")
Gui.F_Est_Maint.txtTolACRDie.create(textbox,"",False,2550,300,0,2475,6300,True,0,Arial,8,-2147483643,1)
Gui.F_Est_Maint.txtTolACRDie.parent("tabx1",2)
Gui.F_Est_Maint.txtTolACRDie.maxLength(20)
Gui.F_Est_Maint.txtTolACRDie.defaultvalue("")
Gui.F_Est_Maint.lbl37.create(label,"ACR Press",False,1050,210,1,5175,6105,True,0,Arial,8,-2147483633,0)
Gui.F_Est_Maint.lbl37.parent("tabx1",2)
Gui.F_Est_Maint.lbl37.defaultvalue("")
Gui.F_Est_Maint.txtTolACRPress.create(textbox,"",False,2550,300,0,5175,6300,True,0,Arial,8,-2147483643,1)
Gui.F_Est_Maint.txtTolACRPress.parent("tabx1",2)
Gui.F_Est_Maint.txtTolACRPress.maxLength(20)
Gui.F_Est_Maint.txtTolACRPress.defaultvalue("")
Gui.F_Est_Maint.txtTolACRFin.create(textbox,"",False,2550,300,0,7860,6300,True,0,Arial,8,-2147483643,1)
Gui.F_Est_Maint.txtTolACRFin.parent("tabx1",2)
Gui.F_Est_Maint.txtTolACRFin.maxLength(20)
Gui.F_Est_Maint.txtTolACRFin.defaultvalue("")
Gui.F_Est_Maint.lbl38.create(label,"ACR Fin",False,720,210,1,7860,6105,True,0,Arial,8,-2147483633,0)
Gui.F_Est_Maint.lbl38.parent("tabx1",2)
Gui.F_Est_Maint.lbl38.defaultvalue("")
Gui.F_Est_Maint.lbl39.create(label,"Sort Code",True,825,225,1,6075,15,True,0,Arial,8,-2147483633,0)
Gui.F_Est_Maint.lbl39.parent("tabx1",1)
Gui.F_Est_Maint.lbl39.defaultvalue("")
Gui.F_Est_Maint.txtMatSC.create(textbox,"",True,2085,300,0,6060,210,False,0,Arial,8,-2147483643,1)
Gui.F_Est_Maint.txtMatSC.parent("tabx1",1)
Gui.F_Est_Maint.txtMatSC.defaultvalue("")
Gui.F_Est_Maint.lbl40.create(label,"Tool Number",True,1020,210,1,135,3060,True,0,Arial,8,-2147483633,0)
Gui.F_Est_Maint.lbl40.parent("tabx1",2)
Gui.F_Est_Maint.lbl40.defaultvalue("")
Gui.F_Est_Maint.txtTolToolNum.create(textbox,"",True,1680,300,0,135,3255,True,1,Arial,8,-2147483643,1)
Gui.F_Est_Maint.txtTolToolNum.parent("tabx1",2)
Gui.F_Est_Maint.txtTolToolNum.numericonly(1)
Gui.F_Est_Maint.txtTolToolNum.maxLength(10)
Gui.F_Est_Maint.txtTolToolNum.defaultvalue("0")
Gui.F_Est_Maint.txtTolToolNum.TabStop(True)
Gui.F_Est_Maint.txtTolToolNum.TabIndex(219)
Gui.F_Est_Maint.lbl41.create(label,"Internal Lbl Width",True,1395,195,1,3375,2475,True,0,Arial,8,-2147483633,0)
Gui.F_Est_Maint.lbl41.parent("tabx1",2)
Gui.F_Est_Maint.lbl41.defaultvalue("")
Gui.F_Est_Maint.txtTolInternalLblWidth.create(textbox,"",True,1215,300,0,3375,2670,True,1,Arial,8,-2147483643,1)
Gui.F_Est_Maint.txtTolInternalLblWidth.parent("tabx1",2)
Gui.F_Est_Maint.txtTolInternalLblWidth.numericonly(1)
Gui.F_Est_Maint.txtTolInternalLblWidth.defaultvalue("0")
Gui.F_Est_Maint.txtTolInternalLblWidth.tabstop(True)
Gui.F_Est_Maint.txtTolInternalLblWidth.tabindex(216)
Gui.F_Est_Maint.lbl43.create(label,"Internal Lbl Length",True,1470,195,1,4800,2475,True,0,Arial,8,-2147483633,0)
Gui.F_Est_Maint.lbl43.parent("tabx1",2)
Gui.F_Est_Maint.lbl43.defaultvalue("")
Gui.F_Est_Maint.txtTolInternalLblNum.create(textbox,"",True,1215,300,0,6300,2670,True,1,Arial,8,-2147483643,1)
Gui.F_Est_Maint.txtTolInternalLblNum.parent("tabx1",2)
Gui.F_Est_Maint.txtTolInternalLblNum.numericonly(1)
Gui.F_Est_Maint.txtTolInternalLblNum.defaultvalue("0")
Gui.F_Est_Maint.txtTolInternalLblNum.TabStop(True)
Gui.F_Est_Maint.txtTolInternalLblNum.TabIndex(218)
Gui.F_Est_Maint.txtTolInternalLblLength.create(textbox,"",True,1215,300,0,4800,2670,True,1,Arial,8,-2147483643,1)
Gui.F_Est_Maint.txtTolInternalLblLength.parent("tabx1",2)
Gui.F_Est_Maint.txtTolInternalLblLength.numericonly(1)
Gui.F_Est_Maint.txtTolInternalLblLength.defaultvalue("0")
Gui.F_Est_Maint.txtTolInternalLblLength.tabstop(True)
Gui.F_Est_Maint.txtTolInternalLblLength.tabindex(217)
Gui.F_Est_Maint.lbl42.create(label,"Internal Lbl Numout",True,1605,195,1,6300,2475,True,0,Arial,8,-2147483633,0)
Gui.F_Est_Maint.lbl42.parent("tabx1",2)
Gui.F_Est_Maint.lbl42.defaultvalue("")
Gui.F_Est_Maint.txtTolStatus.create(textbox,"",True,2025,300,0,1110,2670,True,0,Arial,8,-2147483643,1)
Gui.F_Est_Maint.txtTolStatus.parent("tabx1",2)
Gui.F_Est_Maint.txtTolStatus.maxLength(20)
Gui.F_Est_Maint.txtTolStatus.defaultvalue("")
Gui.F_Est_Maint.txtTolStatus.TabStop(True)
Gui.F_Est_Maint.txtTolStatus.TabIndex(215)
Gui.F_Est_Maint.lbl44.create(label,"Status",True,615,210,1,1110,2475,True,0,Arial,8,-2147483633,0)
Gui.F_Est_Maint.lbl44.parent("tabx1",2)
Gui.F_Est_Maint.lbl44.defaultvalue("")
Gui.F_Est_Maint.txtTolWasteEdge.create(textbox,"",False,2025,300,0,8040,6855,True,1,Arial,8,-2147483643,1)
Gui.F_Est_Maint.txtTolWasteEdge.parent("tabx1",2)
Gui.F_Est_Maint.txtTolWasteEdge.numericonly(1)
Gui.F_Est_Maint.txtTolWasteEdge.maxLength(15)
Gui.F_Est_Maint.txtTolWasteEdge.defaultvalue("0")
Gui.F_Est_Maint.lbl45.create(label,"Waste Edge",False,1020,210,1,8040,6660,True,0,Arial,8,-2147483633,0)
Gui.F_Est_Maint.lbl45.parent("tabx1",2)
Gui.F_Est_Maint.lbl45.defaultvalue("")
Gui.F_Est_Maint.chkTolMinWaved.create(checkbox)
Gui.F_Est_Maint.chkTolMinWaved.caption("Minimum Waved")
Gui.F_Est_Maint.chkTolMinWaved.size(1500,255)
Gui.F_Est_Maint.chkTolMinWaved.position(2145,3540)
Gui.F_Est_Maint.chkTolMinWaved.parent("tabx1",1)
Gui.F_Est_Maint.chkTolMinWaved.defaultvalue("")
Gui.F_Est_Maint.chkTolMinWaved.TabStop(True)
Gui.F_Est_Maint.chkTolMinWaved.TabIndex(112)
Gui.F_Est_Maint.txtMatLbs.create(textbox,"",True,1170,300,0,150,4050,True,1,Arial,8,-2147483643,1)
Gui.F_Est_Maint.txtMatLbs.parent("tabx1",1)
Gui.F_Est_Maint.txtMatLbs.numericonly(1)
Gui.F_Est_Maint.txtMatLbs.defaultvalue("0")
Gui.F_Est_Maint.txtMatLbs.tabstop(True)
Gui.F_Est_Maint.txtMatLbs.tabindex(113)
Gui.F_Est_Maint.lbl46.create(label,"Lbs/MSI",True,840,210,1,150,3855,True,0,Arial,8,-2147483633,0)
Gui.F_Est_Maint.lbl46.parent("tabx1",1)
Gui.F_Est_Maint.lbl46.defaultvalue("")
Gui.F_Est_Maint.lbl47.create(label,"Min Applic ?C",False,1455,195,1,9930,6885,True,0,Arial,8,-2147483633,0)
Gui.F_Est_Maint.lbl47.parent("tabx1",1)
Gui.F_Est_Maint.lbl47.defaultvalue("")
Gui.F_Est_Maint.txtMatMAC.create(textbox,"",False,1215,300,0,9930,7095,True,1,Arial,8,-2147483643,1)
Gui.F_Est_Maint.txtMatMAC.parent("tabx1",1)
Gui.F_Est_Maint.txtMatMAC.numericonly(1)
Gui.F_Est_Maint.txtMatMAC.defaultvalue("0")
Gui.F_Est_Maint.txtMatMAC.tabstop(False)
Gui.F_Est_Maint.lbl48.create(label,"Grade",False,810,180,1,11655,7485,True,0,Arial,8,-2147483633,0)
Gui.F_Est_Maint.lbl48.parent("tabx1",1)
Gui.F_Est_Maint.lbl48.defaultvalue("")
Gui.F_Est_Maint.txtMatGrade.create(textbox,"",False,1305,300,0,11655,7680,True,0,Arial,8,-2147483643,1)
Gui.F_Est_Maint.txtMatGrade.parent("tabx1",1)
Gui.F_Est_Maint.txtMatGrade.maxLength(50)
Gui.F_Est_Maint.txtMatGrade.defaultvalue("")
Gui.F_Est_Maint.txtMatGrade.tabstop(False)
Gui.F_Est_Maint.lbl49.create(label,"Line Screen",False,960,180,1,11655,6930,True,0,Arial,8,-2147483633,0)
Gui.F_Est_Maint.lbl49.parent("tabx1",1)
Gui.F_Est_Maint.lbl49.defaultvalue("")
Gui.F_Est_Maint.txtMatLineScreen.create(textbox,"",False,1215,300,0,11655,7125,True,1,Arial,8,-2147483643,1)
Gui.F_Est_Maint.txtMatLineScreen.parent("tabx1",1)
Gui.F_Est_Maint.txtMatLineScreen.numericonly(1)
Gui.F_Est_Maint.txtMatLineScreen.defaultvalue("0")
Gui.F_Est_Maint.txtMatLineScreen.tabstop(False)
Gui.F_Est_Maint.lbl50.create(label,"Dot Size",False,975,210,1,9390,6930,True,0,Arial,8,-2147483633,0)
Gui.F_Est_Maint.lbl50.parent("tabx1",1)
Gui.F_Est_Maint.lbl50.defaultvalue("")
Gui.F_Est_Maint.txtMatDotSize.create(textbox,"",False,1215,300,0,9390,7125,True,1,Arial,8,-2147483643,1)
Gui.F_Est_Maint.txtMatDotSize.parent("tabx1",1)
Gui.F_Est_Maint.txtMatDotSize.numericonly(1)
Gui.F_Est_Maint.txtMatDotSize.defaultvalue("0")
Gui.F_Est_Maint.txtMatDotSize.tabstop(False)
Gui.F_Est_Maint.lbl51.create(label,"Freight Surcharge",True,1560,210,1,3765,5535,True,0,Arial,8,-2147483633,0)
Gui.F_Est_Maint.lbl51.parent("tabx1",1)
Gui.F_Est_Maint.lbl51.defaultvalue("")
Gui.F_Est_Maint.txtMatFreightSur.create(textbox,"",True,1215,300,0,3765,5730,True,1,Arial,8,-2147483643,1)
Gui.F_Est_Maint.txtMatFreightSur.parent("tabx1",1)
Gui.F_Est_Maint.txtMatFreightSur.numericonly(1)
Gui.F_Est_Maint.txtMatFreightSur.defaultvalue("0")
Gui.F_Est_Maint.txtMatFreightSur.tabstop(True)
Gui.F_Est_Maint.txtMatFreightSur.tabindex(123)
Gui.F_Est_Maint.cmdMatSave.create(button)
Gui.F_Est_Maint.cmdMatSave.caption("Save")
Gui.F_Est_Maint.cmdMatSave.size(855,375)
Gui.F_Est_Maint.cmdMatSave.position(150,7305)
Gui.F_Est_Maint.cmdMatSave.parent("tabx1",1)
Gui.F_Est_Maint.cmdMatSave.event(Click,CMDMaterial)
Gui.F_Est_Maint.cmdMatSave.defaultvalue("")
Gui.F_Est_Maint.cmdMatClear.create(button)
Gui.F_Est_Maint.cmdMatClear.caption("Clear")
Gui.F_Est_Maint.cmdMatClear.size(855,375)
Gui.F_Est_Maint.cmdMatClear.position(1110,7290)
Gui.F_Est_Maint.cmdMatClear.parent("tabx1",1)
Gui.F_Est_Maint.cmdMatClear.event(Click,CMDMaterial)
Gui.F_Est_Maint.cmdMatClear.defaultvalue("")
Gui.F_Est_Maint.gsfgEstRun.create(gsflexgrid)
Gui.F_Est_Maint.gsfgEstRun.size(1065,3195)
Gui.F_Est_Maint.gsfgEstRun.position(315,2685)
Gui.F_Est_Maint.gsfgEstRun.parent("tabx1",0)
Gui.F_Est_Maint.cmdEstSaveQty.create(button)
Gui.F_Est_Maint.cmdEstSaveQty.caption("Save")
Gui.F_Est_Maint.cmdEstSaveQty.size(855,375)
Gui.F_Est_Maint.cmdEstSaveQty.position(315,5970)
Gui.F_Est_Maint.cmdEstSaveQty.parent("tabx1",0)
Gui.F_Est_Maint.cmdEstSaveQty.event(Click,CMDEstimator)
Gui.F_Est_Maint.cmdEstSaveQty.defaultvalue("")
Gui.F_Est_Maint.gsfgEstSpd.create(gsGridControl)
Gui.F_Est_Maint.gsfgEstSpd.size(3345,2070)
Gui.F_Est_Maint.gsfgEstSpd.position(9210,465)
Gui.F_Est_Maint.gsfgEstSpd.parent("tabx1",0)
Gui.F_Est_Maint.cmdEstSaveSpd.create(button)
Gui.F_Est_Maint.cmdEstSaveSpd.caption("Save")
Gui.F_Est_Maint.cmdEstSaveSpd.size(855,375)
Gui.F_Est_Maint.cmdEstSaveSpd.position(11160,2610)
Gui.F_Est_Maint.cmdEstSaveSpd.parent("tabx1",0)
Gui.F_Est_Maint.cmdEstSaveSpd.event(Click,CMDEstimator)
Gui.F_Est_Maint.cmdEstSaveSpd.defaultvalue("")
Gui.F_Est_Maint.lbl54.create(label,"Machine Speed",True,1200,255,1,9210,240,True,0,Arial,8,-2147483633,0)
Gui.F_Est_Maint.lbl54.parent("tabx1",0)
Gui.F_Est_Maint.lbl54.defaultvalue("")
Gui.F_Est_Maint.cmdEstAddSpd.create(button)
Gui.F_Est_Maint.cmdEstAddSpd.caption("Add")
Gui.F_Est_Maint.cmdEstAddSpd.size(855,375)
Gui.F_Est_Maint.cmdEstAddSpd.position(9210,2610)
Gui.F_Est_Maint.cmdEstAddSpd.parent("tabx1",0)
Gui.F_Est_Maint.cmdEstAddSpd.event(Click,CMDEstimator)
Gui.F_Est_Maint.cmdEstAddSpd.defaultvalue("")
Gui.F_Est_Maint.cmdEstDeleteSpd.create(button)
Gui.F_Est_Maint.cmdEstDeleteSpd.caption("Delete")
Gui.F_Est_Maint.cmdEstDeleteSpd.size(855,375)
Gui.F_Est_Maint.cmdEstDeleteSpd.position(10200,2610)
Gui.F_Est_Maint.cmdEstDeleteSpd.parent("tabx1",0)
Gui.F_Est_Maint.cmdEstDeleteSpd.event(Click,CMDEstimator)
Gui.F_Est_Maint.cmdEstDeleteSpd.defaultvalue("")
Gui.F_Est_Maint.txtTolPart.create(textbox,"",True,1830,300,0,135,345,True,0,Arial,8,-2147483643,1)
Gui.F_Est_Maint.txtTolPart.parent("tabx1",2)
Gui.F_Est_Maint.txtTolPart.maxLength(20)
Gui.F_Est_Maint.txtTolPart.defaultvalue("")
Gui.F_Est_Maint.txtTolPart.TabStop(True)
Gui.F_Est_Maint.txtTolPart.TabIndex(200)
Gui.F_Est_Maint.lbl55.create(label,"Part",True,525,210,1,135,150,True,0,Arial,8,-2147483633,0)
Gui.F_Est_Maint.lbl55.parent("tabx1",2)
Gui.F_Est_Maint.lbl55.defaultvalue("")
Gui.F_Est_Maint.lbl56.create(label,"Loc",True,345,210,1,2055,150,True,0,Arial,8,-2147483633,0)
Gui.F_Est_Maint.lbl56.parent("tabx1",2)
Gui.F_Est_Maint.lbl56.defaultvalue("")
Gui.F_Est_Maint.txtTolLoc.create(textbox,"",True,450,300,0,2055,345,True,0,Arial,8,-2147483643,1)
Gui.F_Est_Maint.txtTolLoc.parent("tabx1",2)
Gui.F_Est_Maint.txtTolLoc.maxLength(2)
Gui.F_Est_Maint.txtTolLoc.event(LostFocus,txttolloc_lostfocus)
Gui.F_Est_Maint.txtTolLoc.defaultvalue("")
Gui.F_Est_Maint.txtTolLoc.TabStop(True)
Gui.F_Est_Maint.txtTolLoc.TabIndex(201)
Gui.F_Est_Maint.cmdTolBrowse.create(button)
Gui.F_Est_Maint.cmdTolBrowse.caption("^")
Gui.F_Est_Maint.cmdTolBrowse.size(495,330)
Gui.F_Est_Maint.cmdTolBrowse.position(2535,345)
Gui.F_Est_Maint.cmdTolBrowse.parent("tabx1",2)
Gui.F_Est_Maint.cmdTolBrowse.event(Click,CMDMaterial)
Gui.F_Est_Maint.cmdTolBrowse.defaultvalue("")
Gui.F_Est_Maint.cmdTolBrowse.tabstop(True)
Gui.F_Est_Maint.cmdTolBrowse.tabindex(202)
Gui.F_Est_Maint.lbl57.create(label,"Part Description",True,1635,210,1,3120,150,True,0,Arial,8,-2147483633,0)
Gui.F_Est_Maint.lbl57.parent("tabx1",2)
Gui.F_Est_Maint.lbl57.defaultvalue("")
Gui.F_Est_Maint.txtTolDesc.create(textbox,"",True,2835,300,0,3120,345,False,0,Arial,8,-2147483643,1)
Gui.F_Est_Maint.txtTolDesc.parent("tabx1",2)
Gui.F_Est_Maint.txtTolDesc.maxLength(30)
Gui.F_Est_Maint.txtTolDesc.defaultvalue("")
Gui.F_Est_Maint.lbl58.create(label,"Sort Code",True,825,210,1,6075,150,True,0,Arial,8,-2147483633,0)
Gui.F_Est_Maint.lbl58.parent("tabx1",2)
Gui.F_Est_Maint.lbl58.defaultvalue("")
Gui.F_Est_Maint.txtTolSC.create(textbox,"",True,2085,300,0,6075,345,False,0,Arial,8,-2147483643,1)
Gui.F_Est_Maint.txtTolSC.parent("tabx1",2)
Gui.F_Est_Maint.txtTolSC.defaultvalue("")
Gui.F_Est_Maint.lbl59.create(label,"Width",True,720,195,1,2610,720,True,0,Arial,8,-2147483633,0)
Gui.F_Est_Maint.lbl59.parent("tabx1",2)
Gui.F_Est_Maint.lbl59.defaultvalue("")
Gui.F_Est_Maint.txtTolWidth.create(textbox,"",True,1215,300,0,2610,915,True,1,Arial,8,-2147483643,1)
Gui.F_Est_Maint.txtTolWidth.parent("tabx1",2)
Gui.F_Est_Maint.txtTolWidth.numericonly(1)
Gui.F_Est_Maint.txtTolWidth.defaultvalue("")
Gui.F_Est_Maint.txtTolWidth.tabstop(True)
Gui.F_Est_Maint.txtTolWidth.tabindex(205)
Gui.F_Est_Maint.lbl60.create(label,"Length",True,720,195,1,1125,720,True,0,Arial,8,-2147483633,0)
Gui.F_Est_Maint.lbl60.parent("tabx1",2)
Gui.F_Est_Maint.lbl60.defaultvalue("")
Gui.F_Est_Maint.txtTolLength.create(textbox,"",True,1215,300,0,1125,915,True,1,Arial,8,-2147483643,1)
Gui.F_Est_Maint.txtTolLength.parent("tabx1",2)
Gui.F_Est_Maint.txtTolLength.numericonly(1)
Gui.F_Est_Maint.txtTolLength.defaultvalue("")
Gui.F_Est_Maint.txtTolLength.tabstop(True)
Gui.F_Est_Maint.txtTolLength.tabindex(204)
Gui.F_Est_Maint.lbl61.create(label,"#Across",True,720,210,1,135,1320,True,0,Arial,8,-2147483633,0)
Gui.F_Est_Maint.lbl61.parent("tabx1",2)
Gui.F_Est_Maint.lbl61.defaultvalue("")
Gui.F_Est_Maint.txtTolAcross.create(textbox,"",True,1215,300,0,135,1515,True,1,Arial,8,-2147483643,1)
Gui.F_Est_Maint.txtTolAcross.parent("tabx1",2)
Gui.F_Est_Maint.txtTolAcross.numericonly(2)
Gui.F_Est_Maint.txtTolAcross.defaultvalue("")
Gui.F_Est_Maint.txtTolAcross.tabstop(True)
Gui.F_Est_Maint.txtTolAcross.tabindex(206)
Gui.F_Est_Maint.lbl62.create(label,"#Around",True,735,210,1,1605,1320,True,0,Arial,8,-2147483633,0)
Gui.F_Est_Maint.lbl62.parent("tabx1",2)
Gui.F_Est_Maint.lbl62.defaultvalue("")
Gui.F_Est_Maint.txtTolAround.create(textbox,"",True,1215,300,0,1605,1515,True,1,Arial,8,-2147483643,1)
Gui.F_Est_Maint.txtTolAround.parent("tabx1",2)
Gui.F_Est_Maint.txtTolAround.numericonly(2)
Gui.F_Est_Maint.txtTolAround.defaultvalue("")
Gui.F_Est_Maint.txtTolAround.tabstop(True)
Gui.F_Est_Maint.txtTolAround.tabindex(207)
Gui.F_Est_Maint.lbl63.create(label,"Gap Across",True,960,210,1,3045,1320,True,0,Arial,8,-2147483633,0)
Gui.F_Est_Maint.lbl63.parent("tabx1",2)
Gui.F_Est_Maint.lbl63.defaultvalue("")
Gui.F_Est_Maint.txtTolGapAcross.create(textbox,"",True,1215,300,0,3045,1515,True,1,Arial,8,-2147483643,1)
Gui.F_Est_Maint.txtTolGapAcross.parent("tabx1",2)
Gui.F_Est_Maint.txtTolGapAcross.numericonly(1)
Gui.F_Est_Maint.txtTolGapAcross.defaultvalue("")
Gui.F_Est_Maint.txtTolGapAcross.tabstop(True)
Gui.F_Est_Maint.txtTolGapAcross.tabindex(208)
Gui.F_Est_Maint.lbl64.create(label,"Gap Down",True,870,210,1,4530,1320,True,0,Arial,8,-2147483633,0)
Gui.F_Est_Maint.lbl64.parent("tabx1",2)
Gui.F_Est_Maint.lbl64.defaultvalue("")
Gui.F_Est_Maint.txtTolGapDown.create(textbox,"",True,1215,300,0,4530,1515,True,1,Arial,8,-2147483643,1)
Gui.F_Est_Maint.txtTolGapDown.parent("tabx1",2)
Gui.F_Est_Maint.txtTolGapDown.numericonly(1)
Gui.F_Est_Maint.txtTolGapDown.defaultvalue("")
Gui.F_Est_Maint.txtTolGapDown.tabstop(True)
Gui.F_Est_Maint.txtTolGapDown.tabindex(209)
Gui.F_Est_Maint.lbl65.create(label,"Liner Thickness",True,1335,210,1,1410,1905,True,0,Arial,8,-2147483633,0)
Gui.F_Est_Maint.lbl65.parent("tabx1",2)
Gui.F_Est_Maint.lbl65.defaultvalue("")
Gui.F_Est_Maint.txtTolLinerThick.create(textbox,"",True,1215,300,0,1395,2100,True,0,Arial,8,-2147483643,1)
Gui.F_Est_Maint.txtTolLinerThick.parent("tabx1",2)
Gui.F_Est_Maint.txtTolLinerThick.defaultvalue("")
Gui.F_Est_Maint.txtTolLinerThick.tabstop(True)
Gui.F_Est_Maint.txtTolLinerThick.tabindex(211)
Gui.F_Est_Maint.cmdTolSave.create(button)
Gui.F_Est_Maint.cmdTolSave.caption("Save")
Gui.F_Est_Maint.cmdTolSave.size(855,375)
Gui.F_Est_Maint.cmdTolSave.position(135,3690)
Gui.F_Est_Maint.cmdTolSave.parent("tabx1",2)
Gui.F_Est_Maint.cmdTolSave.event(Click,CMDMaterial)
Gui.F_Est_Maint.cmdTolSave.defaultvalue("")
Gui.F_Est_Maint.cmdTolSave.tabstop(True)
Gui.F_Est_Maint.cmdTolSave.tabindex(220)
Gui.F_Est_Maint.cmdTolClear.create(button)
Gui.F_Est_Maint.cmdTolClear.caption("Clear")
Gui.F_Est_Maint.cmdTolClear.size(855,375)
Gui.F_Est_Maint.cmdTolClear.position(1155,3690)
Gui.F_Est_Maint.cmdTolClear.parent("tabx1",2)
Gui.F_Est_Maint.cmdTolClear.event(Click,CMDMaterial)
Gui.F_Est_Maint.cmdTolClear.defaultvalue("")
Gui.F_Est_Maint.cmdTolClear.tabstop(True)
Gui.F_Est_Maint.cmdTolClear.tabindex(221)
Gui.F_Est_Maint.lbl66.create(label,"FOB Types",True,885,255,1,315,240,True,0,Arial,8,-2147483633,0)
Gui.F_Est_Maint.lbl66.parent("tabx1",0)
Gui.F_Est_Maint.lbl66.defaultvalue("")
Gui.F_Est_Maint.gsfgEstFOB.create(gsGridControl)
Gui.F_Est_Maint.gsfgEstFOB.size(4065,1335)
Gui.F_Est_Maint.gsfgEstFOB.position(315,465)
Gui.F_Est_Maint.gsfgEstFOB.parent("tabx1",0)
Gui.F_Est_Maint.cmdEstAddFOB.create(button)
Gui.F_Est_Maint.cmdEstAddFOB.caption("Add")
Gui.F_Est_Maint.cmdEstAddFOB.size(855,375)
Gui.F_Est_Maint.cmdEstAddFOB.position(315,1875)
Gui.F_Est_Maint.cmdEstAddFOB.parent("tabx1",0)
Gui.F_Est_Maint.cmdEstAddFOB.event(Click,CMDEstimator)
Gui.F_Est_Maint.cmdEstAddFOB.defaultvalue("")
Gui.F_Est_Maint.cmdEstSaveFOB.create(button)
Gui.F_Est_Maint.cmdEstSaveFOB.caption("Save")
Gui.F_Est_Maint.cmdEstSaveFOB.size(855,375)
Gui.F_Est_Maint.cmdEstSaveFOB.position(1305,1875)
Gui.F_Est_Maint.cmdEstSaveFOB.parent("tabx1",0)
Gui.F_Est_Maint.cmdEstSaveFOB.event(Click,CMDEstimator)
Gui.F_Est_Maint.cmdEstSaveFOB.defaultvalue("")
Gui.F_Est_Maint.lbl67.create(label,"Upcharge Types",True,1305,255,1,4740,240,True,0,Arial,8,-2147483633,0)
Gui.F_Est_Maint.lbl67.parent("tabx1",0)
Gui.F_Est_Maint.lbl67.defaultvalue("")
Gui.F_Est_Maint.gsfgEstUp.create(gsGridControl)
Gui.F_Est_Maint.gsfgEstUp.size(4065,1335)
Gui.F_Est_Maint.gsfgEstUp.position(4740,465)
Gui.F_Est_Maint.gsfgEstUp.parent("tabx1",0)
Gui.F_Est_Maint.cmdEstAddUp.create(button)
Gui.F_Est_Maint.cmdEstAddUp.caption("Add")
Gui.F_Est_Maint.cmdEstAddUp.size(855,375)
Gui.F_Est_Maint.cmdEstAddUp.position(4740,1875)
Gui.F_Est_Maint.cmdEstAddUp.parent("tabx1",0)
Gui.F_Est_Maint.cmdEstAddUp.event(Click,CMDEstimator)
Gui.F_Est_Maint.cmdEstAddUp.defaultvalue("")
Gui.F_Est_Maint.cmdEstSaveUp.create(button)
Gui.F_Est_Maint.cmdEstSaveUp.caption("Save")
Gui.F_Est_Maint.cmdEstSaveUp.size(855,375)
Gui.F_Est_Maint.cmdEstSaveUp.position(5730,1875)
Gui.F_Est_Maint.cmdEstSaveUp.parent("tabx1",0)
Gui.F_Est_Maint.cmdEstSaveUp.event(Click,CMDEstimator)
Gui.F_Est_Maint.cmdEstSaveUp.defaultvalue("")
Gui.F_Est_Maint.txtMatMaterialType.create(textbox,"",True,1410,300,0,150,735,True,0,Arial,8,-2147483643,1)
Gui.F_Est_Maint.txtMatMaterialType.parent("tabx1",1)
Gui.F_Est_Maint.txtMatMaterialType.maxLength(7)
Gui.F_Est_Maint.txtMatMaterialType.defaultvalue("0")
Gui.F_Est_Maint.txtMatMaterialType.tabstop(True)
Gui.F_Est_Maint.txtMatMaterialType.tabindex(103)
Gui.F_Est_Maint.lbl68.create(label,"Material Type",True,1275,210,1,165,555,True,0,Arial,8,-2147483633,0)
Gui.F_Est_Maint.lbl68.parent("tabx1",1)
Gui.F_Est_Maint.lbl68.defaultvalue("")
Gui.F_Est_Maint.txtMatFaceDesc.create(textbox,"",True,3495,300,0,150,1290,True,0,Arial,8,-2147483643,1)
Gui.F_Est_Maint.txtMatFaceDesc.parent("tabx1",1)
Gui.F_Est_Maint.txtMatFaceDesc.maxLength(35)
Gui.F_Est_Maint.txtMatFaceDesc.defaultvalue("")
Gui.F_Est_Maint.txtMatFaceDesc.tabstop(True)
Gui.F_Est_Maint.txtMatFaceDesc.tabindex(105)
Gui.F_Est_Maint.lbl69.create(label,"Face Sheet Description",True,2145,210,1,150,1095,True,0,Arial,8,-2147483633,0)
Gui.F_Est_Maint.lbl69.parent("tabx1",1)
Gui.F_Est_Maint.lbl69.defaultvalue("")
Gui.F_Est_Maint.lbl70.create(label,"Service Temp High ?F",True,1695,210,1,150,5520,True,0,Arial,8,-2147483633,0)
Gui.F_Est_Maint.lbl70.parent("tabx1",1)
Gui.F_Est_Maint.lbl70.defaultvalue("")
Gui.F_Est_Maint.txtMatSTHF.create(textbox,"",True,1635,300,0,150,5715,True,1,Arial,8,-2147483643,1)
Gui.F_Est_Maint.txtMatSTHF.parent("tabx1",1)
Gui.F_Est_Maint.txtMatSTHF.numericonly(1)
Gui.F_Est_Maint.txtMatSTHF.defaultvalue("0")
Gui.F_Est_Maint.txtMatSTHF.tabstop(True)
Gui.F_Est_Maint.txtMatSTHF.tabindex(116)
Gui.F_Est_Maint.lbl71.create(label,"Service Temp High ?C",False,1710,210,1,10770,7515,True,0,Arial,8,-2147483633,0)
Gui.F_Est_Maint.lbl71.parent("tabx1",1)
Gui.F_Est_Maint.lbl71.defaultvalue("")
Gui.F_Est_Maint.txtMatSTHC.create(textbox,"",False,1635,300,0,10770,7695,True,1,Arial,8,-2147483643,1)
Gui.F_Est_Maint.txtMatSTHC.parent("tabx1",1)
Gui.F_Est_Maint.txtMatSTHC.numericonly(1)
Gui.F_Est_Maint.txtMatSTHC.defaultvalue("0")
Gui.F_Est_Maint.txtMatSTHC.tabstop(False)
Gui.F_Est_Maint.txtMatPC1.create(textbox,"",True,3495,300,0,3765,1845,True,0,Arial,8,-2147483643,1)
Gui.F_Est_Maint.txtMatPC1.parent("tabx1",1)
Gui.F_Est_Maint.txtMatPC1.maxLength(25)
Gui.F_Est_Maint.txtMatPC1.defaultvalue("")
Gui.F_Est_Maint.txtMatPC1.tabstop(True)
Gui.F_Est_Maint.txtMatPC1.tabindex(118)
Gui.F_Est_Maint.lbl72.create(label,"Product Code 1",True,1230,210,1,3765,1650,True,0,Arial,8,-2147483633,0)
Gui.F_Est_Maint.lbl72.parent("tabx1",1)
Gui.F_Est_Maint.lbl72.defaultvalue("")
Gui.F_Est_Maint.lbl73.create(label,"Product Code 2",True,1230,210,1,3765,2205,True,0,Arial,8,-2147483633,0)
Gui.F_Est_Maint.lbl73.parent("tabx1",1)
Gui.F_Est_Maint.lbl73.defaultvalue("")
Gui.F_Est_Maint.lbl74.create(label,"Product Code 3",True,1230,210,1,3765,2760,True,0,Arial,8,-2147483633,0)
Gui.F_Est_Maint.lbl74.parent("tabx1",1)
Gui.F_Est_Maint.lbl74.defaultvalue("")
Gui.F_Est_Maint.lbl75.create(label,"Product Code 4",True,1425,180,1,3765,3315,True,0,Arial,8,-2147483633,0)
Gui.F_Est_Maint.lbl75.parent("tabx1",1)
Gui.F_Est_Maint.lbl75.defaultvalue("")
Gui.F_Est_Maint.lbl76.create(label,"Product Code 5",True,1230,210,1,3765,3870,True,0,Arial,8,-2147483633,0)
Gui.F_Est_Maint.lbl76.parent("tabx1",1)
Gui.F_Est_Maint.lbl76.defaultvalue("")
Gui.F_Est_Maint.txtMatPC2.create(textbox,"",True,3495,300,0,3765,2400,True,0,Arial,8,-2147483643,1)
Gui.F_Est_Maint.txtMatPC2.parent("tabx1",1)
Gui.F_Est_Maint.txtMatPC2.maxLength(25)
Gui.F_Est_Maint.txtMatPC2.defaultvalue("")
Gui.F_Est_Maint.txtMatPC2.tabstop(True)
Gui.F_Est_Maint.txtMatPC2.tabindex(119)
Gui.F_Est_Maint.txtMatPC3.create(textbox,"",True,3495,300,0,3765,2955,True,0,Arial,8,-2147483643,1)
Gui.F_Est_Maint.txtMatPC3.parent("tabx1",1)
Gui.F_Est_Maint.txtMatPC3.maxLength(25)
Gui.F_Est_Maint.txtMatPC3.defaultvalue("")
Gui.F_Est_Maint.txtMatPC3.tabstop(True)
Gui.F_Est_Maint.txtMatPC3.tabindex(120)
Gui.F_Est_Maint.txtMatPC4.create(textbox,"",True,3495,300,0,3765,3510,True,0,Arial,8,-2147483643,1)
Gui.F_Est_Maint.txtMatPC4.parent("tabx1",1)
Gui.F_Est_Maint.txtMatPC4.maxLength(25)
Gui.F_Est_Maint.txtMatPC4.defaultvalue("")
Gui.F_Est_Maint.txtMatPC4.tabstop(True)
Gui.F_Est_Maint.txtMatPC4.tabindex(121)
Gui.F_Est_Maint.txtMatPC5.create(textbox,"",True,3495,300,0,3765,4065,True,0,Arial,8,-2147483643,1)
Gui.F_Est_Maint.txtMatPC5.parent("tabx1",1)
Gui.F_Est_Maint.txtMatPC5.maxLength(25)
Gui.F_Est_Maint.txtMatPC5.defaultvalue("")
Gui.F_Est_Maint.txtMatPC5.tabstop(True)
Gui.F_Est_Maint.txtMatPC5.tabindex(122)
Gui.F_Est_Maint.txtMatVenNum.create(textbox,"",True,1410,300,0,3765,735,False,0,Arial,8,-2147483643,1)
Gui.F_Est_Maint.txtMatVenNum.parent("tabx1",1)
Gui.F_Est_Maint.txtMatVenNum.maxLength(6)
Gui.F_Est_Maint.txtMatVenNum.defaultvalue("0")
Gui.F_Est_Maint.txtMatVenNum.tabstop(False)
Gui.F_Est_Maint.lbl77.create(label,"Vendor Number",True,1440,210,1,3765,555,True,0,Arial,8,-2147483633,0)
Gui.F_Est_Maint.lbl77.parent("tabx1",1)
Gui.F_Est_Maint.lbl77.defaultvalue("")
Gui.F_Est_Maint.txtMatVenName.create(textbox,"",True,2820,300,0,3765,1290,False,0,Arial,8,-2147483643,1)
Gui.F_Est_Maint.txtMatVenName.parent("tabx1",1)
Gui.F_Est_Maint.txtMatVenName.maxLength(35)
Gui.F_Est_Maint.txtMatVenName.defaultvalue("")
Gui.F_Est_Maint.txtMatVenName.tabstop(False)
Gui.F_Est_Maint.lbl78.create(label,"Vendor Name",True,1260,210,1,3765,1095,True,0,Arial,8,-2147483633,0)
Gui.F_Est_Maint.lbl78.parent("tabx1",1)
Gui.F_Est_Maint.lbl78.defaultvalue("")
Gui.F_Est_Maint.lbl79.create(label,"Master Width 1",True,1170,210,1,7440,1650,True,0,Arial,8,-2147483633,0)
Gui.F_Est_Maint.lbl79.parent("tabx1",1)
Gui.F_Est_Maint.lbl79.defaultvalue("")
Gui.F_Est_Maint.lbl80.create(label,"Master Width 2",True,1170,210,1,7440,2205,True,0,Arial,8,-2147483633,0)
Gui.F_Est_Maint.lbl80.parent("tabx1",1)
Gui.F_Est_Maint.lbl80.defaultvalue("")
Gui.F_Est_Maint.lbl81.create(label,"Master Width 3",True,1170,210,1,7455,2760,True,0,Arial,8,-2147483633,0)
Gui.F_Est_Maint.lbl81.parent("tabx1",1)
Gui.F_Est_Maint.lbl81.defaultvalue("")
Gui.F_Est_Maint.lbl82.create(label,"Master Width 4",True,1395,180,1,7440,3315,True,0,Arial,8,-2147483633,0)
Gui.F_Est_Maint.lbl82.parent("tabx1",1)
Gui.F_Est_Maint.lbl82.defaultvalue("")
Gui.F_Est_Maint.lbl83.create(label,"Master Width 5",True,1170,210,1,7440,3870,True,0,Arial,8,-2147483633,0)
Gui.F_Est_Maint.lbl83.parent("tabx1",1)
Gui.F_Est_Maint.lbl83.defaultvalue("")
Gui.F_Est_Maint.txtMatMW1.create(textbox,"",True,1515,300,0,7440,1845,True,1,Arial,8,-2147483643,1)
Gui.F_Est_Maint.txtMatMW1.parent("tabx1",1)
Gui.F_Est_Maint.txtMatMW1.numericonly(1)
Gui.F_Est_Maint.txtMatMW1.maxLength(25)
Gui.F_Est_Maint.txtMatMW1.defaultvalue("")
Gui.F_Est_Maint.txtMatMW1.tabstop(True)
Gui.F_Est_Maint.txtMatMW1.tabindex(125)
Gui.F_Est_Maint.txtMatMW2.create(textbox,"",True,1515,300,0,7440,2400,True,1,Arial,8,-2147483643,1)
Gui.F_Est_Maint.txtMatMW2.parent("tabx1",1)
Gui.F_Est_Maint.txtMatMW2.numericonly(1)
Gui.F_Est_Maint.txtMatMW2.maxLength(25)
Gui.F_Est_Maint.txtMatMW2.defaultvalue("")
Gui.F_Est_Maint.txtMatMW2.tabstop(True)
Gui.F_Est_Maint.txtMatMW2.tabindex(126)
Gui.F_Est_Maint.txtMatMW3.create(textbox,"",True,1515,300,0,7440,2955,True,1,Arial,8,-2147483643,1)
Gui.F_Est_Maint.txtMatMW3.parent("tabx1",1)
Gui.F_Est_Maint.txtMatMW3.numericonly(1)
Gui.F_Est_Maint.txtMatMW3.maxLength(25)
Gui.F_Est_Maint.txtMatMW3.defaultvalue("")
Gui.F_Est_Maint.txtMatMW3.tabstop(True)
Gui.F_Est_Maint.txtMatMW3.tabindex(127)
Gui.F_Est_Maint.txtMatMW4.create(textbox,"",True,1515,300,0,7440,3510,True,1,Arial,8,-2147483643,1)
Gui.F_Est_Maint.txtMatMW4.parent("tabx1",1)
Gui.F_Est_Maint.txtMatMW4.numericonly(1)
Gui.F_Est_Maint.txtMatMW4.maxLength(25)
Gui.F_Est_Maint.txtMatMW4.defaultvalue("")
Gui.F_Est_Maint.txtMatMW4.tabstop(True)
Gui.F_Est_Maint.txtMatMW4.tabindex(128)
Gui.F_Est_Maint.txtMatMW5.create(textbox,"",True,1515,300,0,7440,4065,True,1,Arial,8,-2147483643,1)
Gui.F_Est_Maint.txtMatMW5.parent("tabx1",1)
Gui.F_Est_Maint.txtMatMW5.numericonly(1)
Gui.F_Est_Maint.txtMatMW5.maxLength(25)
Gui.F_Est_Maint.txtMatMW5.defaultvalue("")
Gui.F_Est_Maint.txtMatMW5.tabstop(True)
Gui.F_Est_Maint.txtMatMW5.tabindex(129)
Gui.F_Est_Maint.lvwMatFOB.create(listview)
Gui.F_Est_Maint.lvwMatFOB.view(3)
Gui.F_Est_Maint.lvwMatFOB.addlistviewcolumn("FOB",3000,0)
Gui.F_Est_Maint.lvwMatFOB.size(3120,1755)
Gui.F_Est_Maint.lvwMatFOB.position(5565,4485)
Gui.F_Est_Maint.lvwMatFOB.parent("tabx1",1)
Gui.F_Est_Maint.lvwMatPrice.create(listview)
Gui.F_Est_Maint.lvwMatPrice.view(3)
Gui.F_Est_Maint.lvwMatPrice.addlistviewcolumn("Price",1500,0)
Gui.F_Est_Maint.lvwMatPrice.addlistviewcolumn("Quantity",1500,0)
Gui.F_Est_Maint.lvwMatPrice.size(3120,1905)
Gui.F_Est_Maint.lvwMatPrice.position(9180,1565)
Gui.F_Est_Maint.lvwMatPrice.parent("tabx1",1)
Gui.F_Est_Maint.cmdMatPriceAdd.create(button)
Gui.F_Est_Maint.cmdMatPriceAdd.caption("Add")
Gui.F_Est_Maint.cmdMatPriceAdd.size(855,375)
Gui.F_Est_Maint.cmdMatPriceAdd.position(9135,1095)
Gui.F_Est_Maint.cmdMatPriceAdd.parent("tabx1",1)
Gui.F_Est_Maint.cmdMatPriceAdd.event(Click,CMDMaterial)
Gui.F_Est_Maint.cmdMatPriceAdd.defaultvalue("")
Gui.F_Est_Maint.cmdMatPriceAdd.tabstop(True)
Gui.F_Est_Maint.cmdMatPriceAdd.tabindex(132)
Gui.F_Est_Maint.txtMatPrice.create(textbox,"",True,1395,300,0,9150,735,True,1,Arial,8,-2147483643,1)
Gui.F_Est_Maint.txtMatPrice.parent("tabx1",1)
Gui.F_Est_Maint.txtMatPrice.numericonly(1)
Gui.F_Est_Maint.txtMatPrice.event(LostFocus,CMDMaterial)
Gui.F_Est_Maint.txtMatPrice.defaultvalue("0")
Gui.F_Est_Maint.txtMatPrice.tabstop(True)
Gui.F_Est_Maint.txtMatPrice.tabindex(130)
Gui.F_Est_Maint.txtMatQty.create(textbox,"",True,1395,300,0,10695,735,True,1,Arial,8,-2147483643,1)
Gui.F_Est_Maint.txtMatQty.parent("tabx1",1)
Gui.F_Est_Maint.txtMatQty.numericonly(1)
Gui.F_Est_Maint.txtMatQty.event(LostFocus,CMDMaterial)
Gui.F_Est_Maint.txtMatQty.defaultvalue("0")
Gui.F_Est_Maint.txtMatQty.tabstop(True)
Gui.F_Est_Maint.txtMatQty.tabindex(131)
Gui.F_Est_Maint.cmdMatPriceRemove.create(button)
Gui.F_Est_Maint.cmdMatPriceRemove.caption("Remove")
Gui.F_Est_Maint.cmdMatPriceRemove.size(855,375)
Gui.F_Est_Maint.cmdMatPriceRemove.position(10155,1095)
Gui.F_Est_Maint.cmdMatPriceRemove.parent("tabx1",1)
Gui.F_Est_Maint.cmdMatPriceRemove.event(Click,CMDMaterial)
Gui.F_Est_Maint.cmdMatPriceRemove.defaultvalue("")
Gui.F_Est_Maint.cmdMatPriceRemove.tabstop(True)
Gui.F_Est_Maint.cmdMatPriceRemove.tabindex(133)
Gui.F_Est_Maint.lbl84.create(label,"Buy Price",True,1125,195,1,9165,570,True,0,Arial,8,-2147483633,0)
Gui.F_Est_Maint.lbl84.parent("tabx1",1)
Gui.F_Est_Maint.lbl84.defaultvalue("")
Gui.F_Est_Maint.lbl85.create(label,"Quantity Break",True,1185,195,1,10755,570,True,0,Arial,8,-2147483633,0)
Gui.F_Est_Maint.lbl85.parent("tabx1",1)
Gui.F_Est_Maint.lbl85.defaultvalue("")
Gui.F_Est_Maint.lvwMatUpcharge.create(listview)
Gui.F_Est_Maint.lvwMatUpcharge.view(3)
Gui.F_Est_Maint.lvwMatUpcharge.addlistviewcolumn("Type",1500,0)
Gui.F_Est_Maint.lvwMatUpcharge.addlistviewcolumn("Amount",1500,0)
Gui.F_Est_Maint.lvwMatUpcharge.size(3120,1905)
Gui.F_Est_Maint.lvwMatUpcharge.position(9135,4675)
Gui.F_Est_Maint.lvwMatUpcharge.parent("tabx1",1)
Gui.F_Est_Maint.ddlMatUpcharge.create(dropdownlist)
Gui.F_Est_Maint.ddlMatUpcharge.size(1995,330)
Gui.F_Est_Maint.ddlMatUpcharge.position(9150,3840)
Gui.F_Est_Maint.ddlMatUpcharge.parent("tabx1",1)
Gui.F_Est_Maint.ddlMatUpcharge.defaultvalue("")
Gui.F_Est_Maint.ddlMatUpcharge.TabStop(True)
Gui.F_Est_Maint.ddlMatUpcharge.TabIndex(134)
Gui.F_Est_Maint.txtMatUpAmt.create(textbox,"",True,1395,300,0,11250,3840,True,1,Arial,8,-2147483643,1)
Gui.F_Est_Maint.txtMatUpAmt.parent("tabx1",1)
Gui.F_Est_Maint.txtMatUpAmt.numericonly(1)
Gui.F_Est_Maint.txtMatUpAmt.defaultvalue("0")
Gui.F_Est_Maint.txtMatUpAmt.tabstop(True)
Gui.F_Est_Maint.txtMatUpAmt.tabindex(135)
Gui.F_Est_Maint.cmdMatUpAdd.create(button)
Gui.F_Est_Maint.cmdMatUpAdd.caption("Add")
Gui.F_Est_Maint.cmdMatUpAdd.size(855,375)
Gui.F_Est_Maint.cmdMatUpAdd.position(9150,4245)
Gui.F_Est_Maint.cmdMatUpAdd.parent("tabx1",1)
Gui.F_Est_Maint.cmdMatUpAdd.event(Click,CMDMaterial)
Gui.F_Est_Maint.cmdMatUpAdd.defaultvalue("")
Gui.F_Est_Maint.cmdMatUpAdd.tabstop(True)
Gui.F_Est_Maint.cmdMatUpAdd.tabindex(136)
Gui.F_Est_Maint.cmdMatUpRemove.create(button)
Gui.F_Est_Maint.cmdMatUpRemove.caption("Remove")
Gui.F_Est_Maint.cmdMatUpRemove.size(855,375)
Gui.F_Est_Maint.cmdMatUpRemove.position(10155,4245)
Gui.F_Est_Maint.cmdMatUpRemove.parent("tabx1",1)
Gui.F_Est_Maint.cmdMatUpRemove.event(Click,CMDMaterial)
Gui.F_Est_Maint.cmdMatUpRemove.defaultvalue("")
Gui.F_Est_Maint.cmdMatUpRemove.tabstop(True)
Gui.F_Est_Maint.cmdMatUpRemove.tabindex(137)
Gui.F_Est_Maint.lbl86.create(label,"Upcharge Amount",True,1380,255,1,11250,3640,True,0,Arial,8,-2147483633,0)
Gui.F_Est_Maint.lbl86.parent("tabx1",1)
Gui.F_Est_Maint.lbl86.defaultvalue("")
Gui.F_Est_Maint.lbl87.create(label,"Upcharge Type",True,1365,255,1,9165,3630,True,0,Arial,8,-2147483633,0)
Gui.F_Est_Maint.lbl87.parent("tabx1",1)
Gui.F_Est_Maint.lbl87.defaultvalue("")
Gui.F_Est_Maint.txtMatLead.create(textbox,"",True,1395,300,0,8355,210,False,1,Arial,8,-2147483643,1)
Gui.F_Est_Maint.txtMatLead.parent("tabx1",1)
Gui.F_Est_Maint.txtMatLead.numericonly(1)
Gui.F_Est_Maint.txtMatLead.defaultvalue("0")
Gui.F_Est_Maint.txtMatLead.tabstop(False)
Gui.F_Est_Maint.txtMatDateAdd.create(textbox,"",True,1410,300,0,9870,210,False,0,Arial,8,-2147483643,1)
Gui.F_Est_Maint.txtMatDateAdd.parent("tabx1",1)
Gui.F_Est_Maint.txtMatDateAdd.maxLength(10)
Gui.F_Est_Maint.txtMatDateAdd.defaultvalue("0")
Gui.F_Est_Maint.txtMatDateAdd.tabstop(False)
Gui.F_Est_Maint.txtMatDateChg.create(textbox,"",True,1410,300,0,11445,210,False,0,Arial,8,-2147483643,1)
Gui.F_Est_Maint.txtMatDateChg.parent("tabx1",1)
Gui.F_Est_Maint.txtMatDateChg.maxLength(10)
Gui.F_Est_Maint.txtMatDateChg.defaultvalue("0")
Gui.F_Est_Maint.txtMatDateChg.tabstop(False)
Gui.F_Est_Maint.lbl88.create(label,"Lead",True,495,225,1,8370,15,True,0,Arial,8,-2147483633,0)
Gui.F_Est_Maint.lbl88.parent("tabx1",1)
Gui.F_Est_Maint.lbl88.defaultvalue("")
Gui.F_Est_Maint.lbl89.create(label,"Date Added",True,960,225,1,9885,15,True,0,Arial,8,-2147483633,0)
Gui.F_Est_Maint.lbl89.parent("tabx1",1)
Gui.F_Est_Maint.lbl89.defaultvalue("")
Gui.F_Est_Maint.lbl90.create(label,"Last Edited",True,1125,225,1,11475,15,True,0,Arial,8,-2147483633,0)
Gui.F_Est_Maint.lbl90.parent("tabx1",1)
Gui.F_Est_Maint.lbl90.defaultvalue("")
Gui.F_Est_Maint.txtMatActPrice.create(textbox,"",True,1395,300,0,5955,735,False,1,Arial,8,-2147483643,1)
Gui.F_Est_Maint.txtMatActPrice.parent("tabx1",1)
Gui.F_Est_Maint.txtMatActPrice.numericonly(1)
Gui.F_Est_Maint.txtMatActPrice.defaultvalue("0")
Gui.F_Est_Maint.txtMatActPrice.tabstop(False)
Gui.F_Est_Maint.txtMatMSIPrice.create(textbox,"",True,1395,300,0,7440,735,True,1,Arial,8,-2147483643,1)
Gui.F_Est_Maint.txtMatMSIPrice.parent("tabx1",1)
Gui.F_Est_Maint.txtMatMSIPrice.numericonly(1)
Gui.F_Est_Maint.txtMatMSIPrice.defaultvalue("0")
Gui.F_Est_Maint.txtMatMSIPrice.tabstop(True)
Gui.F_Est_Maint.txtMatMSIPrice.tabindex(124)
Gui.F_Est_Maint.lbl91.create(label,"GSS Price",True,1065,210,1,5955,555,True,0,Arial,8,-2147483633,0)
Gui.F_Est_Maint.lbl91.parent("tabx1",1)
Gui.F_Est_Maint.lbl91.defaultvalue("")
Gui.F_Est_Maint.lbl92.create(label,"Default MSI",True,1170,210,1,7440,555,True,0,Arial,8,-2147483633,0)
Gui.F_Est_Maint.lbl92.parent("tabx1",1)
Gui.F_Est_Maint.lbl92.defaultvalue("")
Gui.F_Est_Maint.txtMatMinOrder.create(textbox,"",True,1965,300,0,1680,735,True,0,Arial,8,-2147483643,1)
Gui.F_Est_Maint.txtMatMinOrder.parent("tabx1",1)
Gui.F_Est_Maint.txtMatMinOrder.maxLength(30)
Gui.F_Est_Maint.txtMatMinOrder.defaultvalue("0")
Gui.F_Est_Maint.txtMatMinOrder.tabstop(True)
Gui.F_Est_Maint.txtMatMinOrder.tabindex(104)
Gui.F_Est_Maint.lbl93.create(label,"Minimum Order",True,1440,210,1,1680,555,True,0,Arial,8,-2147483633,0)
Gui.F_Est_Maint.lbl93.parent("tabx1",1)
Gui.F_Est_Maint.lbl93.defaultvalue("")
Gui.F_Est_Maint.chkMatExact.create(checkbox)
Gui.F_Est_Maint.chkMatExact.caption("Exact")
Gui.F_Est_Maint.chkMatExact.size(810,255)
Gui.F_Est_Maint.chkMatExact.position(2160,3240)
Gui.F_Est_Maint.chkMatExact.parent("tabx1",1)
Gui.F_Est_Maint.chkMatExact.defaultvalue("")
Gui.F_Est_Maint.chkMatExact.TabStop(True)
Gui.F_Est_Maint.chkMatExact.TabIndex(111)
Gui.F_Est_Maint.cmdEstInstance.create(button)
Gui.F_Est_Maint.cmdEstInstance.caption("Allow Multiple Instances")
Gui.F_Est_Maint.cmdEstInstance.size(1995,375)
Gui.F_Est_Maint.cmdEstInstance.position(315,7035)
Gui.F_Est_Maint.cmdEstInstance.parent("tabx1",0)
Gui.F_Est_Maint.cmdEstInstance.event(Click,CMDEstimator)
Gui.F_Est_Maint.cmdEstInstance.defaultvalue("")
Gui.F_Est_Maint.txtMatWidth.create(textbox,"",True,1215,300,0,2415,2400,True,1,Arial,8,-2147483643,1)
Gui.F_Est_Maint.txtMatWidth.parent("tabx1",1)
Gui.F_Est_Maint.txtMatWidth.numericonly(1)
Gui.F_Est_Maint.txtMatWidth.event(LostFocus,CMDMaterial)
Gui.F_Est_Maint.txtMatWidth.defaultvalue("")
Gui.F_Est_Maint.txtMatWidth.tabstop(True)
Gui.F_Est_Maint.txtMatWidth.tabindex(108)
Gui.F_Est_Maint.lbl94.create(label,"Width",True,705,210,1,2415,2205,True,0,Arial,8,-2147483633,0)
Gui.F_Est_Maint.lbl94.parent("tabx1",1)
Gui.F_Est_Maint.lbl94.defaultvalue("")
Gui.F_Est_Maint.lbl95.create(label,"Current Locks",True,1155,255,1,1725,2460,True,0,Arial,8,-2147483633,0)
Gui.F_Est_Maint.lbl95.parent("tabx1",0)
Gui.F_Est_Maint.lbl95.defaultvalue("")
Gui.F_Est_Maint.gsfgEstLocks.create(gsflexgrid)
Gui.F_Est_Maint.gsfgEstLocks.size(3780,3720)
Gui.F_Est_Maint.gsfgEstLocks.position(1725,2685)
Gui.F_Est_Maint.gsfgEstLocks.parent("tabx1",0)
Gui.F_Est_Maint.cmdEstDeleteLock.create(button)
Gui.F_Est_Maint.cmdEstDeleteLock.caption("Delete")
Gui.F_Est_Maint.cmdEstDeleteLock.size(855,375)
Gui.F_Est_Maint.cmdEstDeleteLock.position(1725,6495)
Gui.F_Est_Maint.cmdEstDeleteLock.parent("tabx1",0)
Gui.F_Est_Maint.cmdEstDeleteLock.event(Click,CMDEstimator)
Gui.F_Est_Maint.cmdEstDeleteLock.defaultvalue("")
Gui.F_Est_Maint.cmdEstRefreshLocks.create(button)
Gui.F_Est_Maint.cmdEstRefreshLocks.caption("Refresh")
Gui.F_Est_Maint.cmdEstRefreshLocks.size(855,375)
Gui.F_Est_Maint.cmdEstRefreshLocks.position(2715,6495)
Gui.F_Est_Maint.cmdEstRefreshLocks.parent("tabx1",0)
Gui.F_Est_Maint.cmdEstRefreshLocks.event(Click,CMDEstimator)
Gui.F_Est_Maint.cmdEstRefreshLocks.defaultvalue("")
Gui.F_Est_Maint.lbl96.create(label,"New Sort Type",False,1140,255,1,10005,10005,True,0,Arial,8,-2147483633,0)
Gui.F_Est_Maint.lbl96.parent("tabx1",5)
Gui.F_Est_Maint.lbl96.defaultvalue("")
Gui.F_Est_Maint.txtSortType.create(textbox,"",False,1680,300,0,10005,10005,True,0,Arial,8,-2147483643,1)
Gui.F_Est_Maint.txtSortType.parent("tabx1",5)
Gui.F_Est_Maint.txtSortType.defaultvalue("")
Gui.F_Est_Maint.cmdAddSortType.create(button)
Gui.F_Est_Maint.cmdAddSortType.caption("Add")
Gui.F_Est_Maint.cmdAddSortType.size(585,315)
Gui.F_Est_Maint.cmdAddSortType.position(10005,10005)
Gui.F_Est_Maint.cmdAddSortType.parent("tabx1",5)
Gui.F_Est_Maint.cmdAddSortType.event(Click,CMDSort)
Gui.F_Est_Maint.cmdAddSortType.defaultvalue("")
Gui.F_Est_Maint.cmdAddSortType.Visible(False)
Gui.F_Est_Maint.ddlSortType.create(dropdownlist)
Gui.F_Est_Maint.ddlSortType.size(1980,330)
Gui.F_Est_Maint.ddlSortType.position(10005,10005)
Gui.F_Est_Maint.ddlSortType.parent("tabx1",5)
Gui.F_Est_Maint.ddlSortType.event(Click,CMDSort)
Gui.F_Est_Maint.ddlSortType.defaultvalue("")
Gui.F_Est_Maint.ddlSortType.Visible(False)
Gui.F_Est_Maint.lbl97.create(label,"Product Line",False,1155,255,1,10005,10005,True,0,Arial,8,-2147483633,0)
Gui.F_Est_Maint.lbl97.parent("tabx1",5)
Gui.F_Est_Maint.lbl97.defaultvalue("")
Gui.F_Est_Maint.txtSortPL.create(textbox,"",False,420,300,0,10005,10005,True,0,Arial,8,-2147483643,1)
Gui.F_Est_Maint.txtSortPL.parent("tabx1",5)
Gui.F_Est_Maint.txtSortPL.maxLength(2)
Gui.F_Est_Maint.txtSortPL.event(LostFocus,CMDSort)
Gui.F_Est_Maint.txtSortPL.defaultvalue("")
Gui.F_Est_Maint.cmdBrowseSortPL.create(button)
Gui.F_Est_Maint.cmdBrowseSortPL.caption("^")
Gui.F_Est_Maint.cmdBrowseSortPL.size(420,315)
Gui.F_Est_Maint.cmdBrowseSortPL.position(10005,10005)
Gui.F_Est_Maint.cmdBrowseSortPL.parent("tabx1",5)
Gui.F_Est_Maint.cmdBrowseSortPL.event(Click,CMDSort)
Gui.F_Est_Maint.cmdBrowseSortPL.defaultvalue("")
Gui.F_Est_Maint.cmdBrowseSortPL.Visible(False)
Gui.F_Est_Maint.gsfgSortPL.create(gsflexgrid)
Gui.F_Est_Maint.gsfgSortPL.size(960,2220)
Gui.F_Est_Maint.gsfgSortPL.position(10005,10005)
Gui.F_Est_Maint.gsfgSortPL.parent("tabx1",5)
Gui.F_Est_Maint.gsfgSortPL.event(MouseUp,CMDSort)
Gui.F_Est_Maint.gsfgSortPL.Visible(False)
Gui.F_Est_Maint.cmdSortSavePL.create(button)
Gui.F_Est_Maint.cmdSortSavePL.caption("Save PL")
Gui.F_Est_Maint.cmdSortSavePL.size(855,315)
Gui.F_Est_Maint.cmdSortSavePL.position(10005,10005)
Gui.F_Est_Maint.cmdSortSavePL.parent("tabx1",5)
Gui.F_Est_Maint.cmdSortSavePL.event(Click,CMDSort)
Gui.F_Est_Maint.cmdSortSavePL.defaultvalue("")
Gui.F_Est_Maint.cmdSortSavePL.Visible(False)
Gui.F_Est_Maint.gsfgSortCode.create(gsflexgrid)
Gui.F_Est_Maint.gsfgSortCode.visible(False)
Gui.F_Est_Maint.gsfgSortCode.size(1680,2760)
Gui.F_Est_Maint.gsfgSortCode.position(10005,10005)
Gui.F_Est_Maint.gsfgSortCode.parent("tabx1",5)
Gui.F_Est_Maint.gsfgSortCode.event(ListExit,CMDSort)
Gui.F_Est_Maint.cmdRemoveSortPL.create(button)
Gui.F_Est_Maint.cmdRemoveSortPL.caption("Remove PL")
Gui.F_Est_Maint.cmdRemoveSortPL.visible(False)
Gui.F_Est_Maint.cmdRemoveSortPL.size(930,315)
Gui.F_Est_Maint.cmdRemoveSortPL.position(10005,10005)
Gui.F_Est_Maint.cmdRemoveSortPL.parent("tabx1",5)
Gui.F_Est_Maint.cmdRemoveSortPL.event(Click,CMDSort)
Gui.F_Est_Maint.cmdRemoveSortPL.defaultvalue("")
Gui.F_Est_Maint.cmdSaveSortCode.create(button)
Gui.F_Est_Maint.cmdSaveSortCode.caption("Save Sort Codes")
Gui.F_Est_Maint.cmdSaveSortCode.visible(False)
Gui.F_Est_Maint.cmdSaveSortCode.size(1350,315)
Gui.F_Est_Maint.cmdSaveSortCode.position(10005,10005)
Gui.F_Est_Maint.cmdSaveSortCode.parent("tabx1",5)
Gui.F_Est_Maint.cmdSaveSortCode.event(Click,CMDSort)
Gui.F_Est_Maint.cmdSaveSortCode.defaultvalue("")
Gui.F_Est_Maint.lblSortCode.create(label,"Sort Code(s)",False,975,255,1,10005,10005,True,0,Arial,8,-2147483633,0)
Gui.F_Est_Maint.lblSortCode.parent("tabx1",5)
Gui.F_Est_Maint.lblSortCode.defaultvalue("")
Gui.F_Est_Maint.txtTolVenNum.create(textbox,"",True,1410,300,0,4080,915,False,0,Arial,8,-2147483643,1)
Gui.F_Est_Maint.txtTolVenNum.parent("tabx1",2)
Gui.F_Est_Maint.txtTolVenNum.maxLength(6)
Gui.F_Est_Maint.txtTolVenNum.event(LostFocus,CMDMaterial)
Gui.F_Est_Maint.txtTolVenNum.defaultvalue("0")
Gui.F_Est_Maint.txtTolVenNum.tabstop(False)
Gui.F_Est_Maint.lbl98.create(label,"Vendor Number",True,1290,195,1,4080,735,True,0,Arial,8,-2147483633,0)
Gui.F_Est_Maint.lbl98.parent("tabx1",2)
Gui.F_Est_Maint.lbl98.defaultvalue("")
Gui.F_Est_Maint.txtTolActPrice.create(textbox,"",True,1395,300,0,6165,915,False,1,Arial,8,-2147483643,1)
Gui.F_Est_Maint.txtTolActPrice.parent("tabx1",2)
Gui.F_Est_Maint.txtTolActPrice.numericonly(1)
Gui.F_Est_Maint.txtTolActPrice.event(LostFocus,CMDMaterial)
Gui.F_Est_Maint.txtTolActPrice.defaultvalue("0")
Gui.F_Est_Maint.txtTolActPrice.tabstop(False)
Gui.F_Est_Maint.lbl99.create(label,"GSS Price",True,960,195,1,6165,735,True,0,Arial,8,-2147483633,0)
Gui.F_Est_Maint.lbl99.parent("tabx1",2)
Gui.F_Est_Maint.lbl99.defaultvalue("")
Gui.F_Est_Maint.cmdTolVenBrowse.create(button)
Gui.F_Est_Maint.cmdTolVenBrowse.caption("^")
Gui.F_Est_Maint.cmdTolVenBrowse.size(495,330)
Gui.F_Est_Maint.cmdTolVenBrowse.position(5550,915)
Gui.F_Est_Maint.cmdTolVenBrowse.parent("tabx1",2)
Gui.F_Est_Maint.cmdTolVenBrowse.event(Click,CMDMaterial)
Gui.F_Est_Maint.cmdTolVenBrowse.defaultvalue("")
Gui.F_Est_Maint.cmdTolVenBrowse.tabstop(False)
Gui.F_Est_Maint.cmdTolVenBrowse.Visible(False)
Gui.F_Est_Maint.cmdMatVenBrowse.create(button)
Gui.F_Est_Maint.cmdMatVenBrowse.caption("^")
Gui.F_Est_Maint.cmdMatVenBrowse.size(495,330)
Gui.F_Est_Maint.cmdMatVenBrowse.position(5265,705)
Gui.F_Est_Maint.cmdMatVenBrowse.parent("tabx1",1)
Gui.F_Est_Maint.cmdMatVenBrowse.event(Click,CMDMaterial)
Gui.F_Est_Maint.cmdMatVenBrowse.defaultvalue("")
Gui.F_Est_Maint.cmdMatVenBrowse.tabstop(False)
Gui.F_Est_Maint.cmdMatVenBrowse.Visible(False)
Gui.F_Est_Maint.GsGcOPCode.Create(GsGridControl)
Gui.F_Est_Maint.GsGcOPCode.Size(7725,7230)
Gui.F_Est_Maint.GsGcOPCode.Position(4965,105)
Gui.F_Est_Maint.GsGcOPCode.Parent("tabx1",5)
Gui.F_Est_Maint.cmdOPSave.Create(Button)
Gui.F_Est_Maint.cmdOPSave.Size(855,375)
Gui.F_Est_Maint.cmdOPSave.Position(4965,7425)
Gui.F_Est_Maint.cmdOPSave.Parent("tabx1",5)
Gui.F_Est_Maint.cmdOPSave.Caption("Save")
Gui.F_Est_Maint.cmdOPSave.Event(Click,DTSave)
Gui.F_Est_Maint.GSGCColor.Create(GsGridControl)
Gui.F_Est_Maint.GSGCColor.Size(4605,3315)
Gui.F_Est_Maint.GSGCColor.Position(105,105)
Gui.F_Est_Maint.GSGCColor.Parent("tabx1",5)
Gui.F_Est_Maint.GSGCColor.ContextMenuAttach("ctxColor")
Gui.F_Est_Maint.cmdColorSave.Create(Button)
Gui.F_Est_Maint.cmdColorSave.Size(855,375)
Gui.F_Est_Maint.cmdColorSave.Position(105,3570)
Gui.F_Est_Maint.cmdColorSave.Parent("tabx1",5)
Gui.F_Est_Maint.cmdColorSave.Caption("Save")
Gui.F_Est_Maint.cmdColorSave.Event(Click,cmdColorSave_Click)
Gui.F_Est_Maint.lblMSave.Create(Label,"Save",True,1935,255,0,2205,7410,True,0,"Arial",8,-2147483633,0)
Gui.F_Est_Maint.lblMSave.Parent("tabx1",1)
Gui.F_Est_Maint.lblMSave.ForeColor(255)
Gui.F_Est_Maint.lblTSave.Create(Label,"save",True,1935,255,0,2445,3810,True,0,"Arial",8,-2147483633,0)
Gui.F_Est_Maint.lblTSave.Parent("tabx1",2)
Gui.F_Est_Maint.lblTSave.ForeColor(255)
Gui.F_Est_Maint.gsfgEstGroup.create(gsflexgrid)
Gui.F_Est_Maint.gsfgEstGroup.size(8370,1800)
Gui.F_Est_Maint.gsfgEstGroup.position(300,9690)
Gui.F_Est_Maint.gsfgEstGroup.tabstop(False)
Gui.F_Est_Maint.lbl18.create(label,"Estimator Group Security Options",True,2925,255,1,195,9330,True,0,Arial,8,-2147483633,0)
Gui.F_Est_Maint.lbl18.defaultvalue("")
Gui.F_Est_Maint.cmdEstSaveGroups.create(button)
Gui.F_Est_Maint.cmdEstSaveGroups.caption("Save")
Gui.F_Est_Maint.cmdEstSaveGroups.size(855,375)
Gui.F_Est_Maint.cmdEstSaveGroups.position(600,9270)
Gui.F_Est_Maint.cmdEstSaveGroups.event(Click,CMDEstimator)
Gui.F_Est_Maint.cmdEstSaveGroups.defaultvalue("")
Gui.F_Est_Maint.cmdEstSaveGroups.tabstop(False)
Program.Sub.ScreenSU.End

Program.Sub.Preflight.Start
Variable.Global.iWGID.Declare(Long,0)
Variable.Global.iFGID.Declare(Long,0)
Variable.UDT.uGroups.Define("Cust_Mast",Boolean,CUST_MAST)
Variable.UDT.uGroups.Define("CRM",Boolean,CRM)
Variable.UDT.uGroups.Define("Inv_Mast",Boolean,INV_MAST)
Variable.UDT.uGroups.Define("Ven_Mast",Boolean,VEN_MAST)
Variable.UDT.uGroups.Define("Supp_Dem",Boolean,SUPP_DEM)
Variable.UDT.uGroups.Define("Website",Boolean,WEBSITE)
Variable.UDT.uGroups.Define("Admin",Boolean,ADMIN1)
Variable.UDT.uGroups.Define("Group",String,GRP)
Variable.uGlobal.uGroups.Declare("uGroups")
Variable.uGlobal.uGroupsSave.Declare("uGroups")
Variable.UDT.uSpd.Define("FT_PER_ROLL",String,FEET_PER_ROLL)
Variable.UDT.uSpd.Define("BLANK_SPD",Float,BLANK_SPD)
Variable.UDT.uSpd.Define("PRINT_SPD",Float,PRINT_SPD)
Variable.UDT.uSpd.Define("IDS",Long,IDS)
Variable.uGlobal.uSpd.Declare("uSpd")
Variable.Global.iID.Declare(Long,1)
Variable.Global.bAccess.Declare(Boolean,False)
Variable.UDT.uType.Define("Description",String,DESCRIPTION)
Variable.UDT.uType.Define("Type",String,TYPE1)
Variable.UDT.uType.Define("ACTIVE",Boolean,ACTIVE)
Variable.UDT.uType.Define("Num",Long)
Variable.uGlobal.uFOB.Declare("uType")
Variable.uGlobal.uUP.Declare("uType")
Variable.UDT.uSortCode.Define("SortCode",String,SORT_CODE)
Variable.UDT.uSortCode.Define("ProductLine",String,PL)
Variable.uGlobal.uSortCode.Declare("uSortCode")
Program.Sub.Preflight.End

Program.Sub.Main.Start
F.Intrinsic.Control.SetErrorHandler("Main_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String)
V.Local.sPart.Declare(String)

V.Global.bAccess.Set(True)
F.ODBC.Connection!Con.OpenConnection(V.Ambient.PDSN,V.Ambient.PUser,V.Ambient.PPass)

F.Intrinsic.UI.SetBrowserHotTypeAhead(True)
'We have to set the degree symbol manually
f.Intrinsic.String.Build("Min Applic {0}F",v.ASCII.0176,v.Local.sPart)
Gui.F_Est_Maint.lbl14.Caption(v.Local.sPart)
f.Intrinsic.String.Build("Service Temp Low {0}F",v.ASCII.0176,v.Local.sPart)
Gui.F_Est_Maint.lbl12.Caption(v.Local.sPart)
f.Intrinsic.String.Build("Service Temp High {0}F",v.ASCII.0176,v.Local.sPart)
Gui.F_Est_Maint.lbl70.Caption(v.Local.sPart)
Gui.F_Est_Maint.lblMSave.Caption("")
Gui.F_Est_Maint.lblTSave.Caption("")
v.Local.sPart.Set("")

'Check to make sure user has rights to look at Estimator Maintenance
F.Intrinsic.Control.CallSub(Check_credentials)

'Set up Script button Labels
F.Intrinsic.Control.If(V.Caller.Hook,=,10120,"OR",V.Caller.Hook,=,14840)
	V.Passed.000068.Set("Est Maint")
F.Intrinsic.Control.Else
	F.Intrinsic.Control.If(V.Global.bAccess,=,True)
		'If called from Inventory
		F.Intrinsic.Control.If(V.Caller.Hook,=,10210)
			'Check to make sure part selected, if not close program
			F.Intrinsic.Control.If(V.Passed.000007.Trim,=,"")
				F.Intrinsic.Control.CallSub(F_est_maint_unload)
			F.Intrinsic.Control.EndIf

			Gui.F_Est_Maint.tabx1.SetTab(1)
			'Save full part and pass to Load Material to load screen based on part selected
			F.Intrinsic.String.GSSPartString(V.Passed.000007,V.Passed.000008,V.Local.sPart)
			'Load Lists and Dropdownlist for Material Tab
			F.Intrinsic.Control.CallSub(Load_material)
			F.Intrinsic.Control.CallSub(Load_part,"Part",V.Local.sPart,"Loc",V.Passed.000009,"Desc",V.Passed.000012,"SC",V.Passed.000025)
			'Hide Browser so that user can't change part
			Gui.F_Est_Maint.cmdMatBrowse.Visible(False)
			'Hide Clear Button Since only this one is modified
			Gui.F_Est_Maint.cmdMatClear.Visible(False)
			'Hide Tooling buttons
			Gui.F_Est_Maint.cmdTolClear.Visible(False)
			Gui.F_Est_Maint.cmdTolBrowse.Visible(False)
			'Hide other tabs since they don't have anything to do with inventory
			Gui.F_Est_Maint.tabx1.TabVisible(0,False)
			Gui.F_Est_Maint.tabx1.TabVisible(3,False)
			Gui.F_Est_Maint.tabx1.TabVisible(4,False)
			Gui.F_Est_Maint.tabx1.TabVisible(5,False)
		'If called from Workcenter
		F.Intrinsic.Control.ElseIf(V.Caller.Hook,=,14860)
			'Check to make sure workcenter is selected, if not close program
			F.Intrinsic.Control.If(V.Passed.000005.Trim,=,"")
				F.Intrinsic.Control.CallSub(F_est_maint_unload)
			F.Intrinsic.Control.EndIf

			Gui.F_Est_Maint.tabx1.SetTab(3)
			'Initialize WC Attributes FlexGrid
			F.Intrinsic.Control.CallSub(Load_labor)
			'Set Workcenter Text Box
			Gui.F_Est_Maint.txtLabWC.Text(V.Passed.000005)
			'Set data
			F.Intrinsic.Control.CallSub(Cmdlabor,"ControlName","CMDLABWCLOC")
			'Hide other tabs since they don't have anything to do with inventory
			Gui.F_Est_Maint.tabx1.TabVisible(0,False)
			Gui.F_Est_Maint.tabx1.TabVisible(1,False)
			Gui.F_Est_Maint.tabx1.TabVisible(2,False)
			Gui.F_Est_Maint.tabx1.TabVisible(4,False)
			Gui.F_Est_Maint.tabx1.TabVisible(5,False)
			'Hide Workcenter Browser
			Gui.F_Est_Maint.cmdLabWC.Visible(False)
			Gui.F_Est_Maint.cmdLabWCClear.Visible(False)
		F.Intrinsic.Control.Else
			Gui.F_Est_Maint.tabx1.SetTab(0)
			'Load Websites
			F.Intrinsic.Control.CallSub(Load_webgrid)
			'Initialize Estimator Tab
			F.Intrinsic.Control.CallSub(Load_estimator)
			'Initialize WC Attributes FlexGrid
			F.Intrinsic.Control.CallSub(Load_labor)
			'Initialize List and Dropdown for Material Tab
			F.Intrinsic.Control.CallSub(Load_material)
			'Initialize the Sort Tab
			F.Intrinsic.Control.CallSub(Load_sort)
			f.Intrinsic.Control.CallSub(datatablecreation)
			f.Intrinsic.Control.CallSub(ColorCreation)
		F.Intrinsic.Control.EndIf
	
		Gui.F_Est_Maint..Show

	F.Intrinsic.Control.EndIf
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("Main_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	Function.Intrinsic.String.Concat("Project: GCG_3623_Custom_Maintenance.g2u",V.Ambient.Newline,V.Ambient.Newline,"Subroutine: ",V.Ambient.CurrentSubroutine,V.Ambient.NewLine,"Error Occurred ",V.Ambient.ErrorNumber," with description ",V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.CallSub(F_est_maint_unload)
Function.Intrinsic.Control.EndIf


Program.Sub.Main.End

Program.Sub.Load_WebGrid.Start
F.Intrinsic.Control.SetErrorHandler("Load_WebGrid_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String)
V.Local.iRows.Declare(Long)

'This sub will load the 3 flexgrids for the websites
'Populated using GCG_3623_Web table
'Material grid will have OP_ID = 1
'Labor grid will have OP_ID = 2
'Other grid will have OP_ID = 3

''Call buildstyle
'F.Intrinsic.Control.CallSub(Buildstyle_web)

f.Data.DataTable.CreateFromSQL("Web","Con","SELECT OP_ID, SEQ, RTRIM(DISPLAY) AS DISPLAY, RTRIM(WEB_LINK) AS WEB_LINK FROM GCG_3623_WEB",True)

f.Data.DataView.Create("Web","Material",22,"OP_ID = 1","")
f.Data.DataView.Create("Web","Labor",22,"OP_ID = 2","")
f.Data.DataView.Create("Web","Other",22,"OP_ID = 3","")



''load Material Grid with Style 2
'F.ODBC.Connection!Con.OpenLocalRecordsetRO("rstMat","SELECT SEQ, DISPLAY, WEB_LINK, 'Update', 'Remove' FROM GCG_3623_WEB WHERE OP_ID = 1 ORDER BY DISPLAY ASC ")
'Gui.F_Est_Maint.gsfgMaterial.LoadRecordset("Con!rstMat",2)
'F.ODBC.Con!rstMat.Close
'
''set to Style 3
'f.Intrinsic.Control.If(V.Screen.F_Est_Maint!gsfgMaterial.Rows,>,1)
'	F.Intrinsic.Math.Sub(V.Screen.F_Est_Maint!gsfgMaterial.Rows,1,V.Local.iRows)
'f.Intrinsic.Control.Else
'	f.Intrinsic.Math.Add(V.Screen.F_Est_Maint!gsfgMaterial.Rows,2,v.Local.iRows)
'	Gui.F_Est_Maint.gsfgMaterial.Rows(v.Local.iRows)
'	f.Intrinsic.Math.Sub(v.Local.iRows,2,v.Local.iRows)
'f.Intrinsic.Control.EndIf
'Gui.F_Est_Maint.gsfgMaterial.ApplyStyle(V.Local.iRows,3)
'

''load Labor Grid with Style 2
'F.ODBC.Connection!Con.OpenLocalRecordsetRO("rstLabor","SELECT SEQ,  DISPLAY, WEB_LINK, 'Update', 'Remove' FROM GCG_3623_WEB WHERE OP_ID = 2 ORDER BY DISPLAY ASC ")
'Gui.F_Est_Maint.gsfgLabor.LoadRecordset("Con!rstLabor",2)
'F.ODBC.Con!rstLabor.Close
'
''set to Style 3
'f.Intrinsic.Control.If(V.Screen.F_Est_Maint!gsfgLabor.Rows,>,1)
'	F.Intrinsic.Math.Sub(V.Screen.F_Est_Maint!gsfgLabor.Rows,1,V.Local.iRows)
'f.Intrinsic.Control.Else
'	f.Intrinsic.Math.Add(V.Screen.F_Est_Maint!gsfgLabor.Rows,2,v.Local.iRows)
'	Gui.F_Est_Maint.gsfgLabor.Rows(v.Local.iRows)
'	f.Intrinsic.Math.Sub(v.Local.iRows,2,v.Local.iRows)
'f.Intrinsic.Control.EndIf
'Gui.F_Est_Maint.gsfgLabor.ApplyStyle(V.Local.iRows,3)
'

''load Other with Style 2
'F.ODBC.Connection!Con.OpenLocalRecordsetRO("rstOther","SELECT SEQ,  DISPLAY, WEB_LINK, 'Update', 'Remove' FROM GCG_3623_WEB WHERE OP_ID = 3 ORDER BY DISPLAY ASC ")
'Gui.F_Est_Maint.gsfgOther.LoadRecordset("Con!rstOther",2)
'F.ODBC.Con!rstOther.Close
'
''set to Style 3
'f.Intrinsic.Control.If(V.Screen.F_Est_Maint!gsfgOther.Rows,>,1)
'	F.Intrinsic.Math.Sub(V.Screen.F_Est_Maint!gsfgOther.Rows,1,V.Local.iRows)
'f.Intrinsic.Control.Else
'	f.Intrinsic.Math.Add(V.Screen.F_Est_Maint!gsfgOther.Rows,2,v.Local.iRows)
'	Gui.F_Est_Maint.gsfgOther.Rows(v.Local.iRows)
'	f.Intrinsic.Math.Sub(v.Local.iRows,2,v.Local.iRows)
'f.Intrinsic.Control.EndIf
'Gui.F_Est_Maint.gsfgOther.ApplyStyle(V.Local.iRows,3)

'Call buildstyle
F.Intrinsic.Control.CallSub(Buildstyle_web)

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("Load_WebGrid_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	Function.Intrinsic.String.Concat("Project: GCG_3623_Custom_Maintenance.g2u",V.Ambient.Newline,V.Ambient.Newline,"Subroutine: ",V.Ambient.CurrentSubroutine,V.Ambient.NewLine,"Error Occurred ",V.Ambient.ErrorNumber," with description ",V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.CallSub(F_est_maint_unload)
Function.Intrinsic.Control.EndIf


Program.Sub.Load_WebGrid.End

Program.Sub.BuildStyle_Web.Start
F.Intrinsic.Control.SetErrorHandler("BuildStyle_Web_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String)
V.Local.sGridNameVar.Declare(String)
V.Local.sGridName.Declare(String)
V.Local.iCount.Declare(Long)
v.Local.sGridNameGrid.Declare(String)


'Create Buildstyles for Material, Labor, and Other flexgrids
'all styles are the same
Gui.F_Est_Maint.gsfgMaterial.AddGridViewFromDataView("GridMaterial","Web","Material")
Gui.F_Est_Maint.gsfgLabor.AddGridViewFromDataView("GridLabor","Web","Labor")
Gui.F_Est_Maint.gsfgOther.AddGridViewFromDataView("GridOther","Web","Other")

'Create grid name array for loop
F.Intrinsic.String.Split("gsfgMaterial*!*gsfgLabor*!*gsfgOther","*!*",V.Local.sGridNameVar)
f.Intrinsic.String.Split("GridMaterial*!*GridLabor*!*GridOther","*!*",v.Local.sGridNameGrid)
'
''Loop through the grid names and create the buildstyles
F.Intrinsic.Control.For(V.Local.iCount,V.Local.sGridNameVar.LBound,V.Local.sGridNameVar.UBound,1)
	V.Local.sGridName.Set(V.Local.sGridNameVar(v.Local.iCount))
	
	Gui.F_Est_Maint.[v.Local.sGridName].SetColumnProperty(v.Local.sGridNameGrid(v.Local.iCount),"OP_ID","Visible",False)
	Gui.F_Est_Maint.[v.Local.sGridName].SetColumnProperty(v.Local.sGridNameGrid(v.Local.iCount),"SEQ","Visible",False)
	Gui.F_Est_Maint.[v.Local.sGridName].SetColumnProperty(v.Local.sGridNameGrid(v.Local.iCount),"Display","Caption","Display Name")
	Gui.F_Est_Maint.[v.Local.sGridName].SetColumnProperty(v.Local.sGridNameGrid(v.Local.iCount),"Display","AllowEdit",True)
	Gui.F_Est_Maint.[v.Local.sGridName].SetColumnProperty(v.Local.sGridNameGrid(v.Local.iCount),"Display","ReadOnly",False)
	Gui.F_Est_Maint.[v.Local.sGridName].SetColumnProperty(v.Local.sGridNameGrid(v.Local.iCount),"WEB_LINK","Caption","Link using http://")
	Gui.F_Est_Maint.[v.Local.sGridName].SetColumnProperty(v.Local.sGridNameGrid(v.Local.iCount),"WEB_LINK","AllowEdit",True)
	Gui.F_Est_Maint.[v.Local.sGridName].SetColumnProperty(v.Local.sGridNameGrid(v.Local.iCount),"WEB_LINK","ReadOnly",False)
	Gui.F_Est_Maint.[v.Local.sGridName].SetColumnProperty(v.Local.sGridNameGrid(v.Local.iCount),"WEB_LINK","CellForeColor","Blue")
	Gui.F_Est_Maint.[v.Local.sGridName].SetColumnProperty(v.Local.sGridNameGrid(v.Local.iCount),"WEB_LINK","CellFontUnderline",True)
	Gui.F_Est_Maint.[v.Local.sGridName].MainView(v.Local.sGridNameGrid(v.Local.iCount))
'
'	Gui.F_Est_Maint.[v.Local.sGridName].Cols(5)
'	Gui.F_Est_Maint.[v.Local.sGridName].Rows(2)
'	Gui.F_Est_Maint.[v.Local.sGridName].FixedRows(1)
'	Gui.F_Est_Maint.[v.Local.sGridName].SetColumnPercentages("0:.224:.50:.125:.15")
'	'Grid Titles
'	'Style 1
'	'Display Name
'	Gui.F_Est_Maint.[v.Local.sGridName].TextMatrix(1,0,"Display Name")
'	Gui.F_Est_Maint.[v.Local.sGridName].Buildstyle(1,1,"Type","Locked",True)
'	Gui.F_Est_Maint.[v.Local.sGridName].Buildstyle(1,1,"Format","Alignment",4)
'	'Link
'	Gui.F_Est_Maint.[v.Local.sGridName].TextMatrix(2,0,"Link using http://")
'	Gui.F_Est_Maint.[v.Local.sGridName].Buildstyle(1,2,"Type","Locked",True)
'	Gui.F_Est_Maint.[v.Local.sGridName].Buildstyle(1,2,"Format","Alignment",4)
'	'Add/update
'	Gui.F_Est_Maint.[v.Local.sGridName].TextMatrix(3,0,"Add/Update")
'	Gui.F_Est_Maint.[v.Local.sGridName].Buildstyle(1,3,"Type","Locked",True)
'	Gui.F_Est_Maint.[v.Local.sGridName].Buildstyle(1,3,"Format","Alignment",4)
'	'Clear/Remove
'	Gui.F_Est_Maint.[v.Local.sGridName].TextMatrix(4,0,"Clear/Remove")
'	Gui.F_Est_Maint.[v.Local.sGridName].Buildstyle(1,4,"Type","Locked",True)
'	Gui.F_Est_Maint.[v.Local.sGridName].Buildstyle(1,4,"Format","Alignment",4)
'	'Grid Rows
'	'Style 2
'	'Update or Remove, Row already exists and is populated by the Table
'	'Display Name
'	Gui.F_Est_Maint.[v.Local.sGridName].Buildstyle(2,1,"Type","Locked",False)
'	Gui.F_Est_Maint.[v.Local.sGridName].Buildstyle(2,1,"Format","Alignment",2)
'	'Link
'	Gui.F_Est_Maint.[v.Local.sGridName].Buildstyle(2,2,"Type","Locked",False)
'	Gui.F_Est_Maint.[v.Local.sGridName].Buildstyle(2,2,"Format","Alignment",2)
'	Gui.F_Est_Maint.[v.Local.sGridName].Buildstyle(2,2,"Fontstyle","Underline",True)
'	Gui.F_Est_Maint.[v.Local.sGridName].Buildstyle(2,2,"Color","Fore",16711680)
'	'Update
'	Gui.F_Est_Maint.[v.Local.sGridName].Buildstyle(2,3,"Type","Command","Update")
'	Gui.F_Est_Maint.[v.Local.sGridName].Buildstyle(2,3,"Color","Fore",V.Color.Green)
'	Gui.F_Est_Maint.[v.Local.sGridName].Buildstyle(2,3,"Format","Alignment",4)
'	'Remove
'	Gui.F_Est_Maint.[v.Local.sGridName].Buildstyle(2,4,"Type","Command","Remove")
'	Gui.F_Est_Maint.[v.Local.sGridName].Buildstyle(2,4,"Color","Fore",V.Color.Red)
'	Gui.F_Est_Maint.[v.Local.sGridName].Buildstyle(2,4,"Format","Alignment",4)
'	'Style 3
'	'Add or Clear, Row does not already exist in the Table
'	'Display Name
'	Gui.F_Est_Maint.[v.Local.sGridName].Buildstyle(3,1,"Type","Locked",False)
'	Gui.F_Est_Maint.[v.Local.sGridName].Buildstyle(3,1,"Format","Alignment",2)
'	'Link
'	Gui.F_Est_Maint.[v.Local.sGridName].Buildstyle(3,2,"Type","Locked",False)
'	Gui.F_Est_Maint.[v.Local.sGridName].Buildstyle(3,2,"Format","Alignment",2)
'	Gui.F_Est_Maint.[v.Local.sGridName].Buildstyle(3,2,"Fontstyle","Underline",True)
'	Gui.F_Est_Maint.[v.Local.sGridName].Buildstyle(3,2,"Color","Fore",16711680)
'	'Update
'	Gui.F_Est_Maint.[v.Local.sGridName].Buildstyle(3,3,"Type","Command","Add")
'	Gui.F_Est_Maint.[v.Local.sGridName].Buildstyle(3,3,"Color","Fore",V.Color.Green)
'	Gui.F_Est_Maint.[v.Local.sGridName].Buildstyle(3,3,"Format","Alignment",4)
'	'Remove
'	Gui.F_Est_Maint.[v.Local.sGridName].Buildstyle(3,4,"Type","Command","Clear")
'	Gui.F_Est_Maint.[v.Local.sGridName].Buildstyle(3,4,"Color","Fore",V.Color.Red)
'	Gui.F_Est_Maint.[v.Local.sGridName].Buildstyle(3,4,"Format","Alignment",4)
'
	'Apply Style 1 Header
'	Gui.F_Est_Maint.[v.Local.sGridName].ApplyStyle(0,1)
'
F.Intrinsic.Control.Next(V.Local.iCount)


F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("BuildStyle_Web_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	Function.Intrinsic.String.Concat("Project: GCG_3623_Custom_Maintenance.g2u",V.Ambient.Newline,V.Ambient.Newline,"Subroutine: ",V.Ambient.CurrentSubroutine,V.Ambient.NewLine,"Error Occurred ",V.Ambient.ErrorNumber," with description ",V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.CallSub(F_est_maint_unload)
Function.Intrinsic.Control.EndIf


Program.Sub.BuildStyle_Web.End

Program.Sub.fgWeb_Cmd.Start
F.Intrinsic.Control.SetErrorHandler("fgWeb_Cmd_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String)
V.Local.sButton.Declare(String)
V.Local.sSeq.Declare(String)
V.Local.sSQL.Declare(String)
V.Local.sDisplay.Declare(String)
V.Local.sLink.Declare(String)
V.Local.sControl.Declare(String)
V.Local.iRows.Declare(Long)
V.Local.iCount.Declare(Long)
V.Local.sUpdate.Declare(String)
V.Local.sRemove.Declare(String)
v.Local.iKey.Declare(Long)
v.Local.sRet.Declare(String)


'This sub handles the command buttons pressed on the website grids
'Use [v.Args.ControlName] in place of the control name of the individual grids so that this will be universal
F.Intrinsic.Control.SelectCase(V.Args.MenuName)
	F.Intrinsic.Control.Case("CTXMATERIAL")
		V.Local.sControl.Set("1")
	F.Intrinsic.Control.Case("CTXLABOR")
		V.Local.sControl.Set("2")
	F.Intrinsic.Control.Case("CTXOTHER")
		V.Local.sControl.Set("3")
F.Intrinsic.Control.EndSelect

f.Intrinsic.Control.SelectCase(v.Args.ItemName)
	'add
	f.Intrinsic.Control.Case("ADD")
		f.Intrinsic.String.Build("OP_ID = {0}",v.Local.sControl.Long,v.Local.sSeq)
		f.Data.DataTable.Compute("Web","MAX(SEQ)",v.Local.sSeq,v.Local.iKey)
		f.Intrinsic.Math.Add(v.Local.iKey,1,v.Local.iKey)
		F.Data.DataTable.AddRow("Web","OP_ID",v.Local.sControl.Long,"SEQ",v.Local.iKey)
	'delete
	f.Intrinsic.Control.Case("DELETE")
		f.Intrinsic.Control.SelectCase(v.Args.MenuName)
		f.Intrinsic.Control.Case("CTXMATERIAL")
			Gui.F_Est_Maint.gsfgMaterial.GetSelectedRows("GridMaterial",v.Local.sRet)
			
		F.Intrinsic.Control.Case("CTXLABOR")
			Gui.F_Est_Maint.gsfgLabor.GetSelectedRows("GridLabor",v.Local.sRet)
		f.Intrinsic.Control.Case("CTXOTHER")
			Gui.F_Est_Maint.gsfgOther.GetSelectedRows("GridOther",v.Local.sRet)
	f.Intrinsic.Control.EndSelect
	f.Intrinsic.Control.If(v.Local.sRet,<>,"")
		f.Data.DataTable.DeleteRow("Web",v.Local.sRet.Long)
	f.Intrinsic.Control.EndIf
f.Intrinsic.Control.EndSelect

''if col 3 Update/Add
'F.Intrinsic.Control.If(V.Args.Column,=,"3")
'	Gui.F_Est_Maint.[V.Args.ControlName].GetTextMatrix(3,V.Args.Key,V.Local.sButton)
'	'if button is Update then get the sequence and update the table
'	F.Intrinsic.Control.If(V.Local.sButton,=,"Update")
'		Gui.F_Est_Maint.[V.Args.ControlName].GetTextMatrix(0,V.Args.Key,V.Local.sSeq)
'		Gui.F_Est_Maint.[V.Args.ControlName].GetTextMatrix(1,V.Args.Key,V.Local.sDisplay)
'		Gui.F_Est_Maint.[V.Args.ControlName].GetTextMatrix(2,V.Args.Key,V.Local.sLink)
'		F.Intrinsic.String.Build("UPDATE GCG_3623_WEB SET DISPLAY = '{0}', WEB_LINK = '{1}' WHERE OP_ID = '{2}' AND SEQ = '{3}' ",V.Local.sDisplay.Trim,V.Local.sLink.Trim,V.Local.sControl.Trim,V.Local.sSeq,V.Local.sSQL)
'		F.ODBC.Connection!Con.Execute(V.Local.sSQL)
'
	'not Update so it is Add, Add line to Table, Change Buildstyle, and Add new Row
'	F.Intrinsic.Control.Else
'		'Get display and link
'		Gui.F_Est_Maint.[V.Args.ControlName].GetTextMatrix(1,V.Args.Key,V.Local.sDisplay)
'		Gui.F_Est_Maint.[V.Args.ControlName].GetTextMatrix(2,V.Args.Key,V.Local.sLink)
'		'get the next sequence
'		F.Intrinsic.String.Build("SELECT ISNULL(MAX(SEQ),0) + 1 AS SEQ  FROM GCG_3623_WEB WHERE OP_ID = '{0}' ",V.Local.sControl.Trim,V.Local.sSQL)
'		F.ODBC.Connection!Con.ExecuteAndReturn(V.Local.sSQL,V.Local.sSeq)
'		F.Intrinsic.String.Replace(V.Local.sSeq,"*!*","",V.Local.sSeq)
'		'set sequence in grid for later and update and remove
'		Gui.F_Est_Maint.[V.Args.ControlName].TextMatrix(0,V.Args.Key,V.Local.sSeq.Trim)
'		Gui.F_Est_Maint.[V.Args.ControlName].TextMatrix(3,V.Args.Key,"Update")
'		Gui.F_Est_Maint.[V.Args.ControlName].TextMatrix(4,V.Args.Key,"Remove")
'		'update the table
'		F.ODBC.Connection!Con.OpenLocalRecordsetRW("rstAdd","GCG_3623_WEB")
'		F.ODBC.Con!rstAdd.AddNew
'		F.ODBC.Con!rstAdd.Set!OP_ID(V.Local.sControl.Long)
'		F.ODBC.Con!rstAdd.Set!SEQ(V.Local.sSeq.Long)
'		F.ODBC.Con!rstAdd.Set!DISPLAY(V.Local.sDisplay.Trim)
'		F.ODBC.Con!rstAdd.Set!WEB_LINK(V.Local.sLink.Trim)
'		F.ODBC.Con!rstAdd.Update
'		F.ODBC.Con!rstAdd.Close
'		'change style to 2
'		Gui.F_Est_Maint.[v.Args.ControlName].ApplyStyle(V.Args.Key,2)
'		'Add new row and set style 3
'		F.Intrinsic.Math.Add(V.Screen.F_Est_Maint![v.Args.ControlName].Rows,1,V.Local.iRows)
''		v.Local.iRows.Set(V.Screen.F_Est_Maint![v.Args.ControlName].Rows)
'		Gui.F_Est_Maint.[v.Args.ControlName].Rows(V.Local.iRows)
'		F.Intrinsic.Math.Sub(V.Local.iRows,1,V.Local.iRows)
'		Gui.F_Est_Maint.[v.Args.ControlName].ApplyStyle(V.Local.iRows,3)
'
'	F.Intrinsic.Control.EndIf
'
''if Col 4 Remove/Clear
'F.Intrinsic.Control.ElseIf(V.Args.Column,=,"4")
'Function.Intrinsic.Debug.InvokeDebugger
'Function.Intrinsic.Debug.Stop
'Gui.F_Est_Maint.[V.Args.ControlName].GetTextMatrix(4,V.Args.Key,V.Local.sButton)
'	'if button is Remove then get the sequence and Remove from the table
'	F.Intrinsic.Control.If(V.Local.sButton,=,"Remove")
'		Gui.F_Est_Maint.[V.Args.ControlName].GetTextMatrix(0,V.Args.Key,V.Local.sSeq)
'		F.Intrinsic.String.Build("DELETE FROM GCG_3623_WEB WHERE OP_ID = '{0}' AND SEQ = '{1}' ",V.Local.sControl.Trim,V.Local.sSeq.Trim,V.Local.sSQL)
'		F.ODBC.Connection!Con.Execute(V.Local.sSQL)
'
		'loop through the rows and move them up to fill in the space
'		F.Intrinsic.Math.Sub(V.Screen.F_Est_Maint![v.Args.ControlName].Rows,2,V.Local.iRows)
'		F.Intrinsic.Control.For(V.Local.iCount,V.Args.Key,V.Local.iRows,1)
'			Gui.F_Est_Maint.[V.Args.ControlName].TextMatrix(0,V.Local.iCount,"")
'			Gui.F_Est_Maint.[V.Args.ControlName].TextMatrix(1,V.Local.iCount,"")
'			Gui.F_Est_Maint.[V.Args.ControlName].TextMatrix(2,V.Local.iCount,"")
'			Gui.F_Est_Maint.[V.Args.ControlName].TextMatrix(3,V.Local.iCount,"")
'			Gui.F_Est_Maint.[V.Args.ControlName].TextMatrix(4,V.Local.iCount,"")
'			F.Intrinsic.Math.Add(V.Local.iCount,1,V.Local.iCount)
'			Gui.F_Est_Maint.[V.Args.ControlName].GetTextMatrix(0,V.Local.iCount,V.Local.sSeq)
'			Gui.F_Est_Maint.[V.Args.ControlName].GetTextMatrix(1,V.Local.iCount,V.local.sDisplay)
'			Gui.F_Est_Maint.[V.Args.ControlName].GetTextMatrix(2,V.Local.iCount,V.local.sLink)
'			Gui.F_Est_Maint.[V.Args.ControlName].GetTextMatrix(3,V.Local.iCount,V.local.sUpdate)
'			Gui.F_Est_Maint.[V.Args.ControlName].GetTextMatrix(4,V.Local.iCount,V.local.sRemove)
'			F.Intrinsic.Math.Sub(V.Local.iCount,1,V.Local.iCount)
'			Gui.F_Est_Maint.[V.Args.ControlName].TextMatrix(0,V.Local.iCount,V.Local.sSeq)
'			Gui.F_Est_Maint.[V.Args.ControlName].TextMatrix(1,V.Local.iCount,V.Local.sDisplay)
'			Gui.F_Est_Maint.[V.Args.ControlName].TextMatrix(2,V.Local.iCount,V.Local.sLink)
'			Gui.F_Est_Maint.[V.Args.ControlName].TextMatrix(3,V.Local.iCount,V.local.sUpdate)
'			Gui.F_Est_Maint.[V.Args.ControlName].TextMatrix(4,V.Local.iCount,V.Local.sRemove)
'			F.Intrinsic.Control.If(V.Local.sSeq,<>,"")
'				Gui.F_Est_Maint.[V.Args.controlName].ApplyStyle(V.Local.iCount,2)
'			F.Intrinsic.Control.EndIf
'		F.Intrinsic.Control.Next(V.Local.iCount)
'
		'subtract a row and apply the correct styles
'		F.Intrinsic.Math.Sub(V.Screen.F_Est_Maint![v.Args.ControlName].Rows,1,V.Local.iRows)
'		Gui.F_Est_Maint.[V.Args.controlName].Rows(V.Local.iRows)
'		F.Intrinsic.Math.Sub(V.Local.iRows,1,V.Local.iRows)
'		Gui.F_Est_Maint.[v.Args.ControlName].RemoveStyle(V.Local.iRows)
'		Gui.F_Est_Maint.[V.Args.controlName].ApplyStyle(V.Local.iRows,3)
'
	'not Remove so it is Clear, Clear out the line
'	F.Intrinsic.Control.Else
'		Gui.F_Est_Maint.[V.Args.ControlName].TextMatrix(1,V.Args.Key,"")
'		Gui.F_Est_Maint.[V.Args.ControlName].TextMatrix(2,V.Args.Key,"")
'	F.Intrinsic.Control.EndIf
'
'F.Intrinsic.Control.EndIf


F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("fgWeb_Cmd_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	Function.Intrinsic.String.Concat("Project: GCG_3623_Custom_Maintenance.g2u",V.Ambient.Newline,V.Ambient.Newline,"Subroutine: ",V.Ambient.CurrentSubroutine,V.Ambient.NewLine,"Error Occurred ",V.Ambient.ErrorNumber," with description ",V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.CallSub(F_est_maint_unload)
Function.Intrinsic.Control.EndIf


Program.Sub.fgWeb_Cmd.End

Program.Sub.f_est_maint_unload.Start
F.Intrinsic.Control.SetErrorHandler("f_est_maint_unload_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String)
V.Local.sFile.Declare(String)

Gui.F_Est_Maint..Visible(False)
f.Intrinsic.Control.If(v.DataTable.Web.Exists,=,True)
	f.Data.DataTable.SaveToDB("Web","Con","GCG_3623_WEB","OP_ID*!*SEQ",7)
f.Intrinsic.Control.EndIf

'f.Data.DataTable.CreateFromSQL("GCGInv","Con","SELECT * FROM GCG_3623_INVENTORY",True)
'f.Intrinsic.String.Build("{0}\{1}GCGPartBrowXML.xml",v.Caller.FilesDir,v.Caller.CompanyCode,v.Local.sFile)
'f.Data.DataTable.SaveToXML("GCGInv",0,False,v.Local.sFile)
'
''f.Intrinsic.String.Build("{0}\PartBrowCount.txt",v.Caller.FilesDir,v.Local.sFile)
''f.ODBC.Connection!Con.OpenLocalRecordsetRO("rstCount","SELECT COUNT(PART) AS PART FROM V_INVENTORY_MSTR WHERE FLAG_INACTIVE <> 'Y'")
''f.Intrinsic.Control.If(v.ODBC.Con!rstCount.EOF,=,False)
''	f.Intrinsic.File.String2File(v.Local.sFile,v.ODBC.Con!rstCount.FieldValLong!PART)
''f.Intrinsic.Control.EndIf
'f.Data.DataTable.CreateFromSQL("Inv","Con","SELECT PART, LOCATION, DESCRIPTION FROM V_INVENTORY_MSTR WHERE FLAG_INACTIVE <> 'Y'",True)
'f.Intrinsic.String.Build("{0}\{1}PartBrowXML.xml",v.Caller.FilesDir,v.Caller.CompanyCode,v.Local.sFile)
'f.Data.DataTable.SaveToXML("Inv",0,False,v.Local.sFile)


f.Intrinsic.String.Build("{0}\GCG_3623_XML_Part_Update.g2u",v.Caller.GasDir,v.Local.sFile)
F.Global.Task.CallAsyncGAS(v.Local.sFile,v.Local.sFile)

F.ODBC.Connection!Con.Close
F.Intrinsic.Control.End

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("f_est_maint_unload_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	Function.Intrinsic.String.Concat("Project: GCG_3623_Custom_Maintenance.g2u",V.Ambient.Newline,V.Ambient.Newline,"Subroutine: ",V.Ambient.CurrentSubroutine,V.Ambient.NewLine,"Error Occurred ",V.Ambient.ErrorNumber," with description ",V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.End

Function.Intrinsic.Control.EndIf


Program.Sub.f_est_maint_unload.End

Program.Sub.CMDMaterial.Start
F.Intrinsic.Control.SetErrorHandler("Browsers_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String)
V.Local.iWidth.Declare(Long)
V.Local.sTitles.Declare(String)
V.Local.sSQL.Declare(String)
V.Local.sRet.Declare(String)
V.Local.sUP.Declare(String)
V.Local.iAmt.Declare(Long)

F.Intrinsic.Control.SelectCase(V.Args.ControlName)
	'Part Browser
	F.Intrinsic.Control.Case("CMDMATBROWSE")
		'This will populate the part browser which will populate all of the fields on the Material tab from both standard and custom inventory tables
		F.Intrinsic.String.Split("Part*!*Loc*!*Sort Code*!*Description","*!*",V.Local.sTitles)
		F.Intrinsic.String.Split("1600*!*800*!*900*!*2800","*!*",V.Local.iWidth)
		F.Intrinsic.UI.Browser("Select Part","Con","SELECT PART, LOCATION, CODE_SORT, DESCRIPTION FROM V_INVENTORY_MSTR ORDER BY PART ASC",V.Local.sTitles,V.Local.iWidth,V.Local.sRet)
		'if something was selected then populate the general fields and query for the rest of the info from the custom table
		F.Intrinsic.Control.CallSub(Clear,"Clear","Material")
		F.Intrinsic.Control.If(V.Local.sRet,<>,"***CANCEL***")
			'set part, loc, description, sort code
			F.Intrinsic.String.Split(V.Local.sRet,"*!*",V.Local.sRet)
			V.Local.sRet.RedimPreserve(0,3)
			F.Intrinsic.Control.CallSub(Load_part,"Part",V.Local.sRet(0).Trim,"Loc",V.Local.sRet(1).Trim,"Desc",V.Local.sRet(3).Trim,"SC",V.Local.sRet(2).Trim)
		F.Intrinsic.Control.EndIf

	F.Intrinsic.Control.Case("CMDTOLBROWSE")
		'This will populate the part browser which will populate all of the fields on the Material tab from both standard and custom inventory tables
		F.Intrinsic.String.Split("Part*!*Loc*!*Sort Code*!*Description","*!*",V.Local.sTitles)
		F.Intrinsic.String.Split("1600*!*800*!*900*!*2800","*!*",V.Local.iWidth)
		F.Intrinsic.UI.Browser("Select Part","Con","SELECT PART, LOCATION, CODE_SORT, DESCRIPTION FROM V_INVENTORY_MSTR WHERE PRODUCT_LINE = 'ZT' ORDER BY PART ASC",V.Local.sTitles,V.Local.iWidth,V.Local.sRet)
		'if something was selected then populate the general fields and query for the rest of the info from the custom table
		F.Intrinsic.Control.CallSub(Clear,"Clear","Material")
		F.Intrinsic.Control.If(V.Local.sRet,<>,"***CANCEL***")
			'set part, loc, description, sort code
			F.Intrinsic.String.Split(V.Local.sRet,"*!*",V.Local.sRet)
			V.Local.sRet.RedimPreserve(0,3)
			F.Intrinsic.Control.CallSub(Load_part,"Part",V.Local.sRet(0).Trim,"Loc",V.Local.sRet(1).Trim,"Desc",V.Local.sRet(3).Trim,"SC",V.Local.sRet(2).Trim)
		F.Intrinsic.Control.EndIf

	'Material Save Button
	F.Intrinsic.Control.Case("CMDMATSAVE")
		F.Intrinsic.Control.CallSub(Save_material)

	'Tooling Save button
	F.Intrinsic.Control.Case("CMDTOLSAVE")
		F.Intrinsic.Control.CallSub(Save_material)

	'clear material
	F.Intrinsic.Control.Case("CMDMATCLEAR")
		'clear the material screen
		F.Intrinsic.Control.CallSub(Clear,"Clear","Material")

	'Clear Tooling tab button
	F.Intrinsic.Control.Case("CMDTOLCLEAR")
		F.Intrinsic.Control.CallSub(Clear,"Clear","Material")
	F.Intrinsic.Control.Case("TXTMATWIDTH")
		Gui.F_Est_Maint.txtTolWidth.Text(V.Screen.F_Est_Maint!txtMatWidth.Text)
	'Add Upcharge row
	F.Intrinsic.Control.Case("CMDMATUPADD")
		'Check to make sure Type is selected
		F.Intrinsic.Control.If(V.Screen.F_Est_Maint!ddlMatUpcharge.Text.Trim,<>,"")
			F.Intrinsic.Control.CallSub(Add_mat_list_item,"Control","Upcharge","Col1",V.Screen.F_Est_Maint!ddlMatUpcharge.Text,"Col2",V.Screen.F_Est_Maint!txtMatUpAmt.Text)
		F.Intrinsic.Control.EndIf
	'Add Price and Quantity row
	F.Intrinsic.Control.Case("CMDMATPRICEADD")
		F.Intrinsic.Control.If(V.Screen.F_Est_Maint!txtMatPrice.Text,<>,0,"AND",V.Screen.F_Est_Maint!txtMatQty.Text,<>,0)
			F.Intrinsic.Control.CallSub(Add_mat_list_item,"Control","Price","Col1",V.Screen.F_Est_Maint!txtMatPrice.Text,"Col2",V.Screen.F_Est_Maint!txtMatQty.Text)
		F.Intrinsic.Control.EndIf
	'Remove Upcharge Row
	F.Intrinsic.Control.Case("CMDMATUPREMOVE")
		F.Intrinsic.Control.CallSub(Remove_mat_list_item,"Control","Upcharge")
	'Remove Price Row
	F.Intrinsic.Control.Case("CMDMATPRICEREMOVE")
		F.Intrinsic.Control.CallSub(Remove_mat_list_item,"Control","Price")
	'Set Price field to 0 if blank
	F.Intrinsic.Control.Case("TXTMATPRICE")
		F.Intrinsic.Control.If(V.Screen.F_Est_Maint!txtMatPrice.Text.Trim,=,"")
			Gui.F_Est_Maint.txtMatPrice.Text(0)
		F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.Case("TXTMATQTY")
		F.Intrinsic.Control.If(V.Screen.F_Est_Maint!txtMatQty.Text.Trim,=,"")
			Gui.F_Est_Maint.txtMatQty.Text(0)
		F.Intrinsic.Control.EndIf
	'Vendor Browser
	F.Intrinsic.Control.Case("CMDMATVENBROWSE")
		'Launch vendor Browser to select from
		F.Intrinsic.UI.Browser(300,"",V.Local.sRet)

		'Check for a selection
		F.Intrinsic.Control.If(V.Local.sRet,<>,"***CANCEL***")
			F.Intrinsic.String.Split(V.Local.sRet,"*!*",V.Local.sRet)
			Gui.F_Est_Maint.txtMatVenNum.Text(V.Local.sRet(0))
			Gui.F_Est_Maint.txtTolVenNum.Text(V.Local.sRet(0))
		F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.Case("CMDTOLVENBROWSE")
		'Launch vendor Browser to select from
		F.Intrinsic.UI.Browser(300,"",V.Local.sRet)

		'Check for a selection
		F.Intrinsic.Control.If(V.Local.sRet,<>,"***CANCEL***")
			F.Intrinsic.String.Split(V.Local.sRet,"*!*",V.Local.sRet)
			Gui.F_Est_Maint.txtMatVenNum.Text(V.Local.sRet(0))
			Gui.F_Est_Maint.txtTolVenNum.Text(V.Local.sRet(0))
		F.Intrinsic.Control.EndIf
	'Lost focus on vendor num
	F.Intrinsic.Control.Case("TXTTOLVENNUM")
		Gui.F_Est_Maint.txtMatVenNum.Text(V.Screen.F_Est_Maint!txtTolVenNum.Text)
	'Lost focus on GSS cost
	F.Intrinsic.Control.Case("TXTTOLACTPRICE")
		Gui.F_Est_Maint.txtMatActPrice.Text(V.Screen.F_Est_Maint!txtTolActPrice.Text)
F.Intrinsic.Control.EndSelect

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("Browsers_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	Function.Intrinsic.String.Concat("Project: GCG_3623_Custom_Maintenance.g2u",V.Ambient.Newline,V.Ambient.Newline,"Subroutine: ",V.Ambient.CurrentSubroutine,V.Ambient.NewLine,"Error Occurred ",V.Ambient.ErrorNumber," with description ",V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.CallSub(F_est_maint_unload)
Function.Intrinsic.Control.EndIf


Program.Sub.CMDMaterial.End

Program.Sub.Clear.Start
F.Intrinsic.Control.SetErrorHandler("Clear_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String)
V.Local.iC.Declare(Long)

'using a passed variable Clear to know which section to clear
F.Intrinsic.Control.SelectCase(V.Args.Clear)
	'Clear Material Section
	F.Intrinsic.Control.Case("Material")
		Gui.F_Est_Maint.txtMatPart.Text("")
		Gui.F_Est_Maint.txtMatLoc.Text("")
		Gui.F_Est_Maint.txtMatDesc.Text("")
		Gui.F_Est_Maint.txtMatSC.Text("")
		Gui.F_Est_Maint.txtTolPart.Text("")
		Gui.F_Est_Maint.txtTolLoc.Text("")
		Gui.F_Est_Maint.txtTolDesc.Text("")
		Gui.F_Est_Maint.txtTolSC.Text("")
		Gui.F_Est_Maint.txtMatAC.Text("")
		Gui.F_Est_Maint.txtMatSTLF.Text("")
		Gui.F_Est_Maint.txtMatSTLC.Text("")
		Gui.F_Est_Maint.txtMatSTHF.Text("")
		Gui.F_Est_Maint.txtMatSTHC.Text("")
		Gui.F_Est_Maint.txtMatMAF.Text("")
		Gui.F_Est_Maint.txtMatMAC.Text("")
		Gui.F_Est_Maint.txtMatLineWeight.Text("")
		Gui.F_Est_Maint.txtMatAdType.Text("")
		Gui.F_Est_Maint.txtMatThick.Text("")
		Gui.F_Est_Maint.txtMatLbs.Text("")
		Gui.F_Est_Maint.txtMatGrade.Text("")
		Gui.F_Est_Maint.txtMatLineScreen.Text("")
		Gui.F_Est_Maint.txtMatDotSize.Text("")
		Gui.F_Est_Maint.txtMatFreightSur.Text("")
		Gui.F_Est_Maint.txtMatPrice.Text(0)
		Gui.F_Est_Maint.txtMatQty.Text(0)
		Gui.F_Est_Maint.txtMatFaceDesc.Text("")
		Gui.F_Est_Maint.txtMatMaterialType.Text("")
		F.Intrinsic.Control.For(V.Local.iC,1,5,1)
			Gui.F_Est_Maint.txtMatPC[V.Local.iC].Text("")
			Gui.F_Est_Maint.txtMatMW[V.Local.iC].Text("")
		F.Intrinsic.Control.Next(V.Local.iC)
		Gui.F_Est_Maint.txtMatMinOrder.Text("")
		Gui.F_Est_Maint.chkMatExact.Value(0)
		Gui.F_Est_Maint.txtMatDateAdd.Text("")
		Gui.F_Est_Maint.txtMatDateChg.Text("")
		Gui.F_Est_Maint.txtMatLead.Text("")
		Gui.F_Est_Maint.txtMatVenName.Text("")
		Gui.F_Est_Maint.txtMatVenNum.Text("")
		Gui.F_Est_Maint.txtMatMSIPrice.Text("")
		Gui.F_Est_Maint.txtMatActPrice.Text("")
		Gui.F_Est_Maint.txtMatWidth.Text("")
		Gui.F_Est_Maint.mltMatComment.Text("")

		Gui.F_Est_Maint.txtTolACRDie.Text("")
		Gui.F_Est_Maint.txtTolACRPress.Text("")
		Gui.F_Est_Maint.txtTolACRFin.Text("")
		Gui.F_Est_Maint.txtTolStepAcross.Text("")
		Gui.F_Est_Maint.txtTolStepAround.Text("")
		Gui.F_Est_Maint.txtTolCavAcross.Text("")
		Gui.F_Est_Maint.txtTolCavAround.Text("")
		Gui.F_Est_Maint.txtTolCorner.Text("")
		Gui.F_Est_Maint.txtTolToothSize.Text("")
		Gui.F_Est_Maint.txtTolShape.Text("")
		Gui.F_Est_Maint.txtTolShapeDesc.Text("")
		Gui.F_Est_Maint.txtTolUsed.Text("")
		Gui.F_Est_Maint.txtTolStatus.Text("")
		Gui.F_Est_Maint.txtTolToolNum.Text("")
		Gui.F_Est_Maint.txtTolInternalLblWidth.Text("")
		Gui.F_Est_Maint.txtTolInternalLblLength.Text("")
		Gui.F_Est_Maint.txtTolInternalLblNum.Text("")
		Gui.F_Est_Maint.txtTolWasteEdge.Text("")
		Gui.F_Est_Maint.chkTolMinWaved.Value(0)
		Gui.F_Est_Maint.txtTolAcross.Text("")
		Gui.F_Est_Maint.txtTolAround.Text("")
		Gui.F_Est_Maint.txtTolGapAcross.Text("")
		Gui.F_Est_Maint.txtTolGapDown.Text("")
		Gui.F_Est_Maint.txtTolLinerThick.Text("")
		Gui.F_Est_Maint.txtTolLength.Text("")
		Gui.F_Est_Maint.txtTolWidth.Text("")
		Gui.F_Est_Maint.txtTolVenNum.Text("")
		Gui.F_Est_Maint.txtTolActPrice.Text("")

		'Clear FOB List
		F.Intrinsic.Control.CallSub(Load_mat_fob)
		'Clear Upcharges
		Gui.F_Est_Maint.lvwMatUpcharge.ClearItems
		'Clear Price and Break Quantities
		Gui.F_Est_Maint.lvwMatPrice.ClearItems
		'Clear Drop Down List
		Gui.F_Est_Maint.ddlMatUpcharge.Text("")
		'Clear Upcharge Amount
		Gui.F_Est_Maint.txtMatUpAmt.Text("")
		
		Gui.F_Est_Maint.lblMSave.Caption("")
		Gui.F_Est_Maint.lblTSave.Caption("")
F.Intrinsic.Control.EndSelect

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("Clear_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	Function.Intrinsic.String.Concat("Project: GCG_3623_Custom_Maintenance.g2u",V.Ambient.Newline,V.Ambient.Newline,"Subroutine: ",V.Ambient.CurrentSubroutine,V.Ambient.NewLine,"Error Occurred ",V.Ambient.ErrorNumber," with description ",V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.CallSub(F_est_maint_unload)
Function.Intrinsic.Control.EndIf


Program.Sub.Clear.End

Program.Sub.CMDLabor.Start
F.Intrinsic.Control.SetErrorHandler("CMDLabor_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String)
V.Local.iWidth.Declare(Long)
V.Local.sTitles.Declare(String)
V.Local.sSQL.Declare(String)
V.Local.sRet.Declare(String)
V.Local.iID.Declare(Long)
V.Local.sID.Declare(String)
V.Local.iC.Declare(Long)
V.Local.iRow.Declare(Long)
V.Local.sAttribute.Declare(String)
V.Local.fValue.Declare(Float)
V.Local.iNum.Declare(Long)

F.Intrinsic.Control.SelectCase(V.Args.ControlName)
F.Intrinsic.Control.Case("CMDLABWC")
	'Open Workcenter browser
	F.Intrinsic.UI.Browser(400,"",V.Local.sRet)
	'If workcenter selected set and load attributes table
	F.Intrinsic.Control.If(V.Local.sRet,<>,"***CANCEL***")
		F.Intrinsic.String.Split(V.Local.sRet,"*!*",V.Local.sRet)
		Gui.F_Est_Maint.txtLabWC.Text(V.Local.sRet(0).Trim)
	F.Intrinsic.Control.EndIf

	F.Intrinsic.Control.CallSub(Loadlabgroups)
	F.Intrinsic.Control.CallSub(Loadlaboratt)
F.Intrinsic.Control.Case("CMDLABWCLOC")
	'Open Location Browser
	F.Intrinsic.String.Split("Location*!*Location Desc","*!*",V.Local.sTitles)
	F.Intrinsic.String.Split("800*!*1200","*!*",V.Local.iWidth)
	F.Intrinsic.UI.Browser("Select A Location","con","SELECT LOCATION, LOCATION_DESC FROM V_LOCATIONS",V.Local.sTitles,V.Local.iWidth,V.Local.sRet)
	'If none selected simply reload atrributes grid, otherwise set location and reload attributes grid
	F.Intrinsic.Control.If(V.Local.sRet,<>,"***CANCEL***")
		F.Intrinsic.String.Split(V.Local.sRet,"*!*",V.Local.sRet)
		Gui.F_Est_Maint.txtLabWCLoc.Text(V.Local.sRet(0).Trim)
	F.Intrinsic.Control.EndIf

	F.Intrinsic.Control.CallSub(Loadlabgroups)
	F.Intrinsic.Control.CallSub(Loadlaboratt)
F.Intrinsic.Control.Case("CMDLABWGBROWSE")
	'Open Work Group Browser
	F.Intrinsic.String.Split("ID*!*Group Description","*!*",V.Local.sTitles)
	F.Intrinsic.String.Split("500*!*2000","*!*",V.Local.iWidth)
	F.Intrinsic.UI.Browser("Select A Group","con","SELECT * FROM GCG_3623_WG_MAINT",V.Local.sTitles,V.Local.iWidth,V.Local.sRet)
	'Load data if it was selected
	F.Intrinsic.Control.If(V.Local.sRet,<>,"***CANCEL***")
		F.Intrinsic.String.Split(V.Local.sRet,"*!*",V.Local.sRet)
		Gui.F_Est_Maint.txtLabWGID.Text(V.Local.sRet(0).Trim)
		Gui.F_Est_Maint.txtLabWGDesc.Text(V.Local.sRet(1).Trim)
	F.Intrinsic.Control.EndIf
F.Intrinsic.Control.Case("CMDLABFGBROWSE")
	'Open Work Group Browser
	F.Intrinsic.String.Split("ID*!*Group Description","*!*",V.Local.sTitles)
	F.Intrinsic.String.Split("500*!*2000","*!*",V.Local.iWidth)
	F.Intrinsic.UI.Browser("Select A Group","con","SELECT * FROM GCG_3623_FG_MAINT",V.Local.sTitles,V.Local.iWidth,V.Local.sRet)

	F.Intrinsic.Control.If(V.Local.sRet,<>,"***CANCEL***")
		F.Intrinsic.String.Split(V.Local.sRet,"*!*",V.Local.sRet)
		Gui.F_Est_Maint.txtLabFGID.Text(V.Local.sRet(0).Trim)
		Gui.F_Est_Maint.txtLabFGDesc.Text(V.Local.sRet(1).Trim)
	F.Intrinsic.Control.EndIf
F.Intrinsic.Control.Case("CMDLABWGSAVE")
	F.Intrinsic.Control.If(V.Screen.F_Est_Maint!txtLabWGDesc.Text,<>,"")
		Gui.F_Est_Maint.lblWGDesc.ForeColor(V.Color.Black)
		F.Intrinsic.String.Build("SELECT * FROM GCG_3623_WG_MAINT WHERE ID = '{0}'",V.Screen.F_Est_Maint!txtLabWGID.Text,V.Local.sSQL)
		F.ODBC.Connection!Con.OpenLocalRecordsetRW("rstWG",V.Local.sSQL)

		'If it doesn't already exist add new, otherwise simply update description
		F.Intrinsic.Control.If(V.ODBC.Con!rstWG.EOF,=,True)
			F.ODBC.Con!rstWG.AddNew
			F.ODBC.Con!rstWG.Set!ID(V.Screen.F_Est_Maint!txtLabWGID.Text)
		F.Intrinsic.Control.EndIf
		F.ODBC.Con!rstWG.Set!DESCRIPTION(V.Screen.F_Est_Maint!txtLabWGDesc.Text)
		F.ODBC.Con!rstWG.Update
		F.ODBC.Con!rstWG.Close

		'Clear Description and add 1 to the top ID value if it's the same as the one updated
		F.Intrinsic.Control.If(V.Global.iWGID.String,=,V.Screen.F_Est_Maint!txtLabWGID.Text)
			F.Intrinsic.Math.Add(V.Global.iWGID,1,V.Global.iWGID)
			Gui.F_Est_Maint.txtLabWGID.Text(V.Global.iWGID.String)
		F.Intrinsic.Control.Else
			Gui.F_Est_Maint.txtLabWGID.Text(V.Global.iWGID.String)
		F.Intrinsic.Control.EndIf

		Gui.F_Est_Maint.txtLabWGDesc.Text("")
		'Reload DDL
		F.Intrinsic.Control.CallSub(Loadlabddl)
	F.Intrinsic.Control.Else
		Gui.F_Est_Maint.lblWGDesc.ForeColor(V.Color.Red)
		Gui.F_Est_Maint.txtLabWGDesc.SetFocus
	F.Intrinsic.Control.EndIf
F.Intrinsic.Control.Case("CMDLABFGSAVE")
	F.Intrinsic.Control.If(V.Screen.F_Est_Maint!txtLabFGDesc.Text,<>,"")
		Gui.F_Est_Maint.lblFGDesc.ForeColor(V.Color.Black)
		F.Intrinsic.String.Build("SELECT * FROM GCG_3623_FG_MAINT WHERE ID = '{0}'",V.Screen.F_Est_Maint!txtLabFGID.Text,V.Local.sSQL)
		F.ODBC.Connection!Con.OpenLocalRecordsetRW("rstFG",V.Local.sSQL)

		'If it doesn't already exist add new, otherwise simply update description
		F.Intrinsic.Control.If(V.ODBC.Con!rstFG.EOF,=,True)
			F.ODBC.Con!rstFG.AddNew
			F.ODBC.Con!rstFG.Set!ID(V.Screen.F_Est_Maint!txtLabFGID.Text)
		F.Intrinsic.Control.EndIf
		F.ODBC.Con!rstFG.Set!DESCRIPTION(V.Screen.F_Est_Maint!txtLabFGDesc.Text)
		F.ODBC.Con!rstFG.Update
		F.ODBC.Con!rstFG.Close

		'Clear Description and add 1 to the top ID value if it's the same as the one updated
		F.Intrinsic.Control.If(V.Global.iFGID.String,=,V.Screen.F_Est_Maint!txtLabFGID.Text)
			F.Intrinsic.Math.Add(V.Global.iFGID,1,V.Global.iFGID)
			Gui.F_Est_Maint.txtLabFGID.Text(V.Global.iFGID.String)
		F.Intrinsic.Control.Else
			Gui.F_Est_Maint.txtLabFGID.Text(V.Global.iFGID.String)
		F.Intrinsic.Control.EndIf

		Gui.F_Est_Maint.txtLabFGDesc.Text("")
		'Reload DDL
		F.Intrinsic.Control.CallSub(Loadlabddl)
	F.Intrinsic.Control.Else
		Gui.F_Est_Maint.lblFGDesc.ForeColor(V.Color.Red)
		Gui.F_Est_Maint.txtLabFGDesc.SetFocus
	F.Intrinsic.Control.EndIf
F.Intrinsic.Control.Case("CMDLABSAVEWC")
	'If workcenter isn't blank save data to table, otherwise change WC label to red and set focus to wc
	F.Intrinsic.Control.If(V.Screen.F_Est_Maint!txtLabWC.Text,<>,"")
'		Gui.F_Est_Maint.gsfgLabAddAtt.Commit
		Gui.F_Est_Maint.lblLabWC.ForeColor(V.Color.Black)
		
		F.Data.DataTable.SaveToDB("LabAtt","Con","GCG_3623_WC_MAINT","WORKCENTER*!*ATT_NUM*!*LOCATION",7,"ATTRIBUTE@!@ATTRIBUTE1*!*ATT_VALUE@!@ATT_VALUE*!*ATT_NUM@!@ATT_NUM*!*WORKCENTER@!@WORKCENTER*!*LOCATION@!@LOCATION1")
		
		
		'Get number of rows
'		V.Local.iRow.Set(V.Screen.F_Est_Maint!gsfgLabAddAtt.Rows)
'		F.Intrinsic.Math.Sub(V.Local.iRow,1,V.Local.iRow)
'
		'Loop through each row and update the table
'		F.Intrinsic.Control.For(V.Local.iC,1,V.Local.iRow,1)
'
			'Get Value
'			Gui.F_Est_Maint.gsfgLabAddAtt.GetTextMatrix(1,V.Local.iC,V.Local.fValue)
'			'Check if it already exists, if so update, otherwise add new
'			Gui.F_Est_Maint.gsfgLabAddAtt.GetTextMatrix(0,V.Local.iC,V.Local.sAttribute)
'			'Get Line Number
'			Gui.F_Est_Maint.gsfgLabAddAtt.GetTextMatrix(2,V.Local.iC,V.Local.iNum)
'			F.Intrinsic.String.Build("SELECT * FROM GCG_3623_WC_MAINT WHERE WORKCENTER = '{0}' AND LOCATION = '{1}' AND ATTRIBUTE = '{2}'",V.Screen.F_Est_Maint!txtLabWC.Text,V.Screen.F_Est_Maint!txtLabWCLoc.Text,V.Local.sAttribute,V.Local.sSQL)
'			F.ODBC.Connection!Con.OpenLocalRecordsetRW("rstWC",V.Local.sSQL)
'
'			F.Intrinsic.Control.If(V.ODBC.Con!rstWC.EOF,=,True)
'				F.ODBC.Con!rstWC.AddNew
'				F.ODBC.Con!rstWC.Set!WORKCENTER(V.Screen.F_Est_Maint!txtLabWC.Text.PSQLFriendly)
'				F.ODBC.Con!rstWC.Set!LOCATION(V.Screen.F_Est_Maint!txtLabWCLoc.Text.PSQLFriendly)
'				F.ODBC.Con!rstWC.Set!ATTRIBUTE(V.Local.sAttribute.PSQLFriendly)
'			F.Intrinsic.Control.EndIf
'
			'Set WG
'			F.Intrinsic.Control.If(V.Screen.F_Est_Maint!ddlLabWG.Text,<>,"")
'				F.Intrinsic.String.Split(V.Screen.F_Est_Maint!ddlLabWG.Text,"-",V.Local.sID)
'				F.ODBC.Con!rstWC.Set!WORK_GROUP(V.Local.sID(0).Long)
''			F.Intrinsic.Control.Else
''				F.ODBC.Con!rstWC.Set!WORK_GROUP(V.Ambient.Null)
'			F.Intrinsic.Control.EndIf
'
			'Set FG
'			F.Intrinsic.Control.If(V.Screen.F_Est_Maint!ddlLabFG.Text,<>,"")
'				F.Intrinsic.String.Split(V.Screen.F_Est_Maint!ddlLabFG.Text,"-",V.Local.sID)
'				F.ODBC.Con!rstWC.Set!FINISH_GROUP(V.Local.sID(0).Long)
''			F.Intrinsic.Control.Else
''				F.ODBC.Con!rstWC.Set!FINISH_GROUP(V.Ambient.Null)
'			F.Intrinsic.Control.EndIf
'
			'Get FlexGrid Information
'			F.ODBC.Con!rstWC.Set!ATT_VALUE(V.Local.fValue)
'			F.ODBC.Con!rstWC.Set!ATT_NUM(V.Local.iNum)
'			F.ODBC.Con!rstWC.Update
'			F.ODBC.Con!rstWC.Close
'		F.Intrinsic.Control.Next(V.Local.iC)

		'If called from WC don't clear screen
		F.Intrinsic.Control.If(V.Caller.Hook,<>,14860)
			'Reset Text Boxes, DDLs, and FlexGrid
			Gui.F_Est_Maint.txtLabWC.Text("")
			Gui.F_Est_Maint.txtLabWCLoc.Text("")
			Gui.F_Est_Maint.ddlLabWG.Text("")
			Gui.F_Est_Maint.ddlLabFG.Text("")
			Gui.F_Est_Maint.lblLabWC.ForeColor(V.Color.Black)
			f.Intrinsic.Control.If(v.DataTable.LabAtt.Exists,=,True)
				f.Data.DataTable.Close("LabAtt")
				Gui.F_Est_Maint.gsfgLabAddAtt.ClearRows("GridLabAtt")
			f.Intrinsic.Control.EndIf
			
'			F.Intrinsic.Control.CallSub(Buildstyle_lab)
		f.Intrinsic.Control.Else
			f.Intrinsic.Control.CallSub(loadLaborAtt)
			f.Intrinsic.Control.CallSub(BuildStyle_Lab)
		F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.Else
		Gui.F_Est_Maint.lblLabWC.ForeColor(V.Color.Red)
		Gui.F_Est_Maint.txtLabWC.SetFocus
	F.Intrinsic.Control.EndIf
F.Intrinsic.Control.Case("CMDLABWGCLEAR")
	'Reset ID and Desc
	Gui.F_Est_Maint.txtLabWGID.Text(V.Global.iWGID.String)
	Gui.F_Est_Maint.txtLabWGDesc.Text("")
	Gui.F_Est_Maint.lblWGDesc.ForeColor(V.Color.Black)
F.Intrinsic.Control.Case("CMDLABFGCLEAR")
	'Reset ID and Desc
	Gui.F_Est_Maint.txtLabFGID.Text(V.Global.iFGID.String)
	Gui.F_Est_Maint.txtLabFGDesc.Text("")
	Gui.F_Est_Maint.lblFGDesc.ForeColor(V.Color.Black)
F.Intrinsic.Control.Case("CMDLABWCCLEAR")
	'Reset Text Boxes, DDLs, and FlexGrid
	Gui.F_Est_Maint.txtLabWC.Text("")
	Gui.F_Est_Maint.txtLabWCLoc.Text("")
	Gui.F_Est_Maint.ddlLabWG.Text("")
	Gui.F_Est_Maint.ddlLabFG.Text("")
	Gui.F_Est_Maint.lblLabWC.ForeColor(V.Color.Black)
	f.Intrinsic.Control.If(v.DataTable.LabAtt.Exists,=,True)
		f.Data.DataTable.Close("LabAtt")
		Gui.F_Est_Maint.gsfgLabAddAtt.ClearRows("GridLabAtt")
	f.Intrinsic.Control.EndIf
	
'	F.Intrinsic.Control.CallSub(Buildstyle_lab)
F.Intrinsic.Control.EndSelect

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("CMDLabor_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	Function.Intrinsic.String.Concat("Project: GCG_3623_Custom_Maintenance.g2u",V.Ambient.Newline,V.Ambient.Newline,"Subroutine: ",V.Ambient.CurrentSubroutine,V.Ambient.NewLine,"Error Occurred ",V.Ambient.ErrorNumber," with description ",V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.CallSub(F_est_maint_unload)
Function.Intrinsic.Control.EndIf

Program.Sub.CMDLabor.End

Program.Sub.LoadLaborAtt.Start
F.Intrinsic.Control.SetErrorHandler("LoadLaborAtt_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String)
V.Local.sSQL.Declare(String)
V.Local.iC.Declare(Long)
V.Local.iRow.Declare(Long)

'If a Workcenter was chosen, Load attributes for that WC Location combination
F.Intrinsic.Control.If(V.Screen.F_Est_Maint!txtLabWC.Text,<>,"")
	F.Intrinsic.String.Build("SELECT RTRIM(ATTRIBUTE1) AS ATTRIBUTE,ATT_VALUE,ATT_NUM,RTRIM(WORKCENTER) AS WORKCENTER,RTRIM(LOCATION1) AS LOCATION FROM GCG_3623_WC_MAINT WHERE WORKCENTER = '{0}' AND LOCATION1 = '{1}' ORDER BY ATT_NUM ASC",V.Screen.F_Est_Maint!txtLabWC.Text.PSQLFriendly,V.Screen.F_Est_Maint!txtLabWCLoc.Text.PSQLFriendly,V.Local.sSQL)
'	F.ODBC.Connection!Con.OpenLocalRecordsetRW("rstLabAtt",V.Local.sSQL)
	f.Intrinsic.Control.If(v.DataTable.LabAtt.Exists,=,True)
		f.Data.DataTable.Close("LabAtt")
	f.Intrinsic.Control.EndIf
	f.Data.DataTable.CreateFromSQL("LabAtt","Con",v.Local.sSQL,True)
	f.Data.DataView.Create("LabAtt","LabAttView",22,"","ATT_NUM Asc")
	Gui.F_Est_Maint.gsfgLabAddAtt.Visible(False)

	'If no records yet for Workcenter location combo, set all values to 0
'	F.Intrinsic.Control.If(V.ODBC.Con!rstLabAtt.EOF,<>,True)
	f.Intrinsic.Control.If(v.DataTable.LabAtt.RowCount,=,0)
'		Gui.F_Est_Maint.gsfgLabAddAtt.LoadRecordset("con!rstLabAtt",2,False)
'		'Update the number of rows so that there isn't an extra row
'		V.Local.iRow.Set(V.Screen.F_Est_Maint!gsfgLabAddAtt.Rows)
'		F.Intrinsic.Math.Sub(V.Local.iRow,1,V.Local.iRow)
'		Gui.F_Est_Maint.gsfgLabAddAtt.Rows(V.Local.iRow)
'	F.Intrinsic.Control.Else
		'Set the number of rows in the grid
'		Gui.F_Est_Maint.gsfgLabAddAtt.Rows(26)
		'If no record exists manually fill the table with the attirbutes and a value of 0.
		f.Data.DataTable.AddRow("LabAtt","ATTRIBUTE","Base","ATT_NUM",1,"WORKCENTER",V.Screen.F_Est_Maint!txtLabWC.Text.Trim,"ATT_VALUE",0.0000,"LOCATION",V.Screen.F_Est_Maint!txtLabWCLoc.Text.Trim)
		f.Data.DataTable.AddRow("LabAtt","ATTRIBUTE","Die","ATT_NUM",2,"WORKCENTER",V.Screen.F_Est_Maint!txtLabWC.Text.Trim,"ATT_VALUE",0.0000,"LOCATION",V.Screen.F_Est_Maint!txtLabWCLoc.Text.Trim)
		f.Data.DataTable.AddRow("LabAtt","ATTRIBUTE","Perf","ATT_NUM",3,"WORKCENTER",V.Screen.F_Est_Maint!txtLabWC.Text.Trim,"ATT_VALUE",0.0000,"LOCATION",V.Screen.F_Est_Maint!txtLabWCLoc.Text.Trim)
		f.Data.DataTable.AddRow("LabAtt","ATTRIBUTE","Color Change","ATT_NUM",4,"WORKCENTER",V.Screen.F_Est_Maint!txtLabWC.Text.Trim,"ATT_VALUE",0.0000,"LOCATION",V.Screen.F_Est_Maint!txtLabWCLoc.Text.Trim)
		f.Data.DataTable.AddRow("LabAtt","ATTRIBUTE","Default Setup","ATT_NUM",5,"WORKCENTER",V.Screen.F_Est_Maint!txtLabWC.Text.Trim,"ATT_VALUE",0.0000,"LOCATION",V.Screen.F_Est_Maint!txtLabWCLoc.Text.Trim)
		f.Data.DataTable.AddRow("LabAtt","ATTRIBUTE","Butt Cut","ATT_NUM",6,"WORKCENTER",V.Screen.F_Est_Maint!txtLabWC.Text.Trim,"ATT_VALUE",0.0000,"LOCATION",V.Screen.F_Est_Maint!txtLabWCLoc.Text.Trim)
		f.Data.DataTable.AddRow("LabAtt","ATTRIBUTE","Perf Spec","ATT_NUM",7,"WORKCENTER",V.Screen.F_Est_Maint!txtLabWC.Text.Trim,"ATT_VALUE",0.0000,"LOCATION",V.Screen.F_Est_Maint!txtLabWCLoc.Text.Trim)
		f.Data.DataTable.AddRow("LabAtt","ATTRIBUTE","FF Press","ATT_NUM",8,"WORKCENTER",V.Screen.F_Est_Maint!txtLabWC.Text.Trim,"ATT_VALUE",0.0000,"LOCATION",V.Screen.F_Est_Maint!txtLabWCLoc.Text.Trim)
		f.Data.DataTable.AddRow("LabAtt","ATTRIBUTE","FF Hand","ATT_NUM",9,"WORKCENTER",V.Screen.F_Est_Maint!txtLabWC.Text.Trim,"ATT_VALUE",0.0000,"LOCATION",V.Screen.F_Est_Maint!txtLabWCLoc.Text.Trim)
		f.Data.DataTable.AddRow("LabAtt","ATTRIBUTE","Pinfed U","ATT_NUM",10,"WORKCENTER",V.Screen.F_Est_Maint!txtLabWC.Text.Trim,"ATT_VALUE",0.0000,"LOCATION",V.Screen.F_Est_Maint!txtLabWCLoc.Text.Trim)
		f.Data.DataTable.AddRow("LabAtt","ATTRIBUTE","Pinfed P","ATT_NUM",11,"WORKCENTER",V.Screen.F_Est_Maint!txtLabWC.Text.Trim,"ATT_VALUE",0.0000,"LOCATION",V.Screen.F_Est_Maint!txtLabWCLoc.Text.Trim)
		f.Data.DataTable.AddRow("LabAtt","ATTRIBUTE","Sheeted","ATT_NUM",12,"WORKCENTER",V.Screen.F_Est_Maint!txtLabWC.Text.Trim,"ATT_VALUE",0.0000,"LOCATION",V.Screen.F_Est_Maint!txtLabWCLoc.Text.Trim)
		f.Data.DataTable.AddRow("LabAtt","ATTRIBUTE","Air Eject","ATT_NUM",13,"WORKCENTER",V.Screen.F_Est_Maint!txtLabWC.Text.Trim,"ATT_VALUE",0.0000,"LOCATION",V.Screen.F_Est_Maint!txtLabWCLoc.Text.Trim)
		f.Data.DataTable.AddRow("LabAtt","ATTRIBUTE","Vacuum","ATT_NUM",14,"WORKCENTER",V.Screen.F_Est_Maint!txtLabWC.Text.Trim,"ATT_VALUE",0.0000,"LOCATION",V.Screen.F_Est_Maint!txtLabWCLoc.Text.Trim)
		f.Data.DataTable.AddRow("LabAtt","ATTRIBUTE","Delam Relam","ATT_NUM",15,"WORKCENTER",V.Screen.F_Est_Maint!txtLabWC.Text.Trim,"ATT_VALUE",0.0000,"LOCATION",V.Screen.F_Est_Maint!txtLabWCLoc.Text.Trim)
		f.Data.DataTable.AddRow("LabAtt","ATTRIBUTE","Backslits","ATT_NUM",16,"WORKCENTER",V.Screen.F_Est_Maint!txtLabWC.Text.Trim,"ATT_VALUE",0.0000,"LOCATION",V.Screen.F_Est_Maint!txtLabWCLoc.Text.Trim)
		f.Data.DataTable.AddRow("LabAtt","ATTRIBUTE","Faceslits","ATT_NUM",17,"WORKCENTER",V.Screen.F_Est_Maint!txtLabWC.Text.Trim,"ATT_VALUE",0.0000,"LOCATION",V.Screen.F_Est_Maint!txtLabWCLoc.Text.Trim)
		f.Data.DataTable.AddRow("LabAtt","ATTRIBUTE","Ink Flo","ATT_NUM",18,"WORKCENTER",V.Screen.F_Est_Maint!txtLabWC.Text.Trim,"ATT_VALUE",0.0000,"LOCATION",V.Screen.F_Est_Maint!txtLabWCLoc.Text.Trim)
		f.Data.DataTable.AddRow("LabAtt","ATTRIBUTE","Ink Solvent","ATT_NUM",19,"WORKCENTER",V.Screen.F_Est_Maint!txtLabWC.Text.Trim,"ATT_VALUE",0.0000,"LOCATION",V.Screen.F_Est_Maint!txtLabWCLoc.Text.Trim)
		f.Data.DataTable.AddRow("LabAtt","ATTRIBUTE","Colors Front","ATT_NUM",20,"WORKCENTER",V.Screen.F_Est_Maint!txtLabWC.Text.Trim,"ATT_VALUE",0.0000,"LOCATION",V.Screen.F_Est_Maint!txtLabWCLoc.Text.Trim)
		f.Data.DataTable.AddRow("LabAtt","ATTRIBUTE","Colors Fix","ATT_NUM",21,"WORKCENTER",V.Screen.F_Est_Maint!txtLabWC.Text.Trim,"ATT_VALUE",0.0000,"LOCATION",V.Screen.F_Est_Maint!txtLabWCLoc.Text.Trim)
		f.Data.DataTable.AddRow("LabAtt","ATTRIBUTE","Colors Var","ATT_NUM",22,"WORKCENTER",V.Screen.F_Est_Maint!txtLabWC.Text.Trim,"ATT_VALUE",0.0000,"LOCATION",V.Screen.F_Est_Maint!txtLabWCLoc.Text.Trim)
		f.Data.DataTable.AddRow("LabAtt","ATTRIBUTE","Process","ATT_NUM",23,"WORKCENTER",V.Screen.F_Est_Maint!txtLabWC.Text.Trim,"ATT_VALUE",0.0000,"LOCATION",V.Screen.F_Est_Maint!txtLabWCLoc.Text.Trim)
		f.Data.DataTable.AddRow("LabAtt","ATTRIBUTE","Plates Copy","ATT_NUM",24,"WORKCENTER",V.Screen.F_Est_Maint!txtLabWC.Text.Trim,"ATT_VALUE",0.0000,"LOCATION",V.Screen.F_Est_Maint!txtLabWCLoc.Text.Trim)
		f.Data.DataTable.AddRow("LabAtt","ATTRIBUTE","Plate Changes","ATT_NUM",25,"WORKCENTER",V.Screen.F_Est_Maint!txtLabWC.Text.Trim,"ATT_VALUE",0.0000,"LOCATION",V.Screen.F_Est_Maint!txtLabWCLoc.Text.Trim)
	
		
'		Gui.F_Est_Maint.gsfgLabAddAtt.TextMatrix(0,1,"Base")
'		Gui.F_Est_Maint.gsfgLabAddAtt.TextMatrix(0,2,"Die")
'		Gui.F_Est_Maint.gsfgLabAddAtt.TextMatrix(0,3,"Perf")
'		Gui.F_Est_Maint.gsfgLabAddAtt.TextMatrix(0,4,"Color Change")
'		Gui.F_Est_Maint.gsfgLabAddAtt.TextMatrix(0,5,"Default Setup")
'		Gui.F_Est_Maint.gsfgLabAddAtt.TextMatrix(0,6,"Butt Cut")
'		Gui.F_Est_Maint.gsfgLabAddAtt.TextMatrix(0,7,"Perf Spec")
'		Gui.F_Est_Maint.gsfgLabAddAtt.TextMatrix(0,8,"FF Press")
'		Gui.F_Est_Maint.gsfgLabAddAtt.TextMatrix(0,9,"FF Hand")
'		Gui.F_Est_Maint.gsfgLabAddAtt.TextMatrix(0,10,"Pinfed U")
'		Gui.F_Est_Maint.gsfgLabAddAtt.TextMatrix(0,11,"Pinfed P")
'		Gui.F_Est_Maint.gsfgLabAddAtt.TextMatrix(0,12,"Sheeted")
'		Gui.F_Est_Maint.gsfgLabAddAtt.TextMatrix(0,13,"Air Eject")
'		Gui.F_Est_Maint.gsfgLabAddAtt.TextMatrix(0,14,"Vacuum")
'		Gui.F_Est_Maint.gsfgLabAddAtt.TextMatrix(0,15,"Delam Relam")
'		Gui.F_Est_Maint.gsfgLabAddAtt.TextMatrix(0,16,"Backslits")
'		Gui.F_Est_Maint.gsfgLabAddAtt.TextMatrix(0,17,"Faceslits")
'		Gui.F_Est_Maint.gsfgLabAddAtt.TextMatrix(0,18,"Ink Flo")
'		Gui.F_Est_Maint.gsfgLabAddAtt.TextMatrix(0,19,"Ink Solvent")
'		Gui.F_Est_Maint.gsfgLabAddAtt.TextMatrix(0,20,"Colors Front")
'		Gui.F_Est_Maint.gsfgLabAddAtt.TextMatrix(0,21,"Colors Fix")
'		Gui.F_Est_Maint.gsfgLabAddAtt.TextMatrix(0,22,"Colors Var")
'		Gui.F_Est_Maint.gsfgLabAddAtt.TextMatrix(0,23,"Process")
'		Gui.F_Est_Maint.gsfgLabAddAtt.TextMatrix(0,24,"Plates Copy")
'		Gui.F_Est_Maint.gsfgLabAddAtt.TextMatrix(0,25,"Plate Changes")

		'Get number of rows
'		V.Local.iRow.Set(V.Screen.F_Est_Maint!gsfgLabAddAtt.Rows)
'		F.Intrinsic.Math.Sub(V.Local.iRow,1,V.Local.iRow)
'
		'Loop through and set the default value
'		F.Intrinsic.Control.For(V.Local.iC,1,V.Local.iRow,1)
'			Gui.F_Est_Maint.gsfgLabAddAtt.TextMatrix(1,V.Local.iC,0.0000)
'			Gui.F_Est_Maint.gsfgLabAddAtt.TextMatrix(2,V.Local.iC,V.Local.iC)
'			Gui.F_Est_Maint.gsfgLabAddAtt.ApplyStyle(V.Local.iC,2)
'		F.Intrinsic.Control.Next(V.Local.iC)
	F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.CallSub(Buildstyle_lab)
	Gui.F_Est_Maint.gsfgLabAddAtt.Visible(True)
'	F.ODBC.Con!rstLabAtt.Close
F.Intrinsic.Control.Else
'	F.Intrinsic.Control.CallSub(Buildstyle_lab)
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("LoadLaborAtt_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	Function.Intrinsic.String.Concat("Project: GCG_3623_Custom_Maintenance.g2u",V.Ambient.Newline,V.Ambient.Newline,"Subroutine: ",V.Ambient.CurrentSubroutine,V.Ambient.NewLine,"Error Occurred ",V.Ambient.ErrorNumber," with description ",V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.CallSub(F_est_maint_unload)
Function.Intrinsic.Control.EndIf

Program.Sub.LoadLaborAtt.End

Program.Sub.BuildStyle_Lab.Start
F.Intrinsic.Control.SetErrorHandler("BuildStyle_Lab_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String)
V.Local.iC.Declare(Long)

Gui.F_Est_Maint.gsfgLabAddAtt.AddGridViewFromDataView("GridLabAtt","LabAtt","LabAttView")
Gui.F_Est_Maint.gsfgLabAddAtt.MainView("GridLabAtt")

Gui.F_Est_Maint.gsfgLabAddAtt.SetColumnProperty("GridLabAtt","Attribute","Caption","Attribute")
Gui.F_Est_Maint.gsfgLabAddAtt.SetColumnProperty("GridLabAtt","ATT_VALUE","Caption","Value")
Gui.F_Est_Maint.gsfgLabAddAtt.SetColumnProperty("GridLabAtt","ATT_NUM","Visible",False)
Gui.F_Est_Maint.gsfgLabAddAtt.SetColumnProperty("GridLabAtt","WORKCENTER","Visible",False)
Gui.F_Est_Maint.gsfgLabAddAtt.SetColumnProperty("GridLabAtt","LOCATION","Visible",False)
Gui.F_Est_Maint.gsfgLabAddAtt.SetColumnProperty("GridLabAtt","ATT_VALUE","ReadOnly",False)
Gui.F_Est_Maint.gsfgLabAddAtt.SetColumnProperty("GridLabAtt","ATT_VALUE","AllowEdit",True)
Gui.F_Est_Maint.gsfgLabAddAtt.SetColumnProperty("GridLabAtt","ATT_VALUE","DisplayFormatType","numeric")
Gui.F_Est_Maint.gsfgLabAddAtt.SetColumnProperty("GridLabAtt","ATT_VALUE","DisplayCustomNumeric","#0.0000")


'Gui.F_Est_Maint.gsfgLabAddAtt.ClearStyle(1)
'Gui.F_Est_Maint.gsfgLabAddAtt.ClearStyle(2)

''Set columns, rows, and fixed rows
'Gui.F_Est_Maint.gsfgLabAddAtt.Cols(3)
'Gui.F_Est_Maint.gsfgLabAddAtt.Rows(1)
'Gui.F_Est_Maint.gsfgLabAddAtt.Rows(2)
'Gui.F_Est_Maint.gsfgLabAddAtt.FixedRows(1)
'
''Set Column header values
'Gui.F_Est_Maint.gsfgLabAddAtt.TextMatrix(0,0,"Attribute")
'Gui.F_Est_Maint.gsfgLabAddAtt.TextMatrix(1,0,"Value")
'
''Since all buildstyles are the same for each column set them up in a for loop
'F.Intrinsic.Control.For(V.Local.iC,0,1,1)
'	Gui.F_Est_Maint.gsfgLabAddAtt.ColWidth(V.Local.iC,1600)
'	'Style 1 - Header
'	Gui.F_Est_Maint.gsfgLabAddAtt.BuildStyle(1,V.Local.iC,"Format","Alignment",4)
'	Gui.F_Est_Maint.gsfgLabAddAtt.BuildStyle(1,V.Local.iC,"Type","Locked",True)
'	Gui.F_Est_Maint.gsfgLabAddAtt.BuildStyle(1,V.Local.iC,"FontStyle","Bold",True)
'F.Intrinsic.Control.Next(V.Local.iC)
'
''Style 2 - Data
''Col 1
'Gui.F_Est_Maint.gsfgLabAddAtt.BuildStyle(2,0,"Format","Alignment",2)
'Gui.F_Est_Maint.gsfgLabAddAtt.BuildStyle(2,0,"Type","Locked",True)
''Col 2
'Gui.F_Est_Maint.gsfgLabAddAtt.BuildStyle(2,1,"Format","Alignment",6)
'Gui.F_Est_Maint.gsfgLabAddAtt.BuildStyle(2,1,"Format","Mask","#0.0000")
'Gui.F_Est_Maint.gsfgLabAddAtt.BuildStyle(2,1,"Format","Numeric",True)
'
''Set column 3 width
'Gui.F_Est_Maint.gsfgLabAddAtt.ColWidth(2,0)
'
'Gui.F_Est_Maint.gsfgLabAddAtt.ApplyStyle(0,1)

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("BuildStyle_Lab_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	Function.Intrinsic.String.Concat("Project: GCG_3623_Custom_Maintenance.g2u",V.Ambient.Newline,V.Ambient.Newline,"Subroutine: ",V.Ambient.CurrentSubroutine,V.Ambient.NewLine,"Error Occurred ",V.Ambient.ErrorNumber," with description ",V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.CallSub(F_est_maint_unload)
Function.Intrinsic.Control.EndIf

Program.Sub.BuildStyle_Lab.End

Program.Sub.Load_Labor.Start
F.Intrinsic.Control.SetErrorHandler("Load_Labor_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String)
V.Local.sSQL.Declare(String)
V.Local.iID.Declare(Long)
V.Local.sID.Declare(String)

'Initialize Group IDs
F.ODBC.Connection!Con.OpenLocalRecordsetRO("rstGrpID","SELECT TOP 1 ID FRom GCG_3623_WG_MAINT ORDER BY ID DESC")

'If record exists set to highest Identity value + 1 else set to 1
F.Intrinsic.Control.If(V.ODBC.Con!rstGrpID.EOF,<>,True)
	F.Intrinsic.Math.Add(1,V.ODBC.Con!rstGrpID.FieldValLong!ID,V.Local.iID)
	Gui.F_Est_Maint.txtLabWGID.Text(V.Local.iID)
F.Intrinsic.Control.Else
	Gui.F_Est_Maint.txtLabWGID.Text("1")
F.Intrinsic.Control.EndIf

'Set Global variable to set ID later
V.Global.iWGID.Set(V.Screen.F_Est_Maint!txtLabWGID.Text)
F.ODBC.Con!rstGrpID.Close

F.ODBC.Connection!Con.OpenLocalRecordsetRO("rstGrpID","SELECT TOP 1 ID FRom GCG_3623_FG_MAINT ORDER BY ID DESC")

'If record exists set to highest Identity value + 1 else set to 1
F.Intrinsic.Control.If(V.ODBC.Con!rstGrpID.EOF,<>,True)
	F.Intrinsic.Math.Add(1,V.ODBC.Con!rstGrpID.FieldValLong!ID,V.Local.iID)
	Gui.F_Est_Maint.txtLabFGID.Text(V.Local.iID)
F.Intrinsic.Control.Else
	Gui.F_Est_Maint.txtLabFGID.Text("1")
F.Intrinsic.Control.EndIf

'Set Global variable to set ID later
V.Global.iFGID.Set(V.Screen.F_Est_Maint!txtLabFGID.Text)
F.ODBC.Con!rstGrpID.Close

'Load DDLs
F.Intrinsic.Control.CallSub(Loadlabddl)
'Load Buildstyle
'F.Intrinsic.Control.CallSub(Buildstyle_lab)

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("Load_Labor_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	Function.Intrinsic.String.Concat("Project: GCG_3623_Custom_Maintenance.g2u",V.Ambient.Newline,V.Ambient.Newline,"Subroutine: ",V.Ambient.CurrentSubroutine,V.Ambient.NewLine,"Error Occurred ",V.Ambient.ErrorNumber," with description ",V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.CallSub(F_est_maint_unload)
Function.Intrinsic.Control.EndIf

Program.Sub.Load_Labor.End

Program.Sub.LoadLabDDL.Start
F.Intrinsic.Control.SetErrorHandler("LoadLabDDL_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String)
V.Local.sID.Declare(String)

Gui.F_Est_Maint.ddlLabFG.ClearItems
Gui.F_Est_Maint.ddlLabWG.ClearItems

'Create Blank item in each DDL so that a selection can be removed
Gui.F_Est_Maint.ddlLabWG.AddItem("")
Gui.F_Est_Maint.ddlLabFG.AddItem("")

'Initialize Drop Down List for WG
F.ODBC.Connection!Con.OpenLocalRecordsetRO("rstDDL","SELECT * FROM GCG_3623_WG_MAINT ORDER BY ID ASC")

'For each record found load DDL
F.Intrinsic.Control.DoUntil(V.ODBC.Con!rstDDL.EOF,=,True)
	F.Intrinsic.String.Build("{0}-{1}",V.ODBC.Con!rstDDL.FieldValTrim!ID,V.ODBC.Con!rstDDL.FieldValTrim!DESCRIPTION,V.Local.sID)
	Gui.F_Est_Maint.ddlLabWG.AddItem(V.Local.sID)
	F.ODBC.Con!rstDDL.MoveNext
F.Intrinsic.Control.Loop

F.ODBC.Con!rstDDL.Close

'Initialize Drop Down List for FG
F.ODBC.Connection!Con.OpenLocalRecordsetRO("rstDDL","SELECT * FROM GCG_3623_FG_MAINT ORDER BY ID ASC")

'For each record found load DDL
F.Intrinsic.Control.DoUntil(V.ODBC.Con!rstDDL.EOF,=,True)
	F.Intrinsic.String.Build("{0}-{1}",V.ODBC.Con!rstDDL.FieldValTrim!ID,V.ODBC.Con!rstDDL.FieldValTrim!DESCRIPTION,V.Local.sID)
	Gui.F_Est_Maint.ddlLabFG.AddItem(V.Local.sID)
	F.ODBC.Con!rstDDL.MoveNext
F.Intrinsic.Control.Loop

F.ODBC.Con!rstDDL.Close

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("LoadLabDDL_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	Function.Intrinsic.String.Concat("Project: GCG_3623_Custom_Maintenance.g2u",V.Ambient.Newline,V.Ambient.Newline,"Subroutine: ",V.Ambient.CurrentSubroutine,V.Ambient.NewLine,"Error Occurred ",V.Ambient.ErrorNumber," with description ",V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.CallSub(F_est_maint_unload)
Function.Intrinsic.Control.EndIf

Program.Sub.LoadLabDDL.End

Program.Sub.LoadLabGroups.Start
F.Intrinsic.Control.SetErrorHandler("LoadLabGroups_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String)
V.Local.sSQL.Declare(String)
V.Local.sGroup.Declare(String)

F.Intrinsic.String.Build("SELECT WC.WORK_GROUP,WC.FINISH_GROUP,WG.DESCRIPTION AS WGDESC,FG.DESCRIPTION AS FGDESC FROM GCG_3623_WC_MAINT WC LEFT JOIN GCG_3623_WG_MAINT WG ON WC.WORK_GROUP = WG.ID LEFT JOIN GCG_3623_FG_MAINT FG ON WC.FINISH_GROUP = FG.ID WHERE WC.WORKCENTER = '{0}' AND WC.LOCATION1 = '{1}'",V.Screen.F_Est_Maint!txtLabWC.Text,V.Screen.F_Est_Maint!txtLabWCLoc.Text,V.Local.sSQL)
F.ODBC.Connection!Con.OpenLocalRecordsetRO("rstGroup",V.Local.sSQL)
'If there are values then set the DDLs
F.Intrinsic.Control.If(V.ODBC.Con!rstGroup.EOF,<>,True)
	'If there's a value for Work Group set DDL
	F.Intrinsic.Control.If(V.ODBC.Con!rstGroup.FieldValTrim!WORK_GROUP,<>,"")
		F.Intrinsic.String.Build("{0}-{1}",V.ODBC.Con!rstGroup.FieldValTrim!WORK_GROUP,V.ODBC.Con!rstGroup.FieldValTrim!WGDESC,V.Local.sGroup)
		Gui.F_Est_Maint.ddlLabWG.Text(V.Local.sGroup)
	F.Intrinsic.Control.EndIf
	'If there's a value for Finish Group set DDL
	F.Intrinsic.Control.If(V.ODBC.Con!rstGroup.FieldValTrim!FINISH_GROUP,<>,"")
		F.Intrinsic.String.Build("{0}-{1}",V.ODBC.Con!rstGroup.FieldValTrim!FINISH_GROUP,V.ODBC.Con!rstGroup.FieldValTrim!FGDESC,V.Local.sGroup)
		Gui.F_Est_Maint.ddlLabFG.Text(V.Local.sGroup)
	F.Intrinsic.Control.EndIf
F.Intrinsic.Control.Else
	'If no values found set DDLs to empty
	Gui.F_Est_Maint.ddlLabFG.Text("")
	Gui.F_Est_Maint.ddlLabWG.Text("")
F.Intrinsic.Control.EndIf

F.ODBC.Con!rstGroup.Close

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("LoadLabGroups_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	Function.Intrinsic.String.Concat("Project: GCG_3623_Custom_Maintenance.g2u",V.Ambient.Newline,V.Ambient.Newline,"Subroutine: ",V.Ambient.CurrentSubroutine,V.Ambient.NewLine,"Error Occurred ",V.Ambient.ErrorNumber," with description ",V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.CallSub(F_est_maint_unload)
Function.Intrinsic.Control.EndIf

Program.Sub.LoadLabGroups.End

Program.Sub.BuildStyle_Groups.Start
F.Intrinsic.Control.SetErrorHandler("BuildStyle_Groups_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String)
V.Local.iC.Declare(Long)

Gui.F_Est_Maint.gsfgEstGroup.ClearStyle(1)
Gui.F_Est_Maint.gsfgEstGroup.ClearStyle(2)

'Set Columns
Gui.F_Est_Maint.gsfgEstGroup.Cols(8)
'Set Rows
Gui.F_Est_Maint.gsfgEstGroup.Rows(1)
Gui.F_Est_Maint.gsfgEstGroup.Rows(2)
Gui.F_Est_Maint.gsfgEstGroup.FixedRows(1)

'Set Column Headers
Gui.F_Est_Maint.gsfgEstGroup.TextMatrix(0,0,"Group")
Gui.F_Est_Maint.gsfgEstGroup.TextMatrix(1,0,"Cust Mast")
Gui.F_Est_Maint.gsfgEstGroup.TextMatrix(2,0,"CRM")
Gui.F_Est_Maint.gsfgEstGroup.TextMatrix(3,0,"Inv Mast")
Gui.F_Est_Maint.gsfgEstGroup.TextMatrix(4,0,"Ven Mast")
Gui.F_Est_Maint.gsfgEstGroup.TextMatrix(5,0,"S&D")
Gui.F_Est_Maint.gsfgEstGroup.TextMatrix(6,0,"Website")
Gui.F_Est_Maint.gsfgEstGroup.TextMatrix(7,0,"Admin")

'Set up Group since it's different from the rest
Gui.F_Est_Maint.gsfgEstGroup.ColWidth(0,900)
'Style 1
Gui.F_Est_Maint.gsfgEstGroup.BuildStyle(1,0,"Format","Alignment",4)
Gui.F_Est_Maint.gsfgEstGroup.BuildStyle(1,0,"Type","Locked",True)
Gui.F_Est_Maint.gsfgEstGroup.BuildStyle(1,0,"Fontstyle","Bold",True)
'Style 2
Gui.F_Est_Maint.gsfgEstGroup.BuildStyle(2,0,"Format","Alignment",2)
Gui.F_Est_Maint.gsfgEstGroup.BuildStyle(2,0,"Type","Locked",True)

'Set up the checkboxes
F.Intrinsic.Control.For(V.Local.iC,1,7,1)
	Gui.F_Est_Maint.gsfgEstGroup.ColWidth(V.Local.iC,1000)
	Gui.F_Est_Maint.gsfgEstGroup.BuildStyle(1,V.Local.iC,"Format","Alignment",4)
	Gui.F_Est_Maint.gsfgEstGroup.BuildStyle(1,V.Local.iC,"Type","Locked",True)
	Gui.F_Est_Maint.gsfgEstGroup.BuildStyle(1,V.Local.iC,"Fontstyle","Bold",True)

	Gui.F_Est_Maint.gsfgEstGroup.BuildStyle(2,V.Local.iC,"Type","Checkbox","")
F.Intrinsic.Control.Next(V.Local.iC)

Gui.F_Est_Maint.gsfgEstGroup.ApplyStyle(0,1)

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("BuildStyle_Groups_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	Function.Intrinsic.String.Concat("Project: GCG_3623_Custom_Maintenance.g2u",V.Ambient.Newline,V.Ambient.Newline,"Subroutine: ",V.Ambient.CurrentSubroutine,V.Ambient.NewLine,"Error Occurred ",V.Ambient.ErrorNumber," with description ",V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.CallSub(F_est_maint_unload)
Function.Intrinsic.Control.EndIf

Program.Sub.BuildStyle_Groups.End

Program.Sub.Load_Estimator.Start
F.Intrinsic.Control.SetErrorHandler("Load_Estimator_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String)
V.Local.iBound.Declare(Long)

'Initialize Group FG
F.Intrinsic.Control.CallSub(Buildstyle_groups)
'Load Group Grid
F.Intrinsic.Control.CallSub(Load_groups)
'Subtract one from the flexgrid rows
F.Intrinsic.Math.Sub(V.uGlobal.uGroups.UBound,1,V.Local.iBound)
F.Intrinsic.Control.if(V.uGlobal.uGroups.UBound,<=,0)
	V.Local.iBound.Set(0)
F.Intrinsic.Control.EndIf
V.uGlobal.uGroups.RedimPreserve(0,V.Local.iBound)
Gui.F_Est_Maint.gsfgEstGroup.LoadFromUDT("uGlobal.uGroups","Group*!*Cust_Mast*!*CRM*!*Inv_Mast*!*Ven_Mast*!*Supp_Dem*!*Website*!*Admin",2)

'Load Run Qty Grid
F.Intrinsic.Control.CallSub(Buildstyle_qty)

'Load Machine Speed
F.Intrinsic.Control.CallSub(Load_spd)
F.Intrinsic.Control.CallSub(Buildstyle_spd)

'Load Locks Grid
F.Intrinsic.Control.CallSub(Load_locks)

'Load FOB and Upcharge
F.Intrinsic.Control.CallSub(Load_fobup,"Type","FOB")
F.Intrinsic.Control.CallSub(Load_fobup,"Type","UP")
F.Intrinsic.Control.CallSub(Buildstyle_types,"Type","gsfgEstFob")
'F.Intrinsic.Control.CallSub(Buildstyle_types,"Type","gsfgEstUp")

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("Load_Estimator_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	Function.Intrinsic.String.Concat("Project: GCG_3623_Custom_Maintenance.g2u",V.Ambient.Newline,V.Ambient.Newline,"Subroutine: ",V.Ambient.CurrentSubroutine,V.Ambient.NewLine,"Error Occurred ",V.Ambient.ErrorNumber," with description ",V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.CallSub(F_est_maint_unload)
Function.Intrinsic.Control.EndIf

Program.Sub.Load_Estimator.End

Program.Sub.Load_Groups.Start
F.Intrinsic.Control.SetErrorHandler("Load_Groups_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String)
V.Local.sRet.Declare(String)
V.Local.iC.Declare(Long)
V.Local.sSQL.Declare(String)

'Reset Group UDT
V.uGlobal.uGroups.Redim(-1,-1)

'Get all user groups to query table
F.Global.Security.GetAllUserGroups(V.Caller.CompanyCode,V.Local.sRet)
F.Intrinsic.String.Split(V.Local.sRet,"*!*",V.Local.sRet)

'Loop through the groups and load data to table if it exists for that group.
F.Intrinsic.Control.For(V.Local.iC,0,V.Local.sRet.UBound,1)
	F.Intrinsic.String.Build("SELECT * FROM GCG_3623_GRP_MAINT WHERE GRP = '{0}'",V.Local.sRet(V.Local.iC),V.Local.sSQL)
	F.ODBC.Connection!Con.OpenLocalRecordsetRO("rstGroup",V.Local.sSQL)

	F.Intrinsic.Control.If(V.ODBC.Con!rstGroup.EOF,<>,True)
		'If UDT is empty simply add infor, otherwise append
		F.Intrinsic.Control.If(V.uGlobal.uGroups.UBound,=,-1)
			F.Intrinsic.Variable.LoadUDTFromRecordset("con","rstGroup","uGlobal.uGroups",False)
		F.Intrinsic.Control.Else
			F.Intrinsic.Variable.LoadUDTFromRecordset("con","rstGroup","uGlobal.uGroups",True)
		F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.Else
		'If UDT is empty update uBound to 0
		F.Intrinsic.Control.If(V.uGlobal.uGroups.UBound,=,-1)
			V.uGlobal.uGroups.Redim(0,V.Local.iC)
		F.Intrinsic.Control.Else
			V.uGlobal.uGroups.RedimPreserve(0,V.Local.iC)
		F.Intrinsic.Control.EndIf
		'Update information
		V.uGlobal.uGroups(V.Local.iC)!Group.Set(V.Local.sRet(V.Local.iC))
		V.uGlobal.uGroups(V.Local.iC)!Cust_Mast.Set(0)
		V.uGlobal.uGroups(V.Local.iC)!CRM.Set(0)
		V.uGlobal.uGroups(V.Local.iC)!Inv_Mast.Set(0)
		V.uGlobal.uGroups(V.Local.iC)!Ven_Mast.Set(0)
		V.uGlobal.uGroups(V.Local.iC)!Supp_Dem.Set(0)
		V.uGlobal.uGroups(V.Local.iC)!Website.Set(0)
		V.uGlobal.uGroups(V.Local.iC)!Admin.Set(0)
	F.Intrinsic.Control.EndIf

	F.ODBC.Con!rstGroup.Close
F.Intrinsic.Control.Next(V.Local.iC)

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("Load_Groups_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	Function.Intrinsic.String.Concat("Project: GCG_3623_Custom_Maintenance.g2u",V.Ambient.Newline,V.Ambient.Newline,"Subroutine: ",V.Ambient.CurrentSubroutine,V.Ambient.NewLine,"Error Occurred ",V.Ambient.ErrorNumber," with description ",V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.CallSub(F_est_maint_unload)
Function.Intrinsic.Control.EndIf

Program.Sub.Load_Groups.End

Program.Sub.CMDEstimator.Start
F.Intrinsic.Control.SetErrorHandler("CMDEstimator_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String)
V.Local.iC.Declare(Long)
V.Local.sRet.Declare(String)
V.Local.sTemp.Declare(String)
V.Local.sLoad.Declare(String)
V.Local.iBound.Declare(Long)
V.Local.sRange.Declare(String)
V.Local.iRows.Declare(Long)
V.Local.sEstimate.Declare(String)
V.Local.sSQL.Declare(String)

F.Intrinsic.Control.SelectCase(V.Args.ControlName)

F.Intrinsic.Control.Case("CMDESTSAVEGROUPS")
	'Load data into string
	F.Intrinsic.Control.CallSub(Save_estgrid,"Grid","gsfgEstGroup")

	'Load data into UDT
	F.Intrinsic.Variable.LoadUDTFromString(V.uGlobal.uGroupsSave,"Group*!*Cust_Mast*!*CRM*!*Inv_Mast*!*Ven_Mast*!*Supp_Dem*!*Website*!*Admin",V.Args.sLoad,V.Ambient.NewLine,"*!*",False)
	'Clear out table, then save UDT to recordset
	F.ODBC.Connection!Con.Execute("DELETE FROM GCG_3623_GRP_MAINT")
	F.ODBC.Connection!Con.OpenLocalRecordsetRW("rstGroup","SELECT * FROM GCG_3623_GRP_MAINT")
	F.Intrinsic.Variable.SaveUDTToRecordSet("con","rstGroup","uGlobal.uGroupsSave")
	F.ODBC.Con!rstGroup.Close
F.Intrinsic.Control.Case("CMDESTSAVEQTY")
	Gui.F_Est_Maint.gsfgEstRun.Commit
	'Load Run Qtys To Table
	F.ODBC.Connection!Con.OpenLocalRecordsetRW("rstRun","SELECT * FROM GCG_3623_RUN_MAINT")

	F.Intrinsic.Control.If(V.ODBC.Con!rstRun.EOF,=,True)
		F.ODBC.Con!rstRun.AddNew
	F.Intrinsic.Control.EndIf

	F.Intrinsic.Control.For(V.Local.iC,1,10,1)
		Gui.F_Est_Maint.gsfgEstRun.GetTextMatrix(0,V.Local.iC,V.Local.sRet)
		F.ODBC.Con!rstRun.Set!Qty_[V.Local.iC](V.Local.sRet.Float)
	F.Intrinsic.Control.Next(V.Local.iC)

	F.ODBC.Con!rstRun.Update
	F.ODBC.Con!rstRun.Close
F.Intrinsic.Control.Case("CMDESTADDSPD")
	'Add additional row to grid
'	F.Intrinsic.Control.CallSub(Add_estgrid,"Grid","gsfgEstSpd")
	F.Intrinsic.Math.Add(V.Global.iID,1,V.Global.iID)
	f.Data.DataTable.AddRow("Speed","IDS",v.Global.iID)
F.Intrinsic.Control.Case("CMDESTDELETESPD")
'	Gui.F_Est_Maint.gsfgEstSpd.Commit
	'Delete selected row form table
'	F.Intrinsic.Control.If(V.Screen.F_Est_Maint!gsfgEstSpd.Rows,=,2)
'		F.Intrinsic.Control.CallSub(Buildstyle_spd)
'		Gui.F_Est_Maint.gsfgEstSpd.TextMatrix(1,1,0)
'		Gui.F_Est_Maint.gsfgEstSpd.TextMatrix(2,1,0)
'	F.Intrinsic.Control.Else
'		Gui.F_Est_Maint.gsfgEstSpd.DeleteRow(V.Screen.F_Est_Maint!gsfgEstSpd.Row)
'	F.Intrinsic.Control.EndIf
	Gui.F_Est_Maint.gsfgEstSpd.GetSelectedRows("GridSpeed",v.Local.sTemp)
	f.Intrinsic.Control.If(v.Local.sTemp,<>,"")
		f.Data.DataTable.DeleteRow("Speed",v.Local.sTemp)
	f.Intrinsic.Control.EndIf
F.Intrinsic.Control.Case("CMDESTSAVESPD")
	'Load  data into string
'	F.Intrinsic.Control.CallSub(Save_estgrid,"Grid","gsfgEstSpd")
	f.Data.DataTable.SaveToDB("Speed","Con","GCG_3623_SPD_MAINT","IDS",7)
	
	f.Data.DataTable.Close("Speed")
	f.Intrinsic.Control.CallSub(Load_Spd)
	f.Intrinsic.Control.CallSub(BuildStyle_Spd)
	
'
	'Load data into UDT
'	F.Intrinsic.Variable.LoadUDTFromString(V.uGlobal.uSpd,"FT_PER_ROLL*!*BLANK_SPD*!*PRINT_SPD*!*IDS",V.Args.sLoad,V.Ambient.NewLine,"*!*",False)
'	'Clear out table, then save UDT to recordset
'	F.ODBC.Connection!Con.Execute("DELETE FROM GCG_3623_SPD_MAINT")
'
'	F.Intrinsic.Control.If(V.uGlobal.uSpd.UBound,<>,-1)
'		F.ODBC.Connection!Con.OpenLocalRecordsetRW("rstGroup","SELECT * FROM GCG_3623_SPD_MAINT")
'		F.Intrinsic.Variable.SaveUDTToRecordSet("con","rstGroup","uGlobal.uSpd")
'		F.ODBC.Con!rstGroup.Close
'	F.Intrinsic.Control.EndIf
F.Intrinsic.Control.Case("CMDESTSAVEFOB")
	'Load data into string
'	F.Intrinsic.Control.CallSub(Save_estgrid,"Grid","gsfgEstFOB")
'
	f.Data.DataTable.SaveToDB("FOB","Con","GCG_3623_FOB_MASTER","FOB_NUM",7,"ACTIVE@!@ACTIVE*!*TYPE@!@TYPE1*!*DESCRIPTION@!@DESCRIPTION*!*FOB_NUM@!@FOB_NUM")
	f.Data.DataTable.SaveToDB("UP","Con","GCG_3623_UP_MASTER","UP_NUM",7,"ACTIVE@!@ACTIVE*!*TYPE@!@TYPE1*!*DESCRIPTION@!@DESCRIPTION*!*UP_NUM@!@UP_NUM")
	
	f.Data.DataTable.Close("FOB")
	f.Data.DataTable.Close("UP")
	F.Intrinsic.Control.CallSub(Load_fobup,"Type","FOB")
	F.Intrinsic.Control.CallSub(Load_fobup,"Type","UP")
	f.Intrinsic.Control.CallSub(BuildStyle_Types)
	'Load data into UDT
'	F.Intrinsic.Variable.LoadUDTFromString(V.uGlobal.uFOB,"ACTIVE*!*Type*!*Description*!*Num",V.Args.sLoad,V.Ambient.NewLine,"*!*",False)
'
'	F.Intrinsic.Control.For(V.Local.iC,0,V.uGlobal.uFOB.UBound,1)
'		F.Intrinsic.String.Build("SELECT * FROM GCG_3623_FOB_MASTER WHERE FOB_NUM = '{0}'",V.uGlobal.uFOB(V.Local.iC)!Num,V.Local.sSQL)
'		F.ODBC.Connection!Con.OpenLocalRecordsetRW("rstFOB",V.Local.sSQL)
'		'If no record exists add a new one, otherwise update the data and close the recordset for the next item.
'		F.Intrinsic.Control.If(V.ODBC.con!rstFOB.EOF,=,True)
'			F.ODBC.Con!rstFOB.AddNew
'		F.Intrinsic.Control.EndIf
'
'		F.ODBC.Con!rstFOB.Set!ACTIVE(V.uGlobal.uFOB(V.Local.iC)!ACTIVE.PSQLFriendly)
'		F.ODBC.Con!rstFOB.Set!TYPE(V.uGlobal.uFOB(V.Local.iC)!Type.PSQLFriendly)
'		F.ODBC.Con!rstFOB.Set!DESCRIPTION(V.uGlobal.uFOB(V.Local.iC)!Description.PSQLFriendly)
'		F.ODBC.Con!rstFOB.Update
'		F.ODBC.Con!rstFOB.Close
'	F.Intrinsic.Control.Next(V.Local.iC)
'	'Update Flexgrid so the new rows identities are in the grid
'	F.Intrinsic.Control.CallSub(Load_fobup,"Type","FOB")
	'Update FOB ListView
	F.Intrinsic.Control.CallSub(Load_mat_fob)
F.Intrinsic.Control.Case("CMDESTSAVEUP")
	'Load data into string
'	F.Intrinsic.Control.CallSub(Save_estgrid,"Grid","gsfgEstUp")
'
	f.Data.DataTable.SaveToDB("FOB","Con","GCG_3623_FOB_MASTER","FOB_NUM",7,"ACTIVE@!@ACTIVE*!*TYPE@!@TYPE1*!*DESCRIPTION@!@DESCRIPTION*!*FOB_NUM@!@FOB_NUM")
	f.Data.DataTable.SaveToDB("UP","Con","GCG_3623_UP_MASTER","UP_NUM",7,"ACTIVE@!@ACTIVE*!*TYPE@!@TYPE1*!*DESCRIPTION@!@DESCRIPTION*!*UP_NUM@!@UP_NUM")
	
	f.Data.DataTable.Close("FOB")
	f.Data.DataTable.Close("UP")
	F.Intrinsic.Control.CallSub(Load_fobup,"Type","FOB")
	F.Intrinsic.Control.CallSub(Load_fobup,"Type","UP")
	f.Intrinsic.Control.CallSub(BuildStyle_Types)
	'Load data into UDT
'	F.Intrinsic.Variable.LoadUDTFromString(V.uGlobal.uUP,"ACTIVE*!*Type*!*Description*!*Num",V.Args.sLoad,V.Ambient.NewLine,"*!*",False)
'
	'Save data to table
'	F.Intrinsic.Control.For(V.Local.iC,0,V.uGlobal.uUP.UBound,1)
'		F.Intrinsic.String.Build("SELECT * FROM GCG_3623_UP_MASTER WHERE UP_NUM = '{0}'",V.uGlobal.uUP(V.Local.iC)!Num,V.Local.sSQL)
'		F.ODBC.Connection!Con.OpenLocalRecordsetRW("rstUP",V.Local.sSQL)
'		'If no record exists add a new one, otherwise update the data and close the recordset for the next item.
'		F.Intrinsic.Control.If(V.ODBC.con!rstUP.EOF,=,True)
'			F.ODBC.Con!rstUP.AddNew
'		F.Intrinsic.Control.EndIf
'
'		F.ODBC.Con!rstUP.Set!ACTIVE(V.uGlobal.uUP(V.Local.iC)!ACTIVE.PSQLFriendly)
'		F.ODBC.Con!rstUP.Set!TYPE(V.uGlobal.uUP(V.Local.iC)!Type.PSQLFriendly)
'		F.ODBC.Con!rstUP.Set!DESCRIPTION(V.uGlobal.uUP(V.Local.iC)!Description.PSQLFriendly)
'		F.ODBC.Con!rstUP.Update
'		F.ODBC.Con!rstUP.Close
'	F.Intrinsic.Control.Next(V.Local.iC)
'	'Update Flexgrid so the new rows identities are in the grid
'	F.Intrinsic.Control.CallSub(Load_fobup,"Type","UP")
	'Update the Drop down list in material tab
	F.Intrinsic.Control.CallSub(Load_mat_up)
F.Intrinsic.Control.Case("CMDESTADDFOB")
	'Add additional row to FOB grid
'	F.Intrinsic.Control.CallSub(Add_estgrid,"Grid","gsfgEstFOB")
	f.Data.DataTable.AddRow("FOB","ACTIVE",False)
F.Intrinsic.Control.Case("CMDESTADDUP")
	'Add additional row to Upcharge Grid
'	F.Intrinsic.Control.CallSub(Add_estgrid,"Grid","gsfgEstUp")
	f.Data.DataTable.AddRow("UP","ACTIVE",False)
F.Intrinsic.Control.Case("CMDESTINSTANCE")
	'Allow for multiple instances of Estimator, one time set up
	F.ODBC.Connection!Con.Execute("UPDATE MENU_SELECTIONS SET ALLOW_MULTI = 1 WHERE GS_ORIGIN = '10' AND TITLE = 'DICE Label Estimator'")
	F.ODBC.Connection!Con.Execute("UPDATE MENU_SELECTIONS SET ALLOW_MULTI = 1 WHERE GS_ORIGIN = '10' AND TITLE = 'DICE Label Maintenance'")
F.Intrinsic.Control.Case("CMDESTDELETELOCK")
	'Hide grid
	Gui.F_Est_Maint.gsfgEstLocks.Visible(False)

	'Get Estimate Number
	Gui.F_Est_Maint.gsfgEstLocks.GetTextMatrix(0,V.Screen.F_Est_Maint!gsfgEstLocks.Row,V.Local.sEstimate)
	'Build delete string
	F.Intrinsic.String.Build("DELETE FROM GCG_3623_EST_LOCK WHERE EST_NO = '{0}'",V.Local.sEstimate,V.Local.sSQL)
	F.ODBC.Connection!Con.Execute(V.Local.sSQL)
	'Delete selected Lock from grid
	Gui.F_Est_Maint.gsfgEstLocks.DeleteRow(V.Screen.F_Est_Maint!gsfgEstLocks.Row)
	'Reload the grid
	F.Intrinsic.Control.CallSub(Load_locks)

	'Show grid
	Gui.F_Est_Maint.gsfgEstLocks.Visible(True)
F.Intrinsic.Control.Case("CMDESTREFRESHLOCKS")
	'Hide Grid
	Gui.F_Est_Maint.gsfgEstLocks.Visible(False)

	'Load Locks
	F.Intrinsic.Control.CallSub(Load_locks)

	'Show grid
	Gui.F_Est_Maint.gsfgEstLocks.Visible(True)
F.Intrinsic.Control.EndSelect

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("CMDEstimator_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	Function.Intrinsic.String.Concat("Project: GCG_3623_Custom_Maintenance.g2u",V.Ambient.Newline,V.Ambient.Newline,"Subroutine: ",V.Ambient.CurrentSubroutine,V.Ambient.NewLine,"Error Occurred ",V.Ambient.ErrorNumber," with description ",V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.CallSub(F_est_maint_unload)
Function.Intrinsic.Control.EndIf

Program.Sub.CMDEstimator.End

Program.Sub.BuildStyle_Qty.Start
F.Intrinsic.Control.SetErrorHandler("BuildStyle_Qty_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String)
V.Local.iC.Declare(Long)

'Set Columns
Gui.F_Est_Maint.gsfgEstRun.Cols(1)
'Set Rows
Gui.F_Est_Maint.gsfgEstRun.Rows(1)
Gui.F_Est_Maint.gsfgEstRun.Rows(11)
Gui.F_Est_Maint.gsfgEstRun.FixedRows(1)
'Set up the run qty column
Gui.F_Est_Maint.gsfgEstRun.TextMatrix(0,0,"Run Qty")
Gui.F_Est_Maint.gsfgEstRun.ColWidth(0,1000)
'Style 1
Gui.F_Est_Maint.gsfgEstRun.BuildStyle(1,0,"Type","Locked",True)
Gui.F_Est_Maint.gsfgEstRun.BuildStyle(1,0,"FontStyle","Bold",True)
Gui.F_Est_Maint.gsfgEstRun.BuildStyle(1,0,"Format","Alignment",4)
'Style 2
Gui.F_Est_Maint.gsfgEstRun.BuildStyle(2,0,"Format","Numeric",True)
Gui.F_Est_Maint.gsfgEstRun.BuildStyle(2,0,"Format","Alignment",6)

'Apply Styles
Gui.F_Est_Maint.gsfgEstRun.ApplyStyle(0,1)

'Check for default values
F.ODBC.Connection!Con.OpenLocalRecordsetRO("rstRun","SELECT * FROM GCG_3623_RUN_MAINT")
'If default values exist, set rows to those values, otherwise set to 0.
F.Intrinsic.Control.If(V.ODBC.Con!rstRun.EOF,<>,True)
	F.Intrinsic.Control.For(V.Local.iC,1,10,1)
		Gui.F_Est_Maint.gsfgEstRun.ApplyStyle(V.Local.iC,2)
		Gui.F_Est_Maint.gsfgEstRun.TextMatrix(0,V.Local.iC,V.ODBC.Con!rstRun.FieldValFloat!Qty_[V.Local.iC])
	F.Intrinsic.Control.Next(V.Local.iC)
F.Intrinsic.Control.Else
	F.Intrinsic.Control.For(V.Local.iC,1,10,1)
		Gui.F_Est_Maint.gsfgEstRun.ApplyStyle(V.Local.iC,2)
		Gui.F_Est_Maint.gsfgEstRun.TextMatrix(0,V.Local.iC,0)
	F.Intrinsic.Control.Next(V.Local.iC)
F.Intrinsic.Control.EndIf

F.ODBC.Con!rstRun.Close

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("BuildStyle_Qty_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	Function.Intrinsic.String.Concat("Project: GCG_3623_Custom_Maintenance.g2u",V.Ambient.Newline,V.Ambient.Newline,"Subroutine: ",V.Ambient.CurrentSubroutine,V.Ambient.NewLine,"Error Occurred ",V.Ambient.ErrorNumber," with description ",V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.CallSub(F_est_maint_unload)
Function.Intrinsic.Control.EndIf

Program.Sub.BuildStyle_Qty.End

Program.Sub.BuildStyle_Spd.Start
F.Intrinsic.Control.SetErrorHandler("BuildStyle_Spd_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String)
V.Local.iC.Declare(Long)

Gui.F_Est_Maint.gsfgEstSpd.AddGridViewFromDataView("GridSpeed","Speed","Speedview")
Gui.F_Est_Maint.gsfgEstSpd.MainView("GridSpeed")

Gui.F_Est_Maint.gsfgEstSpd.SetColumnProperty("GridSpeed","FEET_PER_ROLL","Caption","FT/Roll")
Gui.F_Est_Maint.gsfgEstSpd.SetColumnProperty("GridSpeed","BLANK_SPD","Caption","Spd Blank")
Gui.F_Est_Maint.gsfgEstSpd.SetColumnProperty("GridSpeed","PRINT_SPD","Caption","Spd Print")
Gui.F_Est_Maint.gsfgEstSpd.SetColumnProperty("GridSpeed","IDS","Visible",False)

Gui.F_Est_Maint.gsfgEstSpd.SetColumnProperty("GridSpeed","FEET_PER_ROLL","AllowEdit",True)
Gui.F_Est_Maint.gsfgEstSpd.SetColumnProperty("GridSpeed","FEET_PER_ROLL","ReadOnly",False)
Gui.F_Est_Maint.gsfgEstSpd.SetColumnProperty("GridSpeed","BLANK_SPD","AllowEdit",True)
Gui.F_Est_Maint.gsfgEstSpd.SetColumnProperty("GridSpeed","BLANK_SPD","ReadOnly",False)
Gui.F_Est_Maint.gsfgEstSpd.SetColumnProperty("GridSpeed","PRINT_SPD","AllowEdit",True)
Gui.F_Est_Maint.gsfgEstSpd.SetColumnProperty("GridSpeed","PRINT_SPD","ReadOnly",False)


''Clear Styles
'Gui.F_Est_Maint.gsfgEstSpd.ClearStyle(1)
'Gui.F_Est_Maint.gsfgEstSpd.ClearStyle(2)
'
''Set Columns and Rows
'Gui.F_Est_Maint.gsfgEstSpd.Cols(4)
'Gui.F_Est_Maint.gsfgEstSpd.Rows(1)
'Gui.F_Est_Maint.gsfgEstSpd.Rows(2)
'Gui.F_Est_Maint.gsfgEstSpd.FixedRows(1)
'
''Set Column Headers
'Gui.F_Est_Maint.gsfgEstSpd.TextMatrix(0,0,"FT/Roll")
'Gui.F_Est_Maint.gsfgEstSpd.TextMatrix(1,0,"Spd Blank")
'Gui.F_Est_Maint.gsfgEstSpd.TextMatrix(2,0,"Spd Print")
'
''Set column widths
'Gui.F_Est_Maint.gsfgEstSpd.ColWidth(0,1000)
'Gui.F_Est_Maint.gsfgEstSpd.ColWidth(1,1000)
'Gui.F_Est_Maint.gsfgEstSpd.ColWidth(2,1000)
'Gui.F_Est_Maint.gsfgEstSpd.ColWidth(3,0)
'
''Header Style
'F.Intrinsic.Control.For(V.Local.iC,0,3,1)
'	Gui.F_Est_Maint.gsfgEstSpd.BuildStyle(1,V.Local.iC,"Type","Locked",True)
'	Gui.F_Est_Maint.gsfgEstSpd.BuildStyle(1,V.Local.iC,"Format","Alignment",4)
'	Gui.F_Est_Maint.gsfgEstSpd.BuildStyle(1,V.Local.iC,"FontStyle","Bold",True)
'F.Intrinsic.Control.Next(V.Local.iC)
'
''Style 2
''Column 0
'Gui.F_Est_Maint.gsfgEstSpd.BuildStyle(2,0,"Format","Alignment",2)
''Column 1
'Gui.F_Est_Maint.gsfgEstSpd.BuildStyle(2,1,"Format","Numeric",True)
'Gui.F_Est_Maint.gsfgEstSpd.BuildStyle(2,1,"Format","Alignment",6)
''Column 2
'Gui.F_Est_Maint.gsfgEstSpd.BuildStyle(2,2,"Format","Numeric",True)
'Gui.F_Est_Maint.gsfgEstSpd.BuildStyle(2,2,"Format","Alignment",6)
'
'Gui.F_Est_Maint.gsfgEstSpd.ApplyStyle(0,1)

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("BuildStyle_Spd_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	Function.Intrinsic.String.Concat("Project: GCG_3623_Custom_Maintenance.g2u",V.Ambient.Newline,V.Ambient.Newline,"Subroutine: ",V.Ambient.CurrentSubroutine,V.Ambient.NewLine,"Error Occurred ",V.Ambient.ErrorNumber," with description ",V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.CallSub(F_est_maint_unload)
Function.Intrinsic.Control.EndIf

Program.Sub.BuildStyle_Spd.End

Program.Sub.Load_Spd.Start
F.Intrinsic.Control.SetErrorHandler("Load_Spd_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String)
V.Local.iRows.Declare(Long)

'Get Next ID value
F.ODBC.Connection!Con.OpenLocalRecordsetRO("rstSpd","SELECT TOP 1 IDS FROM GCG_3623_SPD_MAINT ORDER BY IDS DESC")

F.Intrinsic.Control.If(V.ODBC.Con!rstSpd.EOF,<>,True)
	V.Global.iID.Set(V.ODBC.Con!rstSpd.FieldValLong!IDS)
	'Add one to largest value for new item
'	F.Intrinsic.Math.Add(V.Global.iID,1,V.Global.iID)
F.Intrinsic.Control.EndIf

F.ODBC.Con!rstSpd.Close

'Load Data to UDT
f.Data.DataTable.CreateFromSQL("Speed","Con","SELECT RTRIM(FEET_PER_ROLL) AS FEET_PER_ROLL, BLANK_SPD, PRINT_SPD, IDS FROM GCG_3623_SPD_MAINT",True)
f.Data.DataView.Create("Speed","SpeedView",22)

'F.ODBC.Connection!Con.OpenLocalRecordsetRW("rstSpd","Select * FROM GCG_3623_SPD_MAINT ORDER BY IDS")
'
'F.Intrinsic.Control.If(V.ODBC.Con!rstSpd.EOF,<>,True)
'	Gui.F_Est_Maint.gsfgEstSpd.LoadRecordset("Con!rstSpd",2,False)
'F.Intrinsic.Control.EndIf
'
''Close recordset and initialize last row in table
'F.ODBC.Con!rstSpd.Close
'F.Intrinsic.Math.Sub(V.Screen.F_Est_Maint!gsfgEstSpd.Rows,1,V.Local.iRows)
'
'Gui.F_Est_Maint.gsfgEstSpd.ApplyStyle(V.Local.iRows,2)
'Gui.F_Est_Maint.gsfgEstSpd.TextMatrix(1,V.Local.iRows,0)
'Gui.F_Est_Maint.gsfgEstSpd.TextMatrix(2,V.Local.iRows,0)
'Gui.F_Est_Maint.gsfgEstSpd.TextMatrix(3,V.Local.iRows,V.Global.iID)
F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("Load_Spd_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	Function.Intrinsic.String.Concat("Project: GCG_3623_Custom_Maintenance.g2u",V.Ambient.Newline,V.Ambient.Newline,"Subroutine: ",V.Ambient.CurrentSubroutine,V.Ambient.NewLine,"Error Occurred ",V.Ambient.ErrorNumber," with description ",V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.CallSub(F_est_maint_unload)
Function.Intrinsic.Control.EndIf

Program.Sub.Load_Spd.End

Program.Sub.Check_Credentials.Start
F.Intrinsic.Control.SetErrorHandler("Check_Credentials_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String)
V.Local.sGroup.Declare(String)
V.Local.iC.Declare(Long)
V.Local.sSQL.Declare(String)

'Get user groups
F.Global.Security.GetUserGroups(V.Caller.User,V.Caller.CompanyCode,V.Local.sGroup)
F.Intrinsic.String.Split(V.Local.sGroup,"*!*",V.Local.sGroup)

F.Intrinsic.Control.For(V.Local.iC,0,V.Local.sGroup.UBound,1)
	F.Intrinsic.String.Build("SELECT ADMIN1 AS ADMIN FROM GCG_3623_GRP_MAINT WHERE GRP = '{0}'",V.Local.sGroup(V.Local.iC),V.Local.sSQL)
	F.ODBC.Connection!Con.OpenLocalRecordsetRO("rstCred",V.Local.sSQL)

	F.Intrinsic.Control.If(V.ODBC.Con!rstCred.EOF,<>,True)
		F.Intrinsic.Control.If(V.ODBC.Con!rstCred.FieldVal!ADMIN,=,True,"OR",V.Caller.User,=,"SUPERVSR")
			V.Global.bAccess.Set(True)
		F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.ElseIf(V.Caller.User,=,"SUPERVSR")
		V.Global.bAccess.Set(True)
	F.Intrinsic.Control.EndIf

	F.ODBC.Con!rstCred.Close
F.Intrinsic.Control.Next(V.Local.iC)

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("Check_Credentials_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	Function.Intrinsic.String.Concat("Project: GCG_3623_Custom_Maintenance.g2u",V.Ambient.Newline,V.Ambient.Newline,"Subroutine: ",V.Ambient.CurrentSubroutine,V.Ambient.NewLine,"Error Occurred ",V.Ambient.ErrorNumber," with description ",V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.CallSub(F_est_maint_unload)
Function.Intrinsic.Control.EndIf

Program.Sub.Check_Credentials.End

Program.Sub.Load_Part.Start
F.Intrinsic.Control.SetErrorHandler("Load_Material_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String)
V.Local.sSQL.Declare(String)
V.Local.fQuote.Declare(Float)
V.Local.iC.Declare(Long)


'Set screen information
Gui.F_Est_Maint.txtMatPart.Text(V.Args.Part)
Gui.F_Est_Maint.txtMatLoc.Text(V.Args.Loc)
Gui.F_Est_Maint.txtMatDesc.Text(V.Args.Desc)
Gui.F_Est_Maint.txtMatSC.Text(V.Args.SC)
'Set Tool Part Info as well
Gui.F_Est_Maint.txtTolPart.Text(V.Args.Part)
Gui.F_Est_Maint.txtTolLoc.Text(V.Args.Loc)
Gui.F_Est_Maint.txtTolDesc.Text(V.Args.Desc)
Gui.F_Est_Maint.txtTolSC.Text(V.Args.SC)

'Hide screen since there is a lot of information being loaded
Gui.F_Est_Maint..Visible(False)

'we need to query for the additional information from the custom inventory table
F.Intrinsic.String.Build("SELECT * FROM GCG_3623_INVENTORY WHERE PART = '{0}' AND LOCATION1 = '{1}' ",V.Args.Part,V.Args.Loc,V.Local.sSQL)
F.ODBC.Connection!Con.OpenLocalRecordsetRO("rst",V.Local.sSQL)
'if we have a part then populate the fields
F.Intrinsic.Control.If(V.ODBC.Con!rst.EOF,=,False)
	Gui.F_Est_Maint.txtMatAC.Text(V.ODBC.Con!rst.FieldValTrim!ADHESIVE_CODE)
	Gui.F_Est_Maint.txtMatSTLF.Text(V.ODBC.Con!rst.FieldValFloat!SERVICE_TEMP_F_LOW)
	Gui.F_Est_Maint.txtMatSTLC.Text(V.ODBC.Con!rst.FieldValFloat!SERVICE_TEMP_C_LOW)
	Gui.F_Est_Maint.txtMatSTHF.Text(V.ODBC.Con!rst.FieldValFloat!SERVICE_TEMP_F_HIGH)
	Gui.F_Est_Maint.txtMatSTHC.Text(V.ODBC.Con!rst.FieldValFloat!SERVICE_TEMP_C_HIGH)
	Gui.F_Est_Maint.txtMatMAF.Text(V.ODBC.Con!rst.FieldValFloat!MIN_APPLIC_F)
	Gui.F_Est_Maint.txtMatMAC.Text(V.ODBC.Con!rst.FieldValFloat!MIN_APPLIC_C)
	Gui.F_Est_Maint.txtMatLineWeight.Text(V.ODBC.Con!rst.FieldValTrim!LINER_WEIGHT)
	Gui.F_Est_Maint.txtMatAdType.Text(V.ODBC.Con!rst.FieldValTrim!ADHESIVE_TYPE)
	Gui.F_Est_Maint.txtMatThick.Text(V.ODBC.Con!rst.FieldValFloat!CALIPER_THICKNESS)
	Gui.F_Est_Maint.txtMatLbs.Text(V.ODBC.Con!rst.FieldValFloat!LBS_PER_MSI)
	Gui.F_Est_Maint.txtMatGrade.Text(V.ODBC.Con!rst.FieldValTrim!GRADE)
	Gui.F_Est_Maint.txtMatLineScreen.Text(V.ODBC.Con!rst.FieldValFloat!LINE_SCREEN)
	Gui.F_Est_Maint.txtMatDotSize.Text(V.ODBC.Con!rst.FieldValFloat!DOT_SIZE)
	Gui.F_Est_Maint.txtMatFreightSur.Text(V.ODBC.Con!rst.FieldValFloat!FREIGHT_SURCHARGE)
	Gui.F_Est_Maint.mltMatComment.Text(V.ODBC.Con!rst.FieldValTrim!COMMENTS)
	Gui.F_Est_Maint.txtMatFaceDesc.Text(V.ODBC.Con!rst.FieldValTrim!FACE_SHEET_DESC)
	Gui.F_Est_Maint.txtMatMaterialType.Text(V.ODBC.Con!rst.FieldValTrim!MATERIAL_TYPE)
	Gui.F_Est_Maint.txtMatMinOrder.Text(V.ODBC.Con!rst.FieldValTrim!MINIMUM_ORDER)
	Gui.F_Est_Maint.txtMatMSIPrice.Text(V.ODBC.Con!rst.FieldValFloat!DEFAULT_MSI)
	Gui.F_Est_Maint.txtMatWidth.Text(V.ODBC.Con!rst.FieldValFloat!WIDTH)

	'Set Exact Checkbox value
	F.Intrinsic.Control.If(V.ODBC.Con!rst.FieldValTrim!EXACT,=,True)
		Gui.F_Est_Maint.chkMatExact.Value(1)
	F.Intrinsic.Control.Else
		Gui.F_Est_Maint.chkMatExact.Value(0)
	F.Intrinsic.Control.EndIf

	'Set Product Codes and Master Widths
	F.Intrinsic.Control.For(V.Local.iC,1,5,1)
		Gui.F_Est_Maint.txtMatPC[V.Local.iC].Text(V.ODBC.Con!rst.FieldValTrim!PRODUCT_CODE_[V.Local.iC])
		Gui.F_Est_Maint.txtMatMW[V.Local.iC].Text(V.ODBC.Con!rst.FieldValFloat!MASTER_WIDTH_[V.Local.iC])
	F.Intrinsic.Control.Next(V.Local.iC)

	'Tool info goes along with Material Info
	Gui.F_Est_Maint.txtTolACRDie.Text(V.ODBC.Con!rst.FieldValTrim!ACR_DIE)
	Gui.F_Est_Maint.txtTolACRPress.Text(V.ODBC.Con!rst.FieldValTrim!ACR_PRESS)
	Gui.F_Est_Maint.txtTolACRFin.Text(V.ODBC.Con!rst.FieldValTrim!ACR_FIN)
	Gui.F_Est_Maint.txtTolStepAcross.Text(V.ODBC.Con!rst.FieldValFloat!STEP_ACROSS)
	Gui.F_Est_Maint.txtTolStepAround.Text(V.ODBC.Con!rst.FieldValFloat!STEP_AROUND)
	Gui.F_Est_Maint.txtTolCavAcross.Text(V.ODBC.Con!rst.FieldValLong!CAV_ACROSS)
	Gui.F_Est_Maint.txtTolCavAround.Text(V.ODBC.Con!rst.FieldValLong!CAV_AROUND)
	Gui.F_Est_Maint.txtTolCorner.Text(V.ODBC.Con!rst.FieldValFloat!CORNER_RADII)
	Gui.F_Est_Maint.txtTolToothSize.Text(V.ODBC.Con!rst.FieldValFloat!TOOTH_SIZE)
	Gui.F_Est_Maint.txtTolShape.Text(V.ODBC.Con!rst.FieldValTrim!SHAPE)
	Gui.F_Est_Maint.txtTolShapeDesc.Text(V.ODBC.Con!rst.FieldValTrim!SHAPE_DESC)
	Gui.F_Est_Maint.txtTolUsed.Text(V.ODBC.Con!rst.FieldValTrim!MAT_USED)
	Gui.F_Est_Maint.txtTolStatus.Text(V.ODBC.Con!rst.FieldValTrim!STATUS1)
	Gui.F_Est_Maint.txtTolToolNum.Text(V.ODBC.Con!rst.FieldValFloat!TOOL_NUMBER)
	Gui.F_Est_Maint.txtTolInternalLblWidth.Text(V.ODBC.Con!rst.FieldValFloat!INT_LBL_WIDTH)
	Gui.F_Est_Maint.txtTolInternalLblLength.Text(V.ODBC.Con!rst.FieldValFloat!INT_LBL_LENGTH)
	Gui.F_Est_Maint.txtTolInternalLblNum.Text(V.ODBC.Con!rst.FieldValFloat!INT_LBL_NUMOUT)
	Gui.F_Est_Maint.txtTolWasteEdge.Text(V.ODBC.Con!rst.FieldValFloat!WASTE_EDGE)
	Gui.F_Est_Maint.txtTolAcross.Text(V.ODBC.Con!rst.FieldValLong!ACROSS)
	Gui.F_Est_Maint.txtTolAround.Text(V.ODBC.Con!rst.FieldValLong!AROUND)
	Gui.F_Est_Maint.txtTolGapAcross.Text(V.ODBC.Con!rst.FieldValFloat!GAP_ACROSS)
	Gui.F_Est_Maint.txtTolGapDown.Text(V.ODBC.Con!rst.FieldValFloat!GAP_DOWN)
	Gui.F_Est_Maint.txtTolLinerThick.Text(V.ODBC.Con!rst.FieldValTrim!LINER_THICK)
	Gui.F_Est_Maint.txtTolLength.Text(V.ODBC.Con!rst.FieldValFloat!LENGTH1)
	Gui.F_Est_Maint.txtTolWidth.Text(V.ODBC.Con!rst.FieldValFloat!WIDTH)

	F.Intrinsic.Control.If(V.ODBC.Con!rst.FieldValTrim!MINIMUMS_WAVED,=,True)
		Gui.F_Est_Maint.chkTolMinWaved.Value(1)
	F.Intrinsic.Control.Else
		Gui.F_Est_Maint.chkTolMinWaved.Value(0)
	F.Intrinsic.Control.EndIf
F.Intrinsic.Control.EndIf
F.ODBC.Con!rst.Close

'Get  Date Last Changed And Time Material Lead AND COST
F.Intrinsic.String.Build("SELECT TIME_MATERIAL_LEAD, DATE_LAST_CHG,AMT_COST FROM V_INVENTORY_MSTR WHERE PART = '{0}' AND LOCATION = '{1}'",V.Args.Part,V.Args.Loc,V.Local.sSQL)
F.ODBC.Connection!Con.OpenLocalRecordsetRO("rstPart",V.Local.sSQL)

F.Intrinsic.Control.If(V.ODBC.Con!rstPart.EOF,<>,True)
	Gui.F_Est_Maint.txtMatLead.Text(V.ODBC.Con!rstPart.FieldValFloat!TIME_MATERIAL_LEAD)
	F.Intrinsic.Control.If(V.ODBC.Con!rstPart.FieldValTrim!DATE_LAST_CHG,<>,"1/1/1900")
		Gui.F_Est_Maint.txtMatDateChg.Text(V.ODBC.Con!rstPart.FieldValTrim!DATE_LAST_CHG)
	F.Intrinsic.Control.EndIf
	'Set Actual Price
	Gui.F_Est_Maint.txtMatActPrice.Text(V.ODBC.Con!rstPart.FieldVal!AMT_COST)
	Gui.F_Est_Maint.txtTolActPrice.Text(V.ODBC.Con!rstPart.FieldVal!AMT_COST)
F.Intrinsic.Control.EndIf

F.ODBC.Con!rstPart.Close

'get Vendor Number and name
F.Intrinsic.String.Build("SELECT NAME_VENDOR FROM INVENTORY_MST2 WHERE PART = '{0}' AND LOCATION = '{1}'",V.Args.Part,V.Args.Loc,V.Local.sSQL)
F.ODBC.Connection!Con.OpenLocalRecordsetRO("rstPart",V.Local.sSQL)

F.Intrinsic.Control.If(V.ODBC.Con!rstPart.EOF,<>,True)
	Gui.F_Est_Maint.txtMatVenNum.Text(V.ODBC.Con!rstPart.FieldValTrim!NAME_VENDOR)
	Gui.F_Est_Maint.txtTolVenNum.Text(V.ODBC.Con!rstPart.FieldValTrim!NAME_VENDOR)
	'Get vendor name if part has a vendor
	F.Intrinsic.Control.If(V.Screen.F_Est_Maint!txtMatVenNum.Text.Trim,<>,"")
		F.Intrinsic.String.Build("SELECT NAME_VENDOR FROM V_VENDOR_MASTER WHERE VENDOR = '{0}'",V.Screen.F_Est_Maint!txtMatVenNum.Text.Trim,V.Local.sSQL)
		F.ODBC.Connection!Con.OpenLocalRecordsetRO("rstVend",V.Local.sSQL)

		F.Intrinsic.Control.If(V.ODBC.Con!rstVend.EOF,<>,True)
			Gui.F_Est_Maint.txtMatVenName.Text(V.ODBC.Con!rstVend.FieldValTrim!NAME_VENDOR)
		F.Intrinsic.Control.EndIf

		F.ODBC.Con!rstVend.Close
	F.Intrinsic.Control.EndIf
F.Intrinsic.Control.EndIf

F.ODBC.Con!rstPart.Close

'Get Part Created Date
F.Intrinsic.String.Build("SELECT PART_CREATE_DATE FROM V_INVENTORY_MST3 WHERE PART = '{0}' AND LOCATION = '{1}'",V.Args.Part,V.Args.Loc,V.Local.sSQL)
F.ODBC.Connection!Con.OpenLocalRecordsetRO("rstPart",V.Local.sSQL)

F.Intrinsic.Control.If(V.ODBC.Con!rstPart.EOF,<>,True)
	F.Intrinsic.Control.If(V.ODBC.Con!rstPart.FieldValTrim!PART_CREATE_DATE,<>,"1/1/1900")
		Gui.F_Est_Maint.txtMatDateAdd.Text(V.ODBC.Con!rstPart.FieldValTrim!PART_CREATE_DATE)
	F.Intrinsic.Control.EndIf
F.Intrinsic.Control.EndIf

F.ODBC.Con!rstPart.Close

'Get checked FOBs
F.Intrinsic.String.Build("SELECT FOB FROM GCG_3623_FOB_MAINT WHERE RTRIM(PART) = '{0}' AND ISNULL(LOC,'') = '{1}'",V.Screen.F_Est_Maint!txtMatPart.Text.Trim,V.Screen.F_Est_Maint!txtMatLoc.Text.Trim,V.Local.sSQL)
F.ODBC.Connection!Con.OpenLocalRecordsetRO("rstFOB",V.Local.sSQL)

F.Intrinsic.Control.DoUntil(V.ODBC.Con!rstFOB.EOF,=,True)
	Gui.F_Est_Maint.lvwMatFOB.ListItemCheck(V.ODBC.Con!rstFOB.FieldVal!FOB,True)
	F.ODBC.Con!rstFOB.MoveNext
F.Intrinsic.Control.Loop

'Load Upcharge list
Gui.F_Est_Maint.lvwMatUpcharge.ClearItems
F.Intrinsic.Control.CallSub(Load_mat_list,"Table","UP")
'Load Price List
Gui.F_Est_Maint.lvwMatPrice.ClearItems
F.Intrinsic.Control.CallSub(Load_mat_list,"Table","PRICE")

F.ODBC.Con!rstFOB.Close

'Unhide screen
Gui.F_Est_Maint..Visible(True)

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("Load_Material_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	Function.Intrinsic.String.Concat("Project: GCG_3623_Custom_Maintenance.g2u",V.Ambient.Newline,V.Ambient.Newline,"Subroutine: ",V.Ambient.CurrentSubroutine,V.Ambient.NewLine,"Error Occurred ",V.Ambient.ErrorNumber," with description ",V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.CallSub(F_est_maint_unload)
Function.Intrinsic.Control.EndIf

Program.Sub.Load_Part.End

Program.Sub.Save_Material.Start
F.Intrinsic.Control.SetErrorHandler("Save_Material_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String)
V.Local.sSQL.Declare(String)
V.Local.iC.Declare(Long)
V.Local.sFOB.Declare(String)
V.Local.sPart.Declare(String)
v.Local.sTemp1.Declare(String)
v.Local.sTemp2.Declare(String)

'if part is not empty then we can save
F.Intrinsic.Control.If(V.Screen.F_Est_Maint!txtMatPart.Text,<>,"")
	'we have a part so now we just need to save all of our additional fields to the custom table
	F.Intrinsic.String.Build("SELECT * FROM GCG_3623_INVENTORY WHERE PART = '{0}' AND LOCATION1 = '{1}' ",V.Screen.F_Est_Maint!txtMatPart.Text.PSQLFriendly,V.Screen.F_Est_Maint!txtMatLoc.Text,V.Local.sSQL)
	F.ODBC.Connection!Con.OpenLocalRecordsetRW("rstUpdate",V.Local.sSQL)
	'if we are eof then add new line
	F.Intrinsic.Control.If(V.ODBC.Con!rstUpdate.EOF,=,True)
		F.ODBC.Con!rstUpdate.AddNew
		F.ODBC.Con!rstUpdate.Set!PART(V.Screen.F_Est_Maint!txtMatPart.Text)
		F.ODBC.Con!rstUpdate.Set!LOCATION1(V.Screen.F_Est_Maint!txtMatLoc.Text)
	F.Intrinsic.Control.EndIf

	'update all of the fields for the part loc for Material Tab
	F.ODBC.Con!rstUpdate.Set!ADHESIVE_CODE(V.Screen.F_Est_Maint!txtMatAC.Text)
	F.ODBC.Con!rstUpdate.Set!SERVICE_TEMP_F_LOW(V.Screen.F_Est_Maint!txtMatSTLF.Text.Float)
	'		F.ODBC.Con!rstUpdate.Set!SERVICE_TEMP_C_LOW(V.Screen.F_Est_Maint!txtMatSTLC.Text.Float)
	F.ODBC.Con!rstUpdate.Set!SERVICE_TEMP_F_HIGH(V.Screen.F_Est_Maint!txtMatSTHF.Text.Float)
	'		F.ODBC.Con!rstUpdate.Set!SERVICE_TEMP_C_HIGH(V.Screen.F_Est_Maint!txtMatSTHC.Text.Float)
	F.ODBC.Con!rstUpdate.Set!MIN_APPLIC_F(V.Screen.F_Est_Maint!txtMatMAF.Text.Float)
	'		F.ODBC.Con!rstUpdate.Set!MIN_APPLIC_C(V.Screen.F_Est_Maint!txtMatMAC.Text.Float)
	F.ODBC.Con!rstUpdate.Set!LINER_WEIGHT(V.Screen.F_Est_Maint!txtMatLineWeight.Text)
	F.ODBC.Con!rstUpdate.Set!ADHESIVE_TYPE(V.Screen.F_Est_Maint!txtMatAdType.Text)
	F.ODBC.Con!rstUpdate.Set!CALIPER_THICKNESS(V.Screen.F_Est_Maint!txtMatThick.Text.Float)
	F.ODBC.Con!rstUpdate.Set!LBS_PER_MSI(V.Screen.F_Est_Maint!txtMatLbs.Text.Float)
	F.ODBC.Con!rstUpdate.Set!COMMENTS(V.Screen.F_Est_Maint!mltMatComment.Text)
	F.ODBC.Con!rstUpdate.Set!GRADE(V.Screen.F_Est_Maint!txtMatGrade.Text)
	F.ODBC.Con!rstUpdate.Set!LINE_SCREEN(V.Screen.F_Est_Maint!txtMatLineScreen.Text.Float)
	F.ODBC.Con!rstUpdate.Set!DOT_SIZE(V.Screen.F_Est_Maint!txtMatDotSize.Text.Float)
	F.ODBC.Con!rstUpdate.Set!FREIGHT_SURCHARGE(V.Screen.F_Est_Maint!txtMatFreightSur.Text.Float)
	F.ODBC.Con!rstUpdate.Set!FACE_SHEET_DESC(V.Screen.F_Est_Maint!txtMatFaceDesc.Text)
	F.ODBC.Con!rstUpdate.Set!MATERIAL_TYPE(V.Screen.F_Est_Maint!txtMatMaterialType.Text)
	F.ODBC.Con!rstUpdate.Set!MINIMUM_ORDER(V.Screen.F_Est_Maint!txtMatMinOrder.Text)
	F.ODBC.Con!rstUpdate.Set!EXACT(V.Screen.F_Est_Maint!chkMatExact.Value)
	F.ODBC.Con!rstUpdate.Set!DEFAULT_MSI(V.Screen.F_Est_Maint!txtMatMSIPrice.Text.Float)
	
	'Update all of the fields for the part loc for Tooling tab
	F.ODBC.Con!rstUpdate.Set!ACR_DIE(V.Screen.F_Est_Maint!txtTolACRDie.Text)
	F.ODBC.Con!rstUpdate.Set!ACR_PRESS(V.Screen.F_Est_Maint!txtTolACRPress.Text)
	F.ODBC.Con!rstUpdate.Set!ACR_FIN(V.Screen.F_Est_Maint!txtTolACRFin.Text)
	F.ODBC.Con!rstUpdate.Set!STEP_ACROSS(V.Screen.F_Est_Maint!txtTolStepAcross.Text.Float)
	F.ODBC.Con!rstUpdate.Set!STEP_AROUND(V.Screen.F_Est_Maint!txtTolStepAround.Text.Float)
	F.ODBC.Con!rstUpdate.Set!CAV_ACROSS(V.Screen.F_Est_Maint!txtTolCavAcross.Text.Long)
	F.ODBC.Con!rstUpdate.Set!CAV_AROUND(V.Screen.F_Est_Maint!txtTolCavAround.Text.Long)
	F.ODBC.Con!rstUpdate.Set!CORNER_RADII(V.Screen.F_Est_Maint!txtTolCorner.Text.Float)
	F.ODBC.Con!rstUpdate.Set!TOOTH_SIZE(V.Screen.F_Est_Maint!txtTolToothSize.Text.Float)
	F.ODBC.Con!rstUpdate.Set!SHAPE(V.Screen.F_Est_Maint!txtTolShape.Text)
	F.ODBC.Con!rstUpdate.Set!SHAPE_DESC(V.Screen.F_Est_Maint!txtTolShapeDesc.Text)
	F.ODBC.Con!rstUpdate.Set!MAT_USED(V.Screen.F_Est_Maint!txtTolUsed.Text)
	F.ODBC.Con!rstUpdate.Set!STATUS1(V.Screen.F_Est_Maint!txtTolStatus.Text)
	F.ODBC.Con!rstUpdate.Set!TOOL_NUMBER(V.Screen.F_Est_Maint!txtTolToolNum.Text.Float)
	F.ODBC.Con!rstUpdate.Set!INT_LBL_WIDTH(V.Screen.F_Est_Maint!txtTolInternalLblWidth.Text.Float)
	F.ODBC.Con!rstUpdate.Set!INT_LBL_LENGTH(V.Screen.F_Est_Maint!txtTolInternalLblLength.Text.Float)
	F.ODBC.Con!rstUpdate.Set!INT_LBL_NUMOUT(V.Screen.F_Est_Maint!txtTolInternalLblNum.Text.Float)
	F.ODBC.Con!rstUpdate.Set!WASTE_EDGE(V.Screen.F_Est_Maint!txtTolWasteEdge.Text.Float)
	F.ODBC.Con!rstUpdate.Set!MINIMUMS_WAVED(V.Screen.F_Est_Maint!chkTolMinWaved.Value)
	F.ODBC.Con!rstUpdate.Set!ACROSS(V.Screen.F_Est_Maint!txtTolAcross.Text.Long)
	F.ODBC.Con!rstUpdate.Set!AROUND(V.Screen.F_Est_Maint!txtTolAround.Text.Long)
	F.ODBC.Con!rstUpdate.Set!GAP_ACROSS(V.Screen.F_Est_Maint!txtTolGapAcross.Text.Float)
	F.ODBC.Con!rstUpdate.Set!GAP_DOWN(V.Screen.F_Est_Maint!txtTolGapDown.Text.Float)
	F.ODBC.Con!rstUpdate.Set!LINER_THICK(V.Screen.F_Est_Maint!txtTolLinerThick.Text)
	F.ODBC.Con!rstUpdate.Set!LENGTH1(V.Screen.F_Est_Maint!txtTolLength.Text.Float)
	F.ODBC.Con!rstUpdate.Set!WIDTH(V.Screen.F_Est_Maint!txtTolWidth.Text.Float)
	
	
	
	'Save product codes and Master widths
	F.Intrinsic.Control.For(V.Local.iC,1,5,1)
		F.ODBC.Con!rstUpdate.Set!PRODUCT_CODE_[V.Local.iC](V.Screen.F_Est_Maint!txtMatPC[V.Local.iC].Text)
		F.ODBC.Con!rstUpdate.Set!MASTER_WIDTH_[V.Local.iC](V.Screen.F_Est_Maint!txtMatMW[V.Local.iC].Text.Float)
	F.Intrinsic.Control.Next(V.Local.iC)
	F.ODBC.Con!rstUpdate.Update
	F.ODBC.Con!rstUpdate.Close


	'Update FOB Selection
	Gui.F_Est_Maint.lvwMatFOB.RetrieveCheckedListItems(V.Local.sFOB)
	'Delete all records from table for that part
	F.Intrinsic.String.Build("DELETE FROM GCG_3623_FOB_MAINT WHERE RTRIM(PART) = '{0}' AND ISNULL(LOC,'') = '{1}'",V.Screen.F_Est_Maint!txtMatPart.Text.PSQLFriendly,V.Screen.F_Est_Maint!txtMatLoc.Text,V.Local.sSQL)
	F.ODBC.Connection!Con.Execute(V.Local.sSQL)
	'Check to make sure there is at least one checked in order to save to the table
	F.Intrinsic.Control.If(V.Local.sFOB,<>,"***NORETURN***")
		'Add records to table
		F.Intrinsic.String.Split(V.Local.sFOB,"*!*",V.Local.sFOB)
		'Check to make sure everything was deleted properly
		F.Intrinsic.String.Build("SELECT * FROM GCG_3623_FOB_MAINT WHERE RTRIM(PART) = '{0}' AND ISNULL(LOC,'') = '{1}'",V.Screen.F_Est_Maint!txtMatPart.Text.PSQLFriendly,V.Screen.F_Est_Maint!txtMatLoc.Text,V.Local.sSQL)
		F.ODBC.Connection!Con.OpenLocalRecordsetRW("rstFOB",V.Local.sSQL)
		F.Intrinsic.Control.If(V.ODBC.Con!rstFOB.EOF,=,True)
			F.Intrinsic.Control.For(V.Local.iC,0,V.Local.sFOB.UBound,1)
				F.ODBC.Con!rstFOB.AddNew
				F.ODBC.Con!rstFOB.Set!PART(V.Screen.F_Est_Maint!txtMatPart.Text)
				F.ODBC.Con!rstFOB.Set!LOC(V.Screen.F_Est_Maint!txtMatLoc.Text)
				F.ODBC.Con!rstFOB.Set!FOB(V.Local.sFOB(V.Local.iC))
				F.ODBC.Con!rstFOB.Update
			F.Intrinsic.Control.Next(V.Local.iC)
		F.Intrinsic.Control.EndIf
		F.ODBC.Con!rstFOB.Close
	F.Intrinsic.Control.EndIf

	'Save Upcharge Values
	F.Intrinsic.Control.CallSub(Save_mat_list,"Table","UP","Control","Upcharge")
	'Save Price and Break Quantity
	F.Intrinsic.Control.CallSub(Save_mat_list,"Table","PRICE","Control","Price")
	
	'We need to check and see if our PL is ZM
	f.Intrinsic.String.Build("SELECT PRODUCT_LINE FROM V_INVENTORY_MSTR WHERE PART = '{0}' AND LOCATION = '{1}' AND PRODUCT_LINE = 'ZM' ",V.Screen.F_Est_Maint!txtMatPart.Text.PSQLFriendly,v.Screen.F_Est_Maint!txtMatLoc.Text,v.Local.sSQL)
	f.ODBC.Connection!Con.OpenLocalRecordsetRO("rstCheck",v.Local.sSQL)
	f.Intrinsic.Control.If(v.ODBC.Con!rstCheck.EOF,=,False)
		'We have Product Line TM
		'Ask them if they want to update all RM's from the TM
		f.Intrinsic.UI.Msgbox("Do you want to update all RM parts?","Warning",4,v.Local.sPart)
		f.Intrinsic.Control.If(v.Local.sPart.Long,=,6)
			'We need to build the query for updating
			'oh god
			F.Intrinsic.String.Left(V.Screen.F_Est_Maint!txtMatPart.Text,5,V.Local.sPart)
			f.Intrinsic.String.Build("SELECT RTRIM(PART) AS PART, RTRIM(LOCATION) AS LOCATION FROM V_INVENTORY_MSTR WHERE LEFT(PART,5) = '{0}' AND PRODUCT_LINE = 'RM'",v.Local.sPart,v.Local.sSQL)
			f.Data.DataTable.CreateFromSQL("RMPart","Con",v.Local.sSQL,True)
			
			f.Intrinsic.Control.For(v.Local.iC,v.DataTable.RMPart.RowCount--)
				f.Intrinsic.String.Build("SELECT RTRIM(PART) AS PART, RTRIM(LOCATION1) AS LOCATION FROM GCG_3623_INVENTORY WHERE PART = '{0}' AND LOCATION1 = '{1}' ",v.DataTable.RMPart(v.Local.iC).Part!FieldVal,v.DataTable.RMPart(v.Local.iC).Location!FieldVal,v.Local.sSQL)
				f.ODBC.Connection!Con.OpenLocalRecordSetRO("rstInvUp",v.Local.sSQL)
				f.Intrinsic.Control.If(v.ODBC.con!rstInvUp.EOF,=,False)
					F.Intrinsic.String.Build("ADHESIVE_CODE = '{0}', SERVICE_TEMP_F_LOW = '{1}',SERVICE_TEMP_F_HIGH = '{2}',MIN_APPLIC_F = '{3}',LINER_WEIGHT = '{4}',ADHESIVE_TYPE = '{5}',CALIPER_THICKNESS = '{6}',LBS_PER_MSI = '{7}',COMMENTS = '{8}',GRADE = '{9}',LINE_SCREEN = '{10}',DOT_SIZE = '{11}',FREIGHT_SURCHARGE = '{12}',FACE_SHEET_DESC = '{13}',MATERIAL_TYPE = '{14}',MINIMUM_ORDER = '{15}',EXACT = '{16}',DEFAULT_MSI = '{17}',ACR_DIE = '{18}',ACR_PRESS = '{19}',ACR_FIN = '{20}',STEP_ACROSS = '{21}',STEP_AROUND = '{22}',CAV_ACROSS = '{23}',CAV_AROUND = '{24}',CORNER_RADII = '{25}',TOOTH_SIZE = '{26}',SHAPE = '{27}',SHAPE_DESC = '{28}',MAT_USED = '{29}',STATUS1 = '{30}',TOOL_NUMBER = '{31}',INT_LBL_WIDTH = '{32}',INT_LBL_LENGTH = '{33}',INT_LBL_NUMOUT = '{34}',WASTE_EDGE = '{35}',MINIMUMS_WAVED = '{36}',ACROSS = '{37}',AROUND = '{38}',GAP_ACROSS = '{39}',GAP_DOWN = '{40}',LINER_THICK = '{41}',LENGTH1 = '{42}',PRODUCT_CODE_1 = '{43}',PRODUCT_CODE_2 = '{44}',PRODUCT_CODE_3 = '{45}',PRODUCT_CODE_4 = '{46}',PRODUCT_CODE_5 = '{47}',MASTER_WIDTH_1 = '{48}',MASTER_WIDTH_2 = '{49}',MASTER_WIDTH_3 = '{50}',MASTER_WIDTH_4 = '{51}',MASTER_WIDTH_5 = '{52}' ",V.Screen.F_Est_Maint!txtMatAC.Text.PSQLFriendly,V.Screen.F_Est_Maint!txtMatSTLF.Text.Float,V.Screen.F_Est_Maint!txtMatSTHF.Text.Float,V.Screen.F_Est_Maint!txtMatMAF.Text.Float,V.Screen.F_Est_Maint!txtMatLineWeight.Text.PSQLFriendly,V.Screen.F_Est_Maint!txtMatAdType.Text.PSQLFriendly,V.Screen.F_Est_Maint!txtMatThick.Text.Float,V.Screen.F_Est_Maint!txtMatLbs.Text.Float,V.Screen.F_Est_Maint!mltMatComment.Text.PSQLFriendly,V.Screen.F_Est_Maint!txtMatGrade.Text.PSQLFriendly,V.Screen.F_Est_Maint!txtMatLineScreen.Text.Float,V.Screen.F_Est_Maint!txtMatDotSize.Text.Float,V.Screen.F_Est_Maint!txtMatFreightSur.Text.Float,V.Screen.F_Est_Maint!txtMatFaceDesc.Text.PSQLFriendly,V.Screen.F_Est_Maint!txtMatMaterialType.Text.PSQLFriendly,V.Screen.F_Est_Maint!txtMatMinOrder.Text.PSQLFriendly,V.Screen.F_Est_Maint!chkMatExact.Value,V.Screen.F_Est_Maint!txtMatMSIPrice.Text.Float,V.Screen.F_Est_Maint!txtTolACRDie.Text.PSQLFriendly,V.Screen.F_Est_Maint!txtTolACRPress.Text.PSQLFriendly,V.Screen.F_Est_Maint!txtTolACRFin.Text.PSQLFriendly,V.Screen.F_Est_Maint!txtTolStepAcross.Text.Float,V.Screen.F_Est_Maint!txtTolStepAround.Text.Float,V.Screen.F_Est_Maint!txtTolCavAcross.Text.Long,V.Screen.F_Est_Maint!txtTolCavAround.Text.Long,V.Screen.F_Est_Maint!txtTolCorner.Text.Float,V.Screen.F_Est_Maint!txtTolToothSize.Text.Float,V.Screen.F_Est_Maint!txtTolShape.Text.PSQLFriendly,V.Screen.F_Est_Maint!txtTolShapeDesc.Text.PSQLFriendly,V.Screen.F_Est_Maint!txtTolUsed.Text.PSQLFriendly,V.Screen.F_Est_Maint!txtTolStatus.Text.PSQLFriendly,V.Screen.F_Est_Maint!txtTolToolNum.Text.Float,V.Screen.F_Est_Maint!txtTolInternalLblWidth.Text.Float,V.Screen.F_Est_Maint!txtTolInternalLblLength.Text.Float,V.Screen.F_Est_Maint!txtTolInternalLblNum.Text.Float,V.Screen.F_Est_Maint!txtTolWasteEdge.Text.Float,V.Screen.F_Est_Maint!chkTolMinWaved.Value,V.Screen.F_Est_Maint!txtTolAcross.Text.Long,V.Screen.F_Est_Maint!txtTolAround.Text.Long,V.Screen.F_Est_Maint!txtTolGapAcross.Text.Float,V.Screen.F_Est_Maint!txtTolGapDown.Text.Float,V.Screen.F_Est_Maint!txtTolLinerThick.Text.PSQLFriendly,V.Screen.F_Est_Maint!txtTolLength.Text.Float,V.Screen.F_Est_Maint!txtMatPC1.Text.PSQLFriendly,V.Screen.F_Est_Maint!txtMatPC2.Text.PSQLFriendly,V.Screen.F_Est_Maint!txtMatPC3.Text.PSQLFriendly,V.Screen.F_Est_Maint!txtMatPC4.Text.PSQLFriendly,V.Screen.F_Est_Maint!txtMatPC5.Text.PSQLFriendly,V.Screen.F_Est_Maint!txtMatMW1.Text.Float,V.Screen.F_Est_Maint!txtMatMW2.Text.Float,V.Screen.F_Est_Maint!txtMatMW3.Text.Float,V.Screen.F_Est_Maint!txtMatMW4.Text.Float,V.Screen.F_Est_Maint!txtMatMW5.Text.Float,V.Local.sSQL)
					f.Intrinsic.String.Build("UPDATE GCG_3623_INVENTORY SET {0} WHERE PART = '{1}' AND LOCATION1 = '{2}' ",v.Local.sSQL,v.ODBC.Con!rstInvUp.FieldVal!Part,v.ODBC.Con!rstInvUp.FieldVal!Location,v.Local.sSQL)
					f.ODBC.Connection!Con.Execute(v.Local.sSQL)
				f.Intrinsic.Control.Else
					'not in our custom table so add it
					F.Intrinsic.String.Build(" '{0}', '{1}', '{2}', '{3}', '{4}', '{5}', '{6}', '{7}', '{8}', '{9}', '{10}', '{11}', '{12}', '{13}', '{14}', '{15}', '{16}', '{17}', '{18}', '{19}', '{20}', '{21}', '{22}', '{23}', '{24}', '{25}', '{26}', '{27}', '{28}', '{29}', '{30}', '{31}', '{32}', '{33}', '{34}', '{35}', '{36}', '{37}', '{38}', '{39}', '{40}', '{41}', '{42}', '{43}', '{44}', '{45}', '{46}', '{47}', '{48}', '{49}', '{50}', '{51}', '{52}', '{53}', '{54}' ",V.Screen.F_Est_Maint!txtMatAC.Text.PSQLFriendly,V.Screen.F_Est_Maint!txtMatSTLF.Text.Float,V.Screen.F_Est_Maint!txtMatSTHF.Text.Float,V.Screen.F_Est_Maint!txtMatMAF.Text.Float,V.Screen.F_Est_Maint!txtMatLineWeight.Text.PSQLFriendly,V.Screen.F_Est_Maint!txtMatAdType.Text.PSQLFriendly,V.Screen.F_Est_Maint!txtMatThick.Text.Float,V.Screen.F_Est_Maint!txtMatLbs.Text.Float,V.Screen.F_Est_Maint!mltMatComment.Text.PSQLFriendly,V.Screen.F_Est_Maint!txtMatGrade.Text.PSQLFriendly,V.Screen.F_Est_Maint!txtMatLineScreen.Text.Float,V.Screen.F_Est_Maint!txtMatDotSize.Text.Float,V.Screen.F_Est_Maint!txtMatFreightSur.Text.Float,V.Screen.F_Est_Maint!txtMatFaceDesc.Text.PSQLFriendly,V.Screen.F_Est_Maint!txtMatMaterialType.Text.PSQLFriendly,V.Screen.F_Est_Maint!txtMatMinOrder.Text.PSQLFriendly,V.Screen.F_Est_Maint!chkMatExact.Value,V.Screen.F_Est_Maint!txtMatMSIPrice.Text.Float,V.Screen.F_Est_Maint!txtTolACRDie.Text.PSQLFriendly,V.Screen.F_Est_Maint!txtTolACRPress.Text.PSQLFriendly,V.Screen.F_Est_Maint!txtTolACRFin.Text.PSQLFriendly,V.Screen.F_Est_Maint!txtTolStepAcross.Text.Float,V.Screen.F_Est_Maint!txtTolStepAround.Text.Float,V.Screen.F_Est_Maint!txtTolCavAcross.Text.Long,V.Screen.F_Est_Maint!txtTolCavAround.Text.Long,V.Screen.F_Est_Maint!txtTolCorner.Text.Float,V.Screen.F_Est_Maint!txtTolToothSize.Text.Float,V.Screen.F_Est_Maint!txtTolShape.Text.PSQLFriendly,V.Screen.F_Est_Maint!txtTolShapeDesc.Text.PSQLFriendly,V.Screen.F_Est_Maint!txtTolUsed.Text.PSQLFriendly,V.Screen.F_Est_Maint!txtTolStatus.Text.PSQLFriendly,V.Screen.F_Est_Maint!txtTolToolNum.Text.Float,V.Screen.F_Est_Maint!txtTolInternalLblWidth.Text.Float,V.Screen.F_Est_Maint!txtTolInternalLblLength.Text.Float,V.Screen.F_Est_Maint!txtTolInternalLblNum.Text.Float,V.Screen.F_Est_Maint!txtTolWasteEdge.Text.Float,V.Screen.F_Est_Maint!chkTolMinWaved.Value,V.Screen.F_Est_Maint!txtTolAcross.Text.Long,V.Screen.F_Est_Maint!txtTolAround.Text.Long,V.Screen.F_Est_Maint!txtTolGapAcross.Text.Float,V.Screen.F_Est_Maint!txtTolGapDown.Text.Float,V.Screen.F_Est_Maint!txtTolLinerThick.Text.PSQLFriendly,V.Screen.F_Est_Maint!txtTolLength.Text.Float,V.Screen.F_Est_Maint!txtMatPC1.Text.PSQLFriendly,V.Screen.F_Est_Maint!txtMatPC2.Text.PSQLFriendly,V.Screen.F_Est_Maint!txtMatPC3.Text.PSQLFriendly,V.Screen.F_Est_Maint!txtMatPC4.Text.PSQLFriendly,V.Screen.F_Est_Maint!txtMatPC5.Text.PSQLFriendly,V.Screen.F_Est_Maint!txtMatMW1.Text.Float,V.Screen.F_Est_Maint!txtMatMW2.Text.Float,V.Screen.F_Est_Maint!txtMatMW3.Text.Float,V.Screen.F_Est_Maint!txtMatMW4.Text.Float,V.Screen.F_Est_Maint!txtMatMW5.Text.Float,v.DataTable.RMPart(v.Local.iC).Part!FieldValTrim,v.DataTable.RMPart(v.Local.iC).Location!FieldValTrim,V.Local.sSQL)
					f.Intrinsic.String.Build("INSERT INTO GCG_3623_INVENTORY ({0}) VALUES ({1})","ADHESIVE_CODE, SERVICE_TEMP_F_LOW,SERVICE_TEMP_F_HIGH,MIN_APPLIC_F,LINER_WEIGHT,ADHESIVE_TYPE,CALIPER_THICKNESS,LBS_PER_MSI,COMMENTS,GRADE,LINE_SCREEN,DOT_SIZE,FREIGHT_SURCHARGE,FACE_SHEET_DESC,MATERIAL_TYPE,MINIMUM_ORDER,EXACT,DEFAULT_MSI,ACR_DIE,ACR_PRESS,ACR_FIN,STEP_ACROSS,STEP_AROUND,CAV_ACROSS,CAV_AROUND,CORNER_RADII,TOOTH_SIZE,SHAPE,SHAPE_DESC,MAT_USED,STATUS1,TOOL_NUMBER,INT_LBL_WIDTH,INT_LBL_LENGTH,INT_LBL_NUMOUT,WASTE_EDGE,MINIMUMS_WAVED,ACROSS,AROUND,GAP_ACROSS,GAP_DOWN,LINER_THICK,LENGTH1,PRODUCT_CODE_1,PRODUCT_CODE_2,PRODUCT_CODE_3,PRODUCT_CODE_4,PRODUCT_CODE_5,MASTER_WIDTH_1,MASTER_WIDTH_2,MASTER_WIDTH_3,MASTER_WIDTH_4,MASTER_WIDTH_5,PART,LOCATION1",V.Local.sSQL,V.Local.sSQL)
					f.ODBC.Connection!Con.Execute(v.Local.sSQL)
				f.Intrinsic.Control.EndIf
				F.ODBC.Con!rstInvUp.Close
			f.Intrinsic.Control.Next(v.Local.iC)
			
'			F.Intrinsic.String.Build("A.ADHESIVE_CODE = '{0}', A.SERVICE_TEMP_F_LOW = '{1}',A.SERVICE_TEMP_F_HIGH = '{2}',A.MIN_APPLIC_F = '{3}',A.LINER_WEIGHT = '{4}',A.ADHESIVE_TYPE = '{5}',A.CALIPER_THICKNESS = '{6}',A.LBS_PER_MSI = '{7}',A.COMMENTS = '{8}',A.GRADE = '{9}',A.LINE_SCREEN = '{10}',A.DOT_SIZE = '{11}',A.FREIGHT_SURCHARGE = '{12}',A.FACE_SHEET_DESC = '{13}',A.MATERIAL_TYPE = '{14}',A.MINIMUM_ORDER = '{15}',A.EXACT = '{16}',A.DEFAULT_MSI = '{17}',A.ACR_DIE = '{18}',A.ACR_PRESS = '{19}',A.ACR_FIN = '{20}',A.STEP_ACROSS = '{21}',A.STEP_AROUND = '{22}',A.CAV_ACROSS = '{23}',A.CAV_AROUND = '{24}',A.CORNER_RADII = '{25}',A.TOOTH_SIZE = '{26}',A.SHAPE = '{27}',A.SHAPE_DESC = '{28}',A.MAT_USED = '{29}',A.STATUS = '{30}',A.TOOL_NUMBER = '{31}',A.INT_LBL_WIDTH = '{32}',A.INT_LBL_LENGTH = '{33}',A.INT_LBL_NUMOUT = '{34}',A.WASTE_EDGE = '{35}',A.MINIMUMS_WAVED = '{36}',A.ACROSS = '{37}',A.AROUND = '{38}',A.GAP_ACROSS = '{39}',A.GAP_DOWN = '{40}',A.LINER_THICK = '{41}',A.LENGTH = '{42}',A.PRODUCT_CODE_1 = '{43}',A.PRODUCT_CODE_2 = '{44}',A.PRODUCT_CODE_3 = '{45}',A.PRODUCT_CODE_4 = '{46}',A.PRODUCT_CODE_5 = '{47}',A.MASTER_WIDTH_1 = '{48}',A.MASTER_WIDTH_2 = '{49}',A.MASTER_WIDTH_3 = '{50}',A.MASTER_WIDTH_4 = '{51}',A.MASTER_WIDTH_5 = '{52}' ",V.Screen.F_Est_Maint!txtMatAC.Text.PSQLFriendly,V.Screen.F_Est_Maint!txtMatSTLF.Text.Float,V.Screen.F_Est_Maint!txtMatSTHF.Text.Float,V.Screen.F_Est_Maint!txtMatMAF.Text.Float,V.Screen.F_Est_Maint!txtMatLineWeight.Text.PSQLFriendly,V.Screen.F_Est_Maint!txtMatAdType.Text.PSQLFriendly,V.Screen.F_Est_Maint!txtMatThick.Text.Float,V.Screen.F_Est_Maint!txtMatLbs.Text.Float,V.Screen.F_Est_Maint!mltMatComment.Text.PSQLFriendly,V.Screen.F_Est_Maint!txtMatGrade.Text.PSQLFriendly,V.Screen.F_Est_Maint!txtMatLineScreen.Text.Float,V.Screen.F_Est_Maint!txtMatDotSize.Text.Float,V.Screen.F_Est_Maint!txtMatFreightSur.Text.Float,V.Screen.F_Est_Maint!txtMatFaceDesc.Text.PSQLFriendly,V.Screen.F_Est_Maint!txtMatMaterialType.Text.PSQLFriendly,V.Screen.F_Est_Maint!txtMatMinOrder.Text.PSQLFriendly,V.Screen.F_Est_Maint!chkMatExact.Value,V.Screen.F_Est_Maint!txtMatMSIPrice.Text.Float,V.Screen.F_Est_Maint!txtTolACRDie.Text.PSQLFriendly,V.Screen.F_Est_Maint!txtTolACRPress.Text.PSQLFriendly,V.Screen.F_Est_Maint!txtTolACRFin.Text.PSQLFriendly,V.Screen.F_Est_Maint!txtTolStepAcross.Text.Float,V.Screen.F_Est_Maint!txtTolStepAround.Text.Float,V.Screen.F_Est_Maint!txtTolCavAcross.Text.Long,V.Screen.F_Est_Maint!txtTolCavAround.Text.Long,V.Screen.F_Est_Maint!txtTolCorner.Text.Float,V.Screen.F_Est_Maint!txtTolToothSize.Text.Float,V.Screen.F_Est_Maint!txtTolShape.Text.PSQLFriendly,V.Screen.F_Est_Maint!txtTolShapeDesc.Text.PSQLFriendly,V.Screen.F_Est_Maint!txtTolUsed.Text.PSQLFriendly,V.Screen.F_Est_Maint!txtTolStatus.Text.PSQLFriendly,V.Screen.F_Est_Maint!txtTolToolNum.Text.Float,V.Screen.F_Est_Maint!txtTolInternalLblWidth.Text.Float,V.Screen.F_Est_Maint!txtTolInternalLblLength.Text.Float,V.Screen.F_Est_Maint!txtTolInternalLblNum.Text.Float,V.Screen.F_Est_Maint!txtTolWasteEdge.Text.Float,V.Screen.F_Est_Maint!chkTolMinWaved.Value,V.Screen.F_Est_Maint!txtTolAcross.Text.Long,V.Screen.F_Est_Maint!txtTolAround.Text.Long,V.Screen.F_Est_Maint!txtTolGapAcross.Text.Float,V.Screen.F_Est_Maint!txtTolGapDown.Text.Float,V.Screen.F_Est_Maint!txtTolLinerThick.Text.PSQLFriendly,V.Screen.F_Est_Maint!txtTolLength.Text.Float,V.Screen.F_Est_Maint!txtMatPC1.Text.PSQLFriendly,V.Screen.F_Est_Maint!txtMatPC2.Text.PSQLFriendly,V.Screen.F_Est_Maint!txtMatPC3.Text.PSQLFriendly,V.Screen.F_Est_Maint!txtMatPC4.Text.PSQLFriendly,V.Screen.F_Est_Maint!txtMatPC5.Text.PSQLFriendly,V.Screen.F_Est_Maint!txtMatMW1.Text.Float,V.Screen.F_Est_Maint!txtMatMW2.Text.Float,V.Screen.F_Est_Maint!txtMatMW3.Text.Float,V.Screen.F_Est_Maint!txtMatMW4.Text.Float,V.Screen.F_Est_Maint!txtMatMW5.Text.Float,V.Local.sSQL)
'			f.Intrinsic.String.Build("UPDATE A SET {0} FROM GCG_3623_INVENTORY AS A RIGHT JOIN V_INVENTORY_MSTR AS B ON RTRIM(A.PART) = RTRIM(B.PART) AND ISNULL(A.LOCATION,'') = ISNULL(B.LOCATION,'') WHERE LEFT(A.PART,5) = '{1}' AND B.PRODUCT_LINE = 'RM'",v.Local.sSQL,v.Local.sPart,v.Local.sSQL)
'			f.ODBC.Connection!Con.Execute(v.Local.sSQL)
			
			'Delete all FOBs
'			f.Intrinsic.String.Build("DELETE A FROM GCG_3623_FOB_MAINT AS A RIGHT JOIN V_INVENTORY_MSTR AS B ON RTRIM(A.PART) = RTRIM(B.PART) AND ISNULL(A.LOC,'') = ISNULL(B.LOCATION,'') WHERE  LEFT(A.PART,5) = '{0}' AND B.PRODUCT_LINE = 'RM' ",V.Local.sPart,V.Local.sSQL)
'			F.ODBC.Connection!Con.Execute(V.Local.sSQL)
			f.Intrinsic.Control.For(v.Local.iC,v.DataTable.RMPart.RowCount--)
				f.Intrinsic.String.Build("DELETE FROM GCG_3623_FOB_MAINT WHERE PART = '{0}' AND LOC = '{1}' ",v.DataTable.RMPart(v.Local.iC).Part!FieldVal,v.DataTable.RMPart(v.Local.iC).Location!FieldVal,v.Local.sSQL)
				f.ODBC.Connection!Con.Execute(v.Local.sSQL)
			f.Intrinsic.Control.Next(v.Local.iC)
			
			'Now we need to add everything back to FOB
			'I think we need to loop though our FOB and insert into the table for each one.
			F.Intrinsic.String.Build("SELECT * FROM GCG_3623_FOB_MAINT WHERE RTRIM(PART) = '{0}' AND ISNULL(LOC,'') = '{1}'",V.Screen.F_Est_Maint!txtMatPart.Text.PSQLFriendly,V.Screen.F_Est_Maint!txtMatLoc.Text,V.Local.sSQL)
			f.ODBC.Connection!Con.OpenLocalRecordsetRO("rstFOB",v.Local.sSQL)
			f.Intrinsic.Control.DoUntil(v.ODBC.Con!rstFOB.EOF,=,True)
'				F.Intrinsic.String.Build("INSERT INTO GCG_3623_FOB_MAINT SELECT DISTINCT RTRIM(B.PART), IF(B.LOCATION = '','',B.LOCATION), '{0}' FROM GCG_3623_FOB_MAINT AS A RIGHT JOIN V_INVENTORY_MSTR AS B ON RTRIM(A.PART) = RTRIM(B.PART) AND ISNULL(A.LOC,'') = ISNULL(B.LOCATION,'') WHERE LEFT(B.PART,5) = '{1}' AND B.PRODUCT_LINE = 'RM' ",v.ODBC.Con!rstFOB.FieldVal!FOB,v.Local.sPart,v.Local.sSQL)
				v.Local.sTemp1.Set(v.ODBC.Con!rstFOB.FieldVal!FOB)
				f.Intrinsic.Control.For(v.Local.iC,v.DataTable.RMPart.RowCount--)
					f.Intrinsic.String.Build("INSERT INTO GCG_3623_FOB_MAINT VALUES('{0}','{1}','{2}')",V.DataTable.RMPart(v.Local.iC).Part!FieldVal,v.DataTable.RMPart(v.Local.iC).Location!FieldVal,v.Local.sTemp1,v.Local.sSQL)
					f.ODBC.Connection!Con.Execute(v.Local.sSQL)
				f.Intrinsic.Control.Next(v.Local.iC)
				f.ODBC.Con!rstFOB.MoveNext
			f.Intrinsic.Control.Loop
			f.ODBC.Con!rstFOB.Close
			
			'now we need to do save_mat_list up upcharge
		'	f.Intrinsic.String.Build("DELETE A FROM GCG_3623_UP_MAINT AS A RIGHT JOIN V_INVENTORY_MSTR AS B ON RTRIM(A.PART) = RTRIM(B.PART) AND ISNULL(A.LOC,'') = ISNULL(B.LOCATION,'') WHERE  LEFT(A.PART,5) = '{0}' AND B.PRODUCT_LINE = 'RM' ",V.Local.sPart,V.Local.sSQL)
'			F.ODBC.Connection!Con.Execute(V.Local.sSQL)
			f.Intrinsic.Control.For(v.Local.iC,v.DataTable.RMPart.RowCount--)
				f.Intrinsic.String.Build("DELETE FROM GCG_3623_UP_MAINT WHERE PART = '{0}' AND LOC = '{1}' ",v.DataTable.RMPart(v.Local.iC).Part!FieldVal,v.DataTable.RMPart(v.Local.iC).Location!FieldVal,v.Local.sSQL)
				f.ODBC.Connection!Con.Execute(v.Local.sSQL)
			f.Intrinsic.Control.Next(v.Local.iC)
			
			'Now we need to add everything back to UP
			F.Intrinsic.String.Build("SELECT * FROM GCG_3623_UP_MAINT WHERE RTRIM(PART) = '{0}' AND ISNULL(LOC,'') = '{1}'",V.Screen.F_Est_Maint!txtMatPart.Text.PSQLFriendly,V.Screen.F_Est_Maint!txtMatLoc.Text,V.Local.sSQL)
			f.ODBC.Connection!Con.OpenLocalRecordsetRO("rstUP",v.Local.sSQL)
			f.Intrinsic.Control.DoUntil(v.ODBC.Con!rstUP.EOF,=,True)
'				F.Intrinsic.String.Build("INSERT INTO GCG_3623_UP_MAINT SELECT DISTINCT RTRIM(B.PART), IF(B.LOCATION = '','',B.LOCATION), '{0}', '{1}' FROM GCG_3623_UP_MAINT AS A RIGHT JOIN V_INVENTORY_MSTR AS B ON RTRIM(A.PART) = RTRIM(B.PART) AND ISNULL(A.LOC,'') = ISNULL(B.LOCATION,'') WHERE LEFT(B.PART,5) = '{2}' AND B.PRODUCT_LINE = 'RM' ",v.ODBC.Con!rstUP.FieldVal!UP_TYPE,V.ODBC.Con!rstUP.FieldVal!UP_AMT,v.Local.sPart,v.Local.sSQL)
'				f.ODBC.Connection!Con.Execute(v.Local.sSQL)
				v.Local.sTemp1.Set(v.ODBC.Con!rstUP.FieldVal!UP_TYPE)
				v.Local.sTemp2.Set(v.ODBC.Con!rstUP.FieldVal!UP_AMT)
				f.Intrinsic.Control.For(v.Local.iC,v.DataTable.RMPart.RowCount--)
					f.Intrinsic.String.Build("INSERT INTO GCG_3623_UP_MAINT VALUES('{0}','{1}','{2}','{3}')",V.DataTable.RMPart(v.Local.iC).Part!FieldVal,v.DataTable.RMPart(v.Local.iC).Location!FieldVal,v.Local.sTemp1,v.Local.sTemp2,v.Local.sSQL)
					f.ODBC.Connection!Con.Execute(v.Local.sSQL)
				f.Intrinsic.Control.Next(v.Local.iC)
				f.ODBC.Con!rstUP.MoveNext
			f.Intrinsic.Control.Loop
			f.ODBC.Con!rstUP.Close
			
			'now we need to do save_mat_list price price
'			f.Intrinsic.String.Build("DELETE A FROM GCG_3623_PRICE_MAINT AS A RIGHT JOIN V_INVENTORY_MSTR AS B ON RTRIM(A.PART) = RTRIM(B.PART) AND ISNULL(A.LOC,'') = ISNULL(B.LOCATION,'') WHERE  LEFT(A.PART,5) = '{0}' AND B.PRODUCT_LINE = 'RM' ",V.Local.sPart,V.Local.sSQL)
'			F.ODBC.Connection!Con.Execute(V.Local.sSQL)
			f.Intrinsic.Control.For(v.Local.iC,v.DataTable.RMPart.RowCount--)
				f.Intrinsic.String.Build("DELETE FROM GCG_3623_PRICE_MAINT WHERE PART = '{0}' AND LOC = '{1}' ",v.DataTable.RMPart(v.Local.iC).Part!FieldVal,v.DataTable.RMPart(v.Local.iC).Location!FieldVal,v.Local.sSQL)
				f.ODBC.Connection!Con.Execute(v.Local.sSQL)
			f.Intrinsic.Control.Next(v.Local.iC)
			
			'Now we need to add everything back to PRICE
			F.Intrinsic.String.Build("SELECT * FROM GCG_3623_PRICE_MAINT WHERE RTRIM(PART) = '{0}' AND ISNULL(LOC,'') = '{1}'",V.Screen.F_Est_Maint!txtMatPart.Text.PSQLFriendly,V.Screen.F_Est_Maint!txtMatLoc.Text,V.Local.sSQL)
			f.ODBC.Connection!Con.OpenLocalRecordsetRO("rstPRICE",v.Local.sSQL)
			f.Intrinsic.Control.DoUntil(v.ODBC.Con!rstPRICE.EOF,=,True)
'				F.Intrinsic.String.Build("INSERT INTO GCG_3623_PRICE_MAINT SELECT DISTINCT RTRIM(B.PART), IF(B.LOCATION = '','',B.LOCATION), '{0}', '{1}' FROM GCG_3623_PRICE_MAINT AS A RIGHT JOIN V_INVENTORY_MSTR AS B ON RTRIM(A.PART) = RTRIM(B.PART) AND ISNULL(A.LOC,'') = ISNULL(B.LOCATION,'') WHERE LEFT(B.PART,5) = '{2}' AND B.PRODUCT_LINE = 'RM' ",v.ODBC.Con!rstPRICE.FieldVal!BUY_PRICE,V.ODBC.Con!rstPRICE.FieldVal!QUANTITY_BREAK,v.Local.sPart,v.Local.sSQL)
'				f.ODBC.Connection!Con.Execute(v.Local.sSQL)
				v.Local.sTemp1.Set(v.ODBC.Con!rstPRICE.FieldVal!BUY_PRICE)
				v.Local.sTemp2.Set(v.ODBC.Con!rstPRICE.FieldVal!QUANTITY_BREAK)
				f.Intrinsic.Control.For(v.Local.iC,v.DataTable.RMPart.RowCount--)
					f.Intrinsic.String.Build("INSERT INTO GCG_3623_PRICE_MAINT VALUES('{0}','{1}','{2}','{3}')",V.DataTable.RMPart(v.Local.iC).Part!FieldVal,v.DataTable.RMPart(v.Local.iC).Location!FieldVal,v.Local.sTemp1,v.Local.sTemp2,v.Local.sSQL)
					f.ODBC.Connection!Con.Execute(v.Local.sSQL)
				f.Intrinsic.Control.Next(v.Local.iC)
				f.ODBC.Con!rstPRICE.MoveNext
			f.Intrinsic.Control.Loop
			f.ODBC.Con!rstPRICE.Close
			
			f.Data.DataTable.Close("RMPart")
		f.Intrinsic.Control.EndIf
	f.Intrinsic.Control.EndIf
	f.ODBC.Con!rstCheck.Close

	'If called from Inventory don't clear screen after saving
	F.Intrinsic.Control.If(V.Caller.Hook,<>,10210)
'		F.Intrinsic.Control.CallSub(Clear,"Clear","Material")
		Gui.F_Est_Maint.lblMSave.Caption("Saved!")
		Gui.F_Est_Maint.lblTSave.Caption("Saved!")
	F.Intrinsic.Control.EndIf
F.Intrinsic.Control.Else
	'no part is selected, tell them to select a part first
	F.Intrinsic.UI.Msgbox("Please select a part first.","Warning")
	F.Intrinsic.Control.ExitSub
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("Save_Material_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	Function.Intrinsic.String.Concat("Project: GCG_3623_Custom_Maintenance.g2u",V.Ambient.Newline,V.Ambient.Newline,"Subroutine: ",V.Ambient.CurrentSubroutine,V.Ambient.NewLine,"Error Occurred ",V.Ambient.ErrorNumber," with description ",V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.CallSub(F_est_maint_unload)
Function.Intrinsic.Control.EndIf

Program.Sub.Save_Material.End

Program.Sub.BuildStyle_Types.Start
F.Intrinsic.Control.SetErrorHandler("BuildStyle_Types_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String)
V.Local.sType.Declare(String)
V.Local.sControl.Declare(String)
V.Local.iC.Declare(Long)

'Both Grids are essentially the same, so we shall set up both buildstyles in a loop.
'V.Local.sType.Set(V.Args.Type)

Gui.F_Est_Maint.gsfgEstUp.AddGridViewFromDataView("GridUp","UP","UP")
Gui.F_Est_Maint.gsfgEstFOB.AddGridViewFromDataView("GridFOB","FOB","FOB")

Gui.F_Est_Maint.gsfgEstUp.MainView("GridUp")
Gui.F_Est_Maint.gsfgEstFOB.MainView("GridFOB")

Gui.F_Est_Maint.gsfgEstUp.SetColumnProperty("GridUp","UP_NUM","Visible",False)
Gui.F_Est_Maint.gsfgEstUp.SetColumnProperty("GridUp","ACTIVE","Caption","Act")
Gui.F_Est_Maint.gsfgEstUp.SetColumnProperty("GridUp","TYPE","Caption","Type")
Gui.F_Est_Maint.gsfgEstUp.SetColumnProperty("GridUp","DESCRIPTION","Caption","Description")
Gui.F_Est_Maint.gsfgEstUp.SetColumnProperty("GridUp","ACTIVE","AllowEdit",True)
Gui.F_Est_Maint.gsfgEstUp.SetColumnProperty("GridUp","ACTIVE","ReadOnly",False)
Gui.F_Est_Maint.gsfgEstUp.SetColumnProperty("GridUp","TYPE","AllowEdit",True)
Gui.F_Est_Maint.gsfgEstUp.SetColumnProperty("GridUp","TYPE","ReadOnly",False)
Gui.F_Est_Maint.gsfgEstUp.SetColumnProperty("GridUp","DESCRIPTION","AllowEdit",True)
Gui.F_Est_Maint.gsfgEstUp.SetColumnProperty("GridUp","DESCRIPTION","ReadOnly",False)

Gui.F_Est_Maint.gsfgEstFOB.SetColumnProperty("GridFOB","FOB_NUM","Visible",False)
Gui.F_Est_Maint.gsfgEstFOB.SetColumnProperty("GridFOB","ACTIVE","Caption","Act")
Gui.F_Est_Maint.gsfgEstFOB.SetColumnProperty("GridFOB","TYPE","Caption","Type")
Gui.F_Est_Maint.gsfgEstFOB.SetColumnProperty("GridFOB","DESCRIPTION","Caption","Description")
Gui.F_Est_Maint.gsfgEstFOB.SetColumnProperty("GridFOB","ACTIVE","AllowEdit",True)
Gui.F_Est_Maint.gsfgEstFOB.SetColumnProperty("GridFOB","ACTIVE","ReadOnly",False)
Gui.F_Est_Maint.gsfgEstFOB.SetColumnProperty("GridFOB","TYPE","AllowEdit",True)
Gui.F_Est_Maint.gsfgEstFOB.SetColumnProperty("GridFOB","TYPE","ReadOnly",False)
Gui.F_Est_Maint.gsfgEstFOB.SetColumnProperty("GridFOB","DESCRIPTION","AllowEdit",True)
Gui.F_Est_Maint.gsfgEstFOB.SetColumnProperty("GridFOB","DESCRIPTION","ReadOnly",False)

''Clear Styles
'Gui.F_Est_Maint.[V.Local.sType].ClearStyle(1)
'Gui.F_Est_Maint.[V.Local.sType].ClearStyle(2)
''Set Columns and rows
'Gui.F_Est_Maint.[V.Local.sType].Cols(4)
'Gui.F_Est_Maint.[V.Local.sType].Rows(1)
'Gui.F_Est_Maint.[V.Local.sType].Rows(2)
'Gui.F_Est_Maint.[V.Local.sType].FixedRows(1)
'
''Set Column Percentages
'Gui.F_Est_Maint.[V.Local.sType].SetColumnPercentages(".1:.25:.65:.0")
'
''Style 1 Header
'Gui.F_Est_Maint.[V.Local.sType].TextMatrix(0,0,"Act")
'Gui.F_Est_Maint.[V.Local.sType].BuildStyle(1,0,"Format","Alignment",4)
'Gui.F_Est_Maint.[V.Local.sType].BuildStyle(1,0,"Type","Locked",True)
'Gui.F_Est_Maint.[V.Local.sType].BuildStyle(1,0,"FontStyle","Bold",True)
'
'Gui.F_Est_Maint.[V.Local.sType].TextMatrix(1,0,"Type")
'Gui.F_Est_Maint.[V.Local.sType].BuildStyle(1,1,"Format","Alignment",4)
'Gui.F_Est_Maint.[V.Local.sType].BuildStyle(1,1,"Type","Locked",True)
'Gui.F_Est_Maint.[V.Local.sType].BuildStyle(1,1,"FontStyle","Bold",True)
'
'Gui.F_Est_Maint.[V.Local.sType].TextMatrix(2,0,"Description")
'Gui.F_Est_Maint.[V.Local.sType].BuildStyle(1,2,"Format","Alignment",4)
'Gui.F_Est_Maint.[V.Local.sType].BuildStyle(1,2,"Type","Locked",True)
'Gui.F_Est_Maint.[V.Local.sType].BuildStyle(1,2,"FontStyle","Bold",True)
'
''Style 2 Data
'Gui.F_Est_Maint.[V.Local.sType].BuildStyle(2,0,"Type","Checkbox",)
'Gui.F_Est_Maint.[V.Local.sType].BuildStyle(2,1,"Format","Alignment",2)
'Gui.F_Est_Maint.[V.Local.sType].BuildStyle(2,2,"Format","Alignment",2)
'
''Apply styles
'Gui.F_Est_Maint.[V.Local.sType].ApplyStyle(0,1)
'Gui.F_Est_Maint.[V.Local.sType].ApplyStyle(1,2)

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("BuildStyle_Types_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	Function.Intrinsic.String.Concat("Project: GCG_3623_Custom_Maintenance.g2u",V.Ambient.Newline,V.Ambient.Newline,"Subroutine: ",V.Ambient.CurrentSubroutine,V.Ambient.NewLine,"Error Occurred ",V.Ambient.ErrorNumber," with description ",V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.CallSub(F_est_maint_unload)
Function.Intrinsic.Control.EndIf

Program.Sub.BuildStyle_Types.End

Program.Sub.Save_EstGrid.Start
F.Intrinsic.Control.SetErrorHandler("Save_EstGrid_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String)
V.Local.iBound.Declare(Long)
V.Local.sRet.Declare(String)
V.Local.sTemp.Declare(String)
V.Local.sLoad.Declare(String)
V.Local.iC.Declare(Long)
V.Local.sGrid.Declare(String)

V.Local.sGrid.Set(V.Args.Grid)

Gui.F_Est_Maint.[V.Args.Grid].Commit
V.uGlobal.uSpd.Redim(-1,-1)
F.Intrinsic.Math.Sub(V.Screen.F_Est_Maint![V.Local.sGrid].Rows,1,V.Local.iBound)
'Push each row into double delimited string to be read into UDT
F.Intrinsic.Control.For(V.Local.iC,1,V.Local.iBound,1)
	Gui.F_Est_Maint.[V.Local.sGrid].ReadRow(V.Local.iC,V.Local.sRet)
	F.Intrinsic.String.Split(V.Local.sRet,"*!*",V.Local.sTemp)

	F.Intrinsic.Control.If(V.Local.sTemp(1).Trim,<>,"")
		f.Intrinsic.Control.If(v.Local.sTemp(0),=,1)
			v.Local.sTemp(0).Set("True")
			f.Intrinsic.String.Join(v.Local.sTemp,"*!*",v.Local.sRet)
		f.Intrinsic.Control.ElseIf(v.Local.sTemp(0),=,0)
			v.Local.sTemp(0).Set("False")
			f.Intrinsic.String.Join(v.Local.sTemp,"*!*",v.Local.sRet)
		f.Intrinsic.Control.EndIf
		
		F.Intrinsic.Control.If(V.Local.sLoad,=,"")
			V.Local.sLoad.Set(V.Local.sRet)
		F.Intrinsic.Control.Else
			F.Intrinsic.String.Build("{0}{1}{2}",V.Local.sLoad,V.Ambient.NewLine,V.Local.sRet,V.Local.sLoad)
		F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.EndIf
F.Intrinsic.Control.Next(V.Local.iC)

F.Intrinsic.Variable.AddRV("sLoad",V.Local.sLoad)

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("Save_EstGrid_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	Function.Intrinsic.String.Concat("Project: GCG_3623_Custom_Maintenance.g2u",V.Ambient.Newline,V.Ambient.Newline,"Subroutine: ",V.Ambient.CurrentSubroutine,V.Ambient.NewLine,"Error Occurred ",V.Ambient.ErrorNumber," with description ",V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.CallSub(F_est_maint_unload)
Function.Intrinsic.Control.EndIf

Program.Sub.Save_EstGrid.End

Program.Sub.Add_EstGrid.Start
F.Intrinsic.Control.SetErrorHandler("Add_EstGrid_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String)
V.Local.sGrid.Declare(String)
V.Local.iRows.Declare(Long)
V.Local.sType.Declare(String)
V.Local.iBound.Declare(Long)

V.Local.sGrid.Set(V.Args.Grid)

'Check for data
Gui.F_Est_Maint.[V.Local.sGrid].Commit
V.Local.iRows.Set(V.Screen.F_Est_Maint![V.Local.sGrid].Rows)
F.Intrinsic.Math.Sub(V.Local.iRows,1,V.Local.iBound)
Gui.F_Est_Maint.[V.Local.sGrid].GetTextMatrix(1,V.Local.iBound,V.Local.sType)
'If no data entered no need to add additional row for data
F.Intrinsic.Control.If(V.Local.sType.Trim,=,"")
	F.Intrinsic.Control.ExitSub
F.Intrinsic.Control.EndIf

'If data entered, then add additional row
F.Intrinsic.Math.Add(V.Screen.F_Est_Maint![V.Local.sGrid].Rows,1,V.Local.iBound)
Gui.F_Est_Maint.[V.Local.sGrid].Rows(V.Local.iBound)
Gui.F_Est_Maint.[V.Local.sGrid].ApplyStyle(V.Local.iRows,2)

'if adding to Speed grid update its values and ID
F.Intrinsic.Control.If(V.Local.sGrid,=,"gsfgEstSpd")
	Gui.F_Est_Maint.[V.Local.sGrid].TextMatrix(1,V.Local.iRows,0)
	Gui.F_Est_Maint.[V.Local.sGrid].TextMatrix(2,V.Local.iRows,0)
	'Update ID
	F.Intrinsic.Math.Add(V.Global.iID,1,V.Global.iID)
	Gui.F_Est_Maint.[V.Local.sGrid].TextMatrix(3,V.Local.iRows,V.Global.iID)
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("Add_EstGrid_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	Function.Intrinsic.String.Concat("Project: GCG_3623_Custom_Maintenance.g2u",V.Ambient.Newline,V.Ambient.Newline,"Subroutine: ",V.Ambient.CurrentSubroutine,V.Ambient.NewLine,"Error Occurred ",V.Ambient.ErrorNumber," with description ",V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.CallSub(F_est_maint_unload)
Function.Intrinsic.Control.EndIf

Program.Sub.Add_EstGrid.End

Program.Sub.Load_FOBUP.Start
F.Intrinsic.Control.SetErrorHandler("Load_FOBUP_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String)
V.Local.sSQL.Declare(String)
V.Local.sType.Declare(String)
V.Local.iRows.Declare(Long)

V.Local.sType.Set(V.Args.Type)

'Hide Flexgrid
'Gui.F_Est_Maint.gsfgEst[V.Local.sType].Visible(False)


F.Intrinsic.String.Build("SELECT ACTIVE,RTRIM(TYPE1) AS TYPE,RTRIM(DESCRIPTION) AS DESCRIPTION,{0}_NUM FROM GCG_3623_{0}_MASTER ORDER BY {0}_NUM",V.Local.sType,V.Local.sSQL)
f.Data.DataTable.CreateFromSQL(V.Local.sType,"Con",v.Local.sSQL,True)
f.Data.DataView.Create(v.Local.sType,v.Local.sType)
'F.ODBC.Connection!Con.OpenLocalRecordsetRW("rstType",V.Local.sSQL)
''Load Grid
'F.Intrinsic.Control.If(V.ODBC.Con!rstType.EOF,<>,True)
'	Gui.F_Est_Maint.gsfgEst[V.Local.sType].LoadRecordset("con!rstType",2,False)
'F.Intrinsic.Control.EndIf
'
'F.ODBC.Con!rstType.Close

'Hide Flexgrid
'Gui.F_Est_Maint.gsfgEst[V.Local.sType].Visible(True)

'Update extra row at end for user to enter data
'F.Intrinsic.Math.Sub(V.Screen.F_Est_Maint!gsfgEst[V.Local.sType].Rows,1,V.Local.iRows)
'Gui.F_Est_Maint.gsfgEst[V.local.sType].ApplyStyle(V.Local.iRows,2)

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("Load_FOBUP_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	Function.Intrinsic.String.Concat("Project: GCG_3623_Custom_Maintenance.g2u",V.Ambient.Newline,V.Ambient.Newline,"Subroutine: ",V.Ambient.CurrentSubroutine,V.Ambient.NewLine,"Error Occurred ",V.Ambient.ErrorNumber," with description ",V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.CallSub(F_est_maint_unload)
Function.Intrinsic.Control.EndIf

Program.Sub.Load_FOBUP.End

Program.Sub.Load_Material.Start
F.Intrinsic.Control.SetErrorHandler("Load_Material_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String)

'Load FOB list
F.Intrinsic.Control.CallSub(Load_mat_fob)
'Load Upcharge Drop down list
F.Intrinsic.Control.CallSub(Load_mat_up)

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("Load_Material_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	Function.Intrinsic.String.Concat("Project: GCG_3623_Custom_Maintenance.g2u",V.Ambient.Newline,V.Ambient.Newline,"Subroutine: ",V.Ambient.CurrentSubroutine,V.Ambient.NewLine,"Error Occurred ",V.Ambient.ErrorNumber," with description ",V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.CallSub(F_est_maint_unload)
Function.Intrinsic.Control.EndIf

Program.Sub.Load_Material.End

Program.Sub.Load_Mat_FOB.Start
F.Intrinsic.Control.SetErrorHandler("Load_Mat_FOB_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String)
V.Local.sFOB.Declare(String)
V.Local.sKey.Declare(String)
V.Local.sSQL.Declare(String)
v.Local.bExist.Declare(Boolean)

'Clear All items in list if any exist
Gui.F_Est_Maint.lvwMatFOB.ClearItems

Gui.F_Est_Maint.lvwMatFOB.Visible(False)

'Give FOB list checkboxes
Gui.F_Est_Maint.lvwMatFOB.Checkboxes(True)
'Get data
F.ODBC.Connection!Con.OpenLocalRecordsetRO("rstFOB","SELECT TYPE1 + ' ' + DESCRIPTION AS FOB,FOB_NUM FROM GCG_3623_FOB_MASTER WHERE ACTIVE = 1 ORDER BY FOB_NUM ASC")
'For each FOB add to list
F.Intrinsic.Control.DoUntil(V.ODBC.Con!rstFOB.EOF,=,True)
	V.Local.sFOB.Set(V.ODBC.Con!rstFOB.FieldValTrim!FOB)
	V.Local.sKey.Set(V.ODBC.Con!rstFOB.FieldValTrim!FOB_NUM)
	Gui.F_Est_Maint.lvwMatFOB.AddListItem(V.Local.sKey,V.Local.sFOB)
	F.ODBC.Con!rstFOB.MoveNext
F.Intrinsic.Control.Loop

F.ODBC.Con!rstFOB.Close

Gui.F_Est_Maint.lvwMatFOB.Visible(True)

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("Load_Mat_FOB_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	Function.Intrinsic.String.Concat("Project: GCG_3623_Custom_Maintenance.g2u",V.Ambient.Newline,V.Ambient.Newline,"Subroutine: ",V.Ambient.CurrentSubroutine,V.Ambient.NewLine,"Error Occurred ",V.Ambient.ErrorNumber," with description ",V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.CallSub(F_est_maint_unload)
Function.Intrinsic.Control.EndIf

Program.Sub.Load_Mat_FOB.End

Program.Sub.Load_Mat_UP.Start
F.Intrinsic.Control.SetErrorHandler("Load_Mat_UP_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String)

'Clear all items in flexgrid to load in the active fields
Gui.F_Est_Maint.ddlMatUpcharge.ClearItems
'Add in empty selection criteria
Gui.F_Est_Maint.ddlMatUpcharge.AddItem("")
'Get all active types and add them to the drop down list
F.ODBC.Connection!Con.OpenLocalRecordsetRO("rstUP","SELECT TYPE1 AS TYPE FROM GCG_3623_UP_MASTER WHERE ACTIVE = 1")

F.Intrinsic.Control.DoUntil(V.ODBC.Con!rstUP.EOF,=,True)
	Gui.F_Est_Maint.ddlMatUpcharge.AddItem(V.ODBC.Con!rstUP.FieldValTrim!Type)
	F.ODBC.Con!rstUP.MoveNext
F.Intrinsic.Control.Loop

F.ODBC.Con!rstUP.Close

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("Load_Mat_UP_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	Function.Intrinsic.String.Concat("Project: GCG_3623_Custom_Maintenance.g2u",V.Ambient.Newline,V.Ambient.Newline,"Subroutine: ",V.Ambient.CurrentSubroutine,V.Ambient.NewLine,"Error Occurred ",V.Ambient.ErrorNumber," with description ",V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.CallSub(F_est_maint_unload)
Function.Intrinsic.Control.EndIf

Program.Sub.Load_Mat_UP.End

Program.Sub.Add_Mat_List_Item.Start
F.Intrinsic.Control.SetErrorHandler("Add_Mat_List_Item_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String)
V.Local.bExist.Declare(Boolean,False)
V.Local.sKey.Declare(String)

'Check to make sure a part has been selected
F.Intrinsic.Control.If(V.Screen.F_Est_Maint!txtMatPart.Text,<>,"")
	'If price is being added clear out the text boxes for price and quantity
	F.Intrinsic.Control.If(V.Args.Control,=,"Price")
		Gui.F_Est_Maint.txtMatPrice.Text(0)
		Gui.F_Est_Maint.txtMatQty.Text(0)
		'Build key for Price, since the two columns should be the key for it
		F.Intrinsic.String.Build("{0} {1}",V.Args.Col1,V.Args.Col2,V.Local.sKey)
		'Check if Key exists
		Gui.F_Est_Maint.lvwmat[V.Args.Control].KeyExist(V.Local.sKey,V.Local.bExist)
		'If the key exists then do nothing
		F.Intrinsic.Control.If(V.Local.bExist,=,True)
			F.Intrinsic.Control.ExitSub
		F.Intrinsic.Control.EndIf
	'Else clear Upcharge fields
	F.Intrinsic.Control.Else
		Gui.F_Est_Maint.ddlMatUpcharge.Text("")
		Gui.F_Est_Maint.txtMatUpAmt.Text("")
		'Set key to column 1 for UP
		V.Local.sKey.Set(V.Args.Col1)
		'Check if the key already exists
		Gui.F_Est_Maint.lvwMat[V.Args.Control].KeyExist(V.Local.sKey,V.Local.bExist)
	F.Intrinsic.Control.EndIf

	F.Intrinsic.Control.If(V.Local.bExist,<>,True)
		Gui.F_Est_Maint.lvwMat[V.Args.Control].AddListItem(V.Local.sKey,V.Args.Col1)
		Gui.F_Est_Maint.lvwMat[V.Args.Control].SetListItemSubItemText(V.Local.sKey,1,V.Args.Col2)
	F.Intrinsic.Control.Else
		'Simply update the amount
		Gui.F_Est_Maint.lvwmat[V.Args.Control].SetListItemSubItemText(V.Local.sKey,1,V.Args.Col2)
	F.Intrinsic.Control.EndIf
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("Add_Mat_List_Item_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	Function.Intrinsic.String.Concat("Project: GCG_3623_Custom_Maintenance.g2u",V.Ambient.Newline,V.Ambient.Newline,"Subroutine: ",V.Ambient.CurrentSubroutine,V.Ambient.NewLine,"Error Occurred ",V.Ambient.ErrorNumber," with description ",V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.CallSub(F_est_maint_unload)
Function.Intrinsic.Control.EndIf

Program.Sub.Add_Mat_List_Item.End

Program.Sub.Remove_Mat_List_Item.Start
F.Intrinsic.Control.SetErrorHandler("Remove_Mat_List_Item_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String)
V.Local.sKey.Declare(String)
V.Local.iOrd.Declare(Long)

'Get Selected Item
Gui.F_Est_Maint.lvwMat[V.Args.Control].RetrieveSelectedListItems(V.Local.sKey)
'Check to make sure a row is selected
F.Intrinsic.Control.If(V.Local.sKey,<>,"***NORETURN***")
	'Remove Selected Row
	Gui.F_Est_Maint.lvwMat[V.Args.Control].RemoveItem(V.Local.sKey)
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("Remove_Mat_List_Item_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	Function.Intrinsic.String.Concat("Project: GCG_3623_Custom_Maintenance.g2u",V.Ambient.Newline,V.Ambient.Newline,"Subroutine: ",V.Ambient.CurrentSubroutine,V.Ambient.NewLine,"Error Occurred ",V.Ambient.ErrorNumber," with description ",V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.CallSub(F_est_maint_unload)
Function.Intrinsic.Control.EndIf

Program.Sub.Remove_Mat_List_Item.End

Program.Sub.Save_Mat_List.Start
F.Intrinsic.Control.SetErrorHandler("Save_Mat_List_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String)
V.Local.sRows.Declare(String)
V.Local.sRow.Declare(String)
V.Local.iC.Declare(Long)
V.Local.sSQL.Declare(String)

'Delete all records from table for the selected part
F.Intrinsic.String.Build("DELETE FROM GCG_3623_{0}_MAINT WHERE RTRIM(PART) = '{1}' AND ISNULL(LOC,'') = '{2}'",V.Args.Table,V.Screen.F_Est_Maint!txtMatPart.Text.PSQLFriendly,V.Screen.F_Est_Maint!txtMatLoc.Text,V.Local.sSQL)
F.ODBC.Connection!Con.Execute(V.Local.sSQL)

'Get All List Items
V.Local.sRows.Set(V.Screen.F_Est_Maint!lvwMat[V.Args.Control].ListViewContents)
'Check to make sure there were items in the list
F.Intrinsic.Control.If(V.Local.sRows.Trim,<>,"")
	'Split return string to get individual rows
	F.Intrinsic.String.Split(V.Local.sRows,"$@$",V.Local.sRows)
	'For each row, split and save data to table
	F.Intrinsic.Control.For(V.Local.iC,0,V.Local.sRows.UBound,1)
		'Split Row values up
		F.Intrinsic.String.Split(V.Local.sRows(V.Local.iC),"*!*",V.Local.sRow)
		'Set SQL to upload data
		F.Intrinsic.String.Build("INSERT INTO GCG_3623_{0}_MAINT VALUES('{1}','{2}','{3}','{4}')",V.Args.Table,V.Screen.F_Est_Maint!txtMatPart.Text.PSQLFriendly,V.Screen.F_Est_Maint!txtMatLoc.Text,V.Local.sRow(0).PSQLFriendly,V.Local.sRow(1).PSQLFriendly,V.Local.sSQL)
		F.ODBC.Connection!Con.Execute(V.Local.sSQL)
	F.Intrinsic.Control.Next(V.Local.iC)
F.Intrinsic.Control.EndIf


F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("Save_Mat_List_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	Function.Intrinsic.String.Concat("Project: GCG_3623_Custom_Maintenance.g2u",V.Ambient.Newline,V.Ambient.Newline,"Subroutine: ",V.Ambient.CurrentSubroutine,V.Ambient.NewLine,"Error Occurred ",V.Ambient.ErrorNumber," with description ",V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.CallSub(F_est_maint_unload)
Function.Intrinsic.Control.EndIf

Program.Sub.Save_Mat_List.End

Program.Sub.Load_Mat_List.Start
F.Intrinsic.Control.SetErrorHandler("Load_Mat_List_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String)
V.Local.sSQL.Declare(String)
V.Local.sRows.Declare(String)
V.Local.sData.Declare(String)
V.Local.sKey.Declare(String)
V.Local.iC.Declare(Long)

'Get all rows from table
F.Intrinsic.String.Build("SELECT * FROM GCG_3623_{0}_MAINT WHERE RTRIM(PART) = '{1}' AND ISNULL(LOC,'') = '{2}'",V.Args.Table,V.Screen.F_Est_Maint!txtMatPart.Text.PSQLFriendly,V.Screen.F_Est_Maint!txtMatLoc.Text,V.Local.sSQL)
F.ODBC.Connection!Con.ExecuteAndReturn(V.Local.sSQL,V.Local.sRows)


F.Intrinsic.Control.If(V.Local.sRows.Trim,<>,"")
	'Split the all rows into individual rows
	F.Intrinsic.String.Split(V.Local.sRows,"#$#",V.Local.sRows)
	'For each row returned loop through and add to the List
	F.Intrinsic.Control.For(V.Local.iC,0,V.Local.sRows.UBound,1)
		'Split up each row so that I can get the values to be added to the list
		F.Intrinsic.String.Split(V.Local.sRows(V.Local.iC),"*!*",V.Local.sData)
		F.Intrinsic.Control.If(V.Args.Table,=,"UP")
			'Add the item using the Upcharge type as the key
			Gui.F_Est_Maint.lvwMatUpcharge.AddListItem(V.Local.sData(2),V.Local.sData(2))
			Gui.F_Est_Maint.lvwMatUpcharge.SetListItemSubItemText(V.Local.sData(2),1,V.Local.sData(3))
		F.Intrinsic.Control.Else
			'Build key string
			F.Intrinsic.String.Build("{0} {1}",V.Local.sData(2),V.Local.sData(3),V.Local.sKey)
			'Add item to list
			Gui.F_Est_Maint.lvwMatPrice.AddListItem(V.Local.sKey,V.Local.sData(2))
			Gui.F_Est_Maint.lvwMatPrice.SetListItemSubItemText(V.Local.sKey,1,V.Local.sData(3))
		F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.Next(V.Local.iC)
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("Load_Mat_List_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	Function.Intrinsic.String.Concat("Project: GCG_3623_Custom_Maintenance.g2u",V.Ambient.Newline,V.Ambient.Newline,"Subroutine: ",V.Ambient.CurrentSubroutine,V.Ambient.NewLine,"Error Occurred ",V.Ambient.ErrorNumber," with description ",V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.CallSub(F_est_maint_unload)
Function.Intrinsic.Control.EndIf

Program.Sub.Load_Mat_List.End

Program.Sub.BuildStyle_Locks.Start
F.Intrinsic.Control.SetErrorHandler("BuildStyle_Locks_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String)
V.Local.iC.Declare(Long)

Gui.F_Est_Maint.gsfgEstLocks.Cols(2)
Gui.F_Est_Maint.gsfgEstLocks.Rows(1)
Gui.F_Est_Maint.gsfgEstLocks.Rows(2)
Gui.F_Est_Maint.gsfgEstLocks.FixedRows(1)

Gui.F_Est_Maint.gsfgEstLocks.SetColumnPercentages(".6:.4")

'Set column headers
Gui.F_Est_Maint.gsfgEstLocks.TextMatrix(0,0,"Estimator #")
Gui.F_Est_Maint.gsfgEstLocks.TextMatrix(1,0,"User")

F.Intrinsic.Control.For(V.Local.iC,0,1,1)
	'Style 1 Header row
	Gui.F_Est_Maint.gsfgEstLocks.BuildStyle(1,V.Local.iC,"Format","Alignment",4)
	Gui.F_Est_Maint.gsfgEstLocks.BuildStyle(1,V.Local.iC,"Type","Locked",True)
	Gui.F_Est_Maint.gsfgEstLocks.BuildStyle(1,V.Local.iC,"Fontstyle","Bold",True)

	'Style 2 Data
	Gui.F_Est_Maint.gsfgEstLocks.BuildStyle(2,V.Local.iC,"Format","Alignment",2)
	Gui.F_Est_Maint.gsfgEstLocks.BuildStyle(2,V.Local.iC,"Type","Locked",True)
F.Intrinsic.Control.Next(V.Local.iC)

'Apply header style
Gui.F_Est_Maint.gsfgEstLocks.ApplyStyle(0,1)

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("BuildStyle_Locks_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	Function.Intrinsic.String.Concat("Project: GCG_3623_Custom_Maintenance.g2u",V.Ambient.Newline,V.Ambient.Newline,"Subroutine: ",V.Ambient.CurrentSubroutine,V.Ambient.NewLine,"Error Occurred ",V.Ambient.ErrorNumber," with description ",V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.CallSub(F_est_maint_unload)
Function.Intrinsic.Control.EndIf

Program.Sub.BuildStyle_Locks.End

Program.Sub.Load_Locks.Start
F.Intrinsic.Control.SetErrorHandler("Load_Locks_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String)

'Redo Buildstyle
F.Intrinsic.Control.CallSub(Buildstyle_locks)
'Open Recordset
F.ODBC.Connection!Con.OpenLocalRecordsetRO("rstLocks","SELECT * FROM GCG_3623_EST_LOCK")

F.Intrinsic.Control.If(V.ODBC.Con!rstLocks.EOF,<>,True)
	'Load  Flex Grid from Query
	Gui.F_Est_Maint.gsfgEstLocks.LoadRecordset("con!rstLocks",2,False)
F.Intrinsic.Control.EndIf

F.ODBC.Con!rstLocks.Close

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("Load_Locks_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	Function.Intrinsic.String.Concat("Project: GCG_3623_Custom_Maintenance.g2u",V.Ambient.Newline,V.Ambient.Newline,"Subroutine: ",V.Ambient.CurrentSubroutine,V.Ambient.NewLine,"Error Occurred ",V.Ambient.ErrorNumber," with description ",V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.CallSub(F_est_maint_unload)
Function.Intrinsic.Control.EndIf

Program.Sub.Load_Locks.End

Program.Sub.CMDSort.Start
F.Intrinsic.Control.SetErrorHandler("CMDSort_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String)
V.Local.sSortType.Declare(String)
V.Local.sSQL.Declare(String)
V.Local.iColumnWidths.Declare(Long)
V.Local.sColumnTitles.Declare(String)
V.Local.sPL.Declare(String)
V.Local.sRet.Declare(String)

F.Intrinsic.Control.SelectCase(V.Args.ControlName)
	'Add the Sort Type to the table of Sort Types if one doesn't already exist
	F.Intrinsic.Control.Case("CMDADDSORTTYPE")
		'Check that the Sort Type isn't blank
		V.Local.sSortType.Set(V.Screen.F_Est_Maint!txtSortType.Text.Trim)
		F.Intrinsic.Control.If(V.Local.sSortType.Trim,<>,"")
			'Make sure the sort type doesn't already exist
			F.Intrinsic.String.Build("Select * FROM GCG_3623_SORT_TYPE WHERE SORT_TYPE = '{0}'",V.Local.sSortType,V.Local.sSQL)
			F.ODBC.Connection!Con.OpenLocalRecordsetRW("rstSortType",V.Local.sSQL)

			'If there is no record of it, add it, otherwise do nothing
			F.Intrinsic.Control.If(V.ODBC.Con!rstSortType.EOF,=,True)
				F.ODBC.Con!rstSortType.AddNew
				F.ODBC.Con!rstSortType.Set!SORT_TYPE(V.Local.sSortType)
				F.ODBC.Con!rstSortType.Update
				'Add the new  sort type to the drop down list
				Gui.F_Est_Maint.ddlSortType.AddItem(V.Local.sSortType)
			F.Intrinsic.Control.EndIf

			F.ODBC.Con!rstSortType.Close
			'Clear the Sort Type text box
			Gui.F_Est_Maint.txtSortType.Text("")
		F.Intrinsic.Control.EndIf
	'Check to make sure that entered in PL exists, if so then go ahead and load Sort Codes if any exist if the PL Sort Type relation exists
	F.Intrinsic.Control.Case("TXTSORTPL")
		'All we should have to do here is check the Sort Type PL combination
		F.Intrinsic.Control.CallSub(Check_sort_pl)

	'Browse from the available PL's inside Global Shop
	F.Intrinsic.Control.Case("CMDBROWSESORTPL")
		'Get list of PLs For user to choose from
		'Set Column names
		F.Intrinsic.String.Split("Product Line*!*Sort Type","*!*",V.Local.sColumnTitles)
		'Set Widths
		F.Intrinsic.String.Split("500*!*1200","*!*",V.Local.iColumnWidths)
		'Open Browser
		F.Intrinsic.UI.Browser("Product Line","con","Select P.PRODUCT_LINE,S.SORT_TYPE FROM V_PRODUCT_LINE P LEFT JOIN GCG_3623_SORTTYPE_PL S ON P.PRODUCT_LINE = S.PRODUCT_LINE",V.Local.sColumnTitles,V.Local.iColumnWidths,V.Local.sRet)

		F.Intrinsic.Control.If(V.Local.sRet,<>,"***CANCEL***")
			F.Intrinsic.String.Split(V.Local.sRet,"*!*",V.Local.sRet)
			'Set Product Line on Screen
			Gui.F_Est_Maint.txtSortPL.Text(V.Local.sRet(0))
		F.Intrinsic.Control.EndIf

		'Check to see if there is a relationship between the PL and the Sort Type
		F.Intrinsic.Control.CallSub(Check_sort_pl)

	'Save the PL relation in the table
	F.Intrinsic.Control.Case("CMDSORTSAVEPL")
		'Check to make sure that neither of the two fields are blank
		V.Local.sSortType.Set(V.Screen.F_Est_Maint!ddlSortType.Text)
		V.Local.sPL.Set(V.Screen.F_Est_Maint!txtSortPL.Text)

		F.Intrinsic.Control.If(V.Local.sSortType.Trim,<>,"--Select Sort Type--","AND",V.Local.sPL.Trim,<>,"")
			'Check to see if it's in the table already, if not then add it, otherwise do nothing
			F.Intrinsic.String.Build("SELECT * FROM GCG_3623_SORTTYPE_PL WHERE SORT_TYPE = '{0}' AND PRODUCT_LINE = '{1}'",V.Local.sSortType,V.Local.sPL,V.Local.sSQL)
			F.ODBC.Connection!Con.OpenLocalRecordsetRW("rstPL",V.Local.sSQL)

			F.Intrinsic.Control.If(V.ODBC.Con!rstPL.EOF,=,True)
				'Add the Product Line
				F.ODBC.Con!rstPL.AddNew
				F.ODBC.con!rstPL.Set!SORT_TYPE(V.Local.sSortType)
				F.ODBC.Con!rstPL.Set!PRODUCT_LINE(V.Local.sPL)
				F.ODBC.Con!rstPL.Update
				'Reset Focus
				Gui.F_Est_Maint.txtSortPL.SetFocus
				'Load the Sort Codes
				F.Intrinsic.Control.CallSub(Load_sort_code)
				'Load the PL List Again
				F.Intrinsic.Control.CallSub(Load_sort_pl)
			F.Intrinsic.Control.EndIf

			F.ODBC.Con!rstPL.Close
		F.Intrinsic.Control.EndIf

	'Load PL Sort Code information
	F.Intrinsic.Control.Case("GSFGSORTPL")
		F.Intrinsic.Control.BlockEvents
		'Check to make sure they haven't selected the header row
		F.Intrinsic.Control.If(V.Args.MouseRow,<>,0)
			'Get clicked PL
			Gui.F_Est_Maint.gsfgSortPL.GetTextMatrix(0,V.Args.MouseRow,V.Local.sPL)
			'Check to make sure the PL isn't blank
			F.Intrinsic.Control.If(V.Local.sPL.Trim,<>,"")
				'Set the PL to the selected PL
				Gui.F_Est_Maint.txtSortPL.Text(V.Local.sPL.Trim)
				'Since we know these match already call Load_Sort_Code
				F.Intrinsic.Control.CallSub(Load_sort_code)
			F.Intrinsic.Control.EndIf
		F.Intrinsic.Control.EndIf
		F.Intrinsic.Control.UnBlockEvents

	'Allows the user to remove a PL Sort type relation, this will not remove the Sort codes associated with the PL
	F.Intrinsic.Control.Case("CMDREMOVESORTPL")
		'Make sure user is sure they want to remove the PL from the Sort Type
		F.Intrinsic.UI.Msgbox("Are you sure you want to remove the Product Line from the Sort Type? This will remove all the Sort Codes from the Product Line as well.","Warning",4,V.Local.sRet)

		F.Intrinsic.Control.If(V.Local.sRet,=,6)
			F.Intrinsic.String.Build("DELETE FROM GCG_3623_SORTTYPE_PL WHERE PRODUCT_LINE = '{0}'",V.Screen.F_Est_Maint!txtSortPL.Text,V.Local.sSQL)
			F.ODBC.Connection!Con.Execute(V.Local.sSQL)

			F.Intrinsic.String.Build("DELETE FROM GCG_3623_PL_SORT WHERE PL = '{0}'",V.Screen.F_Est_Maint!txtSortPL.Text,V.Local.sSQL)
			F.ODBC.Connection!Con.Execute(V.Local.sSQL)
		F.Intrinsic.Control.EndIf

		'Set Focus
		Gui.F_Est_Maint.txtSortPL.SetFocus
		'Call recheck since it's no longer a PL of the selected type
		F.Intrinsic.Control.CallSub(Check_sort_pl)
		'Reload the PL table to reflect the removed PL
		F.Intrinsic.Control.CallSub(Load_sort_pl)

	'Allows the user to save the sort codes they've selected for the PL
	F.Intrinsic.Control.Case("CMDSAVESORTCODE")
		V.Local.sPL.Set(V.Screen.F_Est_Maint!txtSortPL.Text)
		'Open connection for saving UDT
		F.ODBC.Connection!Con.OpenLocalRecordsetRW("rstSave","Select * FROM GCG_3623_PL_SORT")
		'Delete old records
		F.Intrinsic.String.Build("DELETE FROM GCG_3623_PL_SORT WHERE PL = '{0}'",V.Local.sPL.Trim,V.Local.sSQL)
		F.ODBC.Connection!Con.Execute(V.Local.sSQL)
		'Remove blank sort codes from UDT
		F.Intrinsic.Variable.UDTMultiFlag(V.uGlobal.uSortCode!SortCode,"")
		F.Intrinsic.Variable.UDTDeleteFlagged(V.uGlobal.uSortCode)
		'Add the updated records
		F.Intrinsic.Variable.SaveUDTToRecordSet("con","rstSave","V.uGlobal.uSortCode")
		F.ODBC.Con!rstSave.Close
		'Reload grid
		F.Intrinsic.Control.CallSub(Load_sort_code)

	'Check to make sure that the sort code hasn't already been selected and add row if one is selected
	F.Intrinsic.Control.Case("GSFGSORTCODE")
		F.Intrinsic.Control.CallSub(Verify_sc_selection,"Row",V.Args.Key)

	'If value changes clear out the PL and the Sort Code list
	F.Intrinsic.Control.Case("DDLSORTTYPE")
		F.Intrinsic.Control.CallSub(Check_sort_type)


F.Intrinsic.Control.EndSelect

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("CMDSort_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	Function.Intrinsic.String.Concat("Project: GCG_3623_Custom_Maintenance.g2u",V.Ambient.Newline,V.Ambient.Newline,"Subroutine: ",V.Ambient.CurrentSubroutine,V.Ambient.NewLine,"Error Occurred ",V.Ambient.ErrorNumber," with description ",V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.CallSub(F_est_maint_unload)
Function.Intrinsic.Control.EndIf

Program.Sub.CMDSort.End

Program.Sub.Load_Sort.Start
F.Intrinsic.Control.SetErrorHandler("Load_Sort_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String)

F.Intrinsic.Control.BlockEvents
'Load Drop Down List of Sort Types
'First add a blank option
Gui.F_Est_Maint.ddlSortType.AddItem("--Select Sort Type--")
'Next get all Sort Types from table
F.ODBC.Connection!Con.OpenLocalRecordsetRW("rstSortType","Select * From GCG_3623_SORT_TYPE")

F.Intrinsic.Control.DoUntil(V.ODBC.Con!rstSortType.EOF,=,True)
	'Add Sort Type to DDL
	Gui.F_Est_Maint.ddlSortType.AddItem(V.ODBC.Con!rstSortType.FieldValTrim!SORT_TYPE)
	F.ODBC.Con!rstSortType.MoveNext
F.Intrinsic.Control.Loop

F.ODBC.Con!rstSortType.Close

'Set default ddl item
Gui.F_Est_Maint.ddlSortType.Text("--Select Sort Type--")

'Load PL Grid
F.Intrinsic.Control.CallSub(Buildstyle_pl)
F.Intrinsic.Control.UnBlockEvents

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("Load_Sort_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	Function.Intrinsic.String.Concat("Project: GCG_3623_Custom_Maintenance.g2u",V.Ambient.Newline,V.Ambient.Newline,"Subroutine: ",V.Ambient.CurrentSubroutine,V.Ambient.NewLine,"Error Occurred ",V.Ambient.ErrorNumber," with description ",V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.CallSub(F_est_maint_unload)
Function.Intrinsic.Control.EndIf

Program.Sub.Load_Sort.End

Program.Sub.Check_Sort_PL.Start
F.Intrinsic.Control.SetErrorHandler("Check_Sort_PL_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String)
V.Local.sSortType.Declare(String)
V.Local.sPL.Declare(String)
V.Local.sSQL.Declare(String)

F.Intrinsic.Control.BlockEvents

V.Local.sSortType.Set(V.Screen.F_Est_Maint!ddlSortType.Text)
V.Local.sPL.Set(V.Screen.F_Est_Maint!txtSortPL.Text)

'Check to see if the PL selected is a valid PL
F.Intrinsic.String.Build("SELECT * FROM V_PRODUCT_LINE WHERE PRODUCT_LINE = '{0}'",V.Local.sPL.Trim,V.Local.sSQL)
F.ODBC.Connection!Con.OpenLocalRecordsetRO("rstVerify",V.Local.sSQL)

F.Intrinsic.Control.If(V.ODBC.Con!rstVerify.EOF,<>,True)
	'Check to see if this PL is associated with a sort type
	F.Intrinsic.String.Build("SELECT SORT_TYPE FROM GCG_3623_SORTTYPE_PL WHERE PRODUCT_LINE = '{0}'",V.Local.sPL.Trim,V.Local.sSQL)
	F.ODBC.Connection!Con.OpenLocalRecordsetRW("rstPL",V.Local.sSQL)

	'Check to see if a record was returned
	F.Intrinsic.Control.If(V.ODBC.Con!rstPL.EOF,<>,True)
		'Check to see if the Sort Code Matches
		F.Intrinsic.Control.If(V.ODBC.Con!rstPL.FieldValTrim!SORT_TYPE,=,V.Local.sSortType.Trim)
			F.Intrinsic.Control.CallSub(Load_sort_code)
		F.Intrinsic.Control.Else
			'If they don't match then set the ddl list to the associated Sort type, don't have to update the Sort Code here because the ddl event will fire at this time
			Gui.F_Est_Maint.ddlSortType.Text(V.ODBC.Con!rstPL.FieldValTrim!SORT_TYPE)
			F.Intrinsic.Control.CallSub(Check_sort_type)
		F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.Else
		'Check to see if an option was selected
		F.Intrinsic.Control.If(V.Screen.F_Est_Maint!ddlSortType.Text,<>,"--Select Sort Type--")
			'Show the Save PL button instead of the remove PL button
			Gui.F_Est_Maint.cmdSortSavePL.Visible(True)
			Gui.F_Est_Maint.cmdRemoveSortPL.Visible(False)
		F.Intrinsic.Control.EndIf

		'Hide the Sort Code controls
		Gui.F_Est_Maint.gsfgSortCode.Visible(False)
		Gui.F_Est_Maint.cmdSaveSortCode.Visible(False)
		Gui.F_Est_Maint.lblSortCode.Visible(False)
	F.Intrinsic.Control.EndIf

	F.ODBC.Con!rstPL.Close
F.Intrinsic.Control.Else
	Gui.F_Est_Maint.txtSortPL.Text("")
F.Intrinsic.Control.EndIf

F.ODBC.Con!rstVerify.Close

F.Intrinsic.Control.UnBlockEvents

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("Check_Sort_PL_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	Function.Intrinsic.String.Concat("Project: GCG_3623_Custom_Maintenance.g2u",V.Ambient.Newline,V.Ambient.Newline,"Subroutine: ",V.Ambient.CurrentSubroutine,V.Ambient.NewLine,"Error Occurred ",V.Ambient.ErrorNumber," with description ",V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.CallSub(F_est_maint_unload)
Function.Intrinsic.Control.EndIf

Program.Sub.Check_Sort_PL.End

Program.Sub.BuildStyle_Sort_Code.Start
F.Intrinsic.Control.SetErrorHandler("BuildStyle_Sort_Code_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String)
V.Local.sSortType.Declare(String)
V.Local.sSQL.Declare(String)

'Set number of columns
Gui.F_Est_Maint.gsfgSortCode.Cols(1)
'Set number of rows
'Clear out data
Gui.F_Est_Maint.gsfgSortCode.Rows(1)
Gui.F_Est_Maint.gsfgSortCode.Rows(2)
'Set Fixed Row
Gui.F_Est_Maint.gsfgSortCode.FixedRows(1)
'Set Column Width
Gui.F_Est_Maint.gsfgSortCode.SetColumnPercentages("1")
'Set Header Text
Gui.F_Est_Maint.gsfgSortCode.TextMatrix(0,0,"Sort Code")
'Style 1 - Header
Gui.F_Est_Maint.gsfgSortCode.BuildStyle(1,0,"Format","Alignment",4)
Gui.F_Est_Maint.gsfgSortCode.BuildStyle(1,0,"Type","Locked",True)
Gui.F_Est_Maint.gsfgSortCode.BuildStyle(1,0,"FontStyle","Bold",True)

'Get data for dropdown list, we should always have at least one record, unless the PL has no Sort codes associated with it and all sort codes are already taken.
'Get the Sort Codes that haven't been used yet
F.ODBC.Connection!Con.OpenLocalRecordsetRW("rstSort","SELECT S.SORT_CODE FROM V_INV_SORT S LEFT JOIN GCG_3623_PL_SORT P ON P.SORT_CODE = S.SORT_CODE WHERE (P.SORT_CODE NOT IN (SELECT SORT_CODE FROM GCG_3623_PL_SORT))")

'Make sure we have records
F.Intrinsic.Control.DoUntil(V.ODBC.Con!rstSort.EOF,=,True)
	'We aren't worried about if it's blank because we want a blank option in the list
	F.Intrinsic.String.Build("{0}*!*{1}",V.Local.sSortType,V.ODBC.Con!rstSort.FieldValTrim!SORT_CODE,V.Local.sSortType)
	F.ODBC.Con!rstSort.MoveNext
F.Intrinsic.Control.Loop

F.ODBC.Con!rstSort.Close

'Get the Sort Codes that this PL has associated with it
F.Intrinsic.String.Build("SELECT SORT_CODE FROM GCG_3623_PL_SORT WHERE PL = '{0}'",V.Screen.F_Est_Maint!txtSortPL.Text,V.Local.sSQL)
F.ODBC.Connection!Con.OpenLocalRecordsetRW("rstSort",V.Local.sSQL)

F.Intrinsic.Control.DoUntil(V.ODBC.Con!rstSort.EOF,=,True)
	'We aren't worried about if it's blank because we want a blank option in the list
	F.Intrinsic.String.Build("{0}*!*{1}",V.Local.sSortType,V.ODBC.Con!rstSort.FieldValTrim!SORT_CODE,V.Local.sSortType)
	F.ODBC.Con!rstSort.MoveNext
F.Intrinsic.Control.Loop

'Style 2 - Data
Gui.F_Est_Maint.gsfgSortCode.BuildStyle(2,0,"Type","DropDownList",V.Local.sSortType)

'Apply header style
Gui.F_Est_Maint.gsfgSortCode.ApplyStyle(0,1)
'Apply first row in case no records exist yet
Gui.F_Est_Maint.gsfgSortCode.ApplyStyle(1,2)

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("BuildStyle_Sort_Code_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	Function.Intrinsic.String.Concat("Project: GCG_3623_Custom_Maintenance.g2u",V.Ambient.Newline,V.Ambient.Newline,"Subroutine: ",V.Ambient.CurrentSubroutine,V.Ambient.NewLine,"Error Occurred ",V.Ambient.ErrorNumber," with description ",V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.CallSub(F_est_maint_unload)
Function.Intrinsic.Control.EndIf

Program.Sub.BuildStyle_Sort_Code.End

Program.Sub.BuildStyle_PL.Start
F.Intrinsic.Control.SetErrorHandler("BuildStyle_PL_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String)

'Set Number of Columns
Gui.F_Est_Maint.gsfgSortPL.Cols(1)
'Set Number of Rows
'Clear out all data in grid
Gui.F_Est_Maint.gsfgSortPL.Rows(1)
Gui.F_Est_Maint.gsfgSortPL.Rows(2)
'Set Number of fixed Rows
Gui.F_Est_Maint.gsfgSortPL.FixedRows(1)
'Set Column percentage
Gui.F_Est_Maint.gsfgSortPL.SetColumnPercentages("1")

'Set Column name
Gui.F_Est_Maint.gsfgSortPL.TextMatrix(0,0,"PL")

'Style 1 - Header
Gui.F_Est_Maint.gsfgSortPL.BuildStyle(1,0,"FontStyle","Bold",True)
Gui.F_Est_Maint.gsfgSortPL.BuildStyle(1,0,"Format","Alignment",4)
Gui.F_Est_Maint.gsfgSortPL.BuildStyle(1,0,"Type","Locked",True)

'Style 2 - Data
Gui.F_Est_Maint.gsfgSortPL.BuildStyle(2,0,"Format","Alignment",4)
Gui.F_Est_Maint.gsfgSortPL.BuildStyle(2,0,"Type","Locked",True)

'Apply header style
Gui.F_Est_Maint.gsfgSortPL.ApplyStyle(0,1)

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("BuildStyle_PL_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	Function.Intrinsic.String.Concat("Project: GCG_3623_Custom_Maintenance.g2u",V.Ambient.Newline,V.Ambient.Newline,"Subroutine: ",V.Ambient.CurrentSubroutine,V.Ambient.NewLine,"Error Occurred ",V.Ambient.ErrorNumber," with description ",V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.CallSub(F_est_maint_unload)
Function.Intrinsic.Control.EndIf

Program.Sub.BuildStyle_PL.End

Program.Sub.txtmatloc_lostfocus.Start
F.Intrinsic.Control.SetErrorHandler("txtmatloc_lostfocus_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String)
V.Local.sSql.Declare(String)
V.Local.sPart.Declare(String)
V.Local.sLoc.Declare(String)
'Lost Focus from Material Location calls this from Material Tab
V.Local.sPart.Set(V.Screen.F_Est_Maint!txtMatPart.Text)
V.Local.sLoc.Set(V.Screen.F_Est_Maint!txtMatLoc.Text)

F.Intrinsic.Control.CallSub(Clear,"Clear","Material")
'This will populate the fields on the Material tab from both standard and custom inventory tables
F.Intrinsic.String.Build("SELECT PART,LOCATION,CODE_SORT,DESCRIPTION FROM V_INVENTORY_MSTR where Part = '{0}' and Location = '{1}' ",V.local.sPart,V.local.sLoc,V.local.sSql)
F.ODBC.Connection!Con.OpenRecordsetRO("rstMatLoad",V.Local.sSql)
F.Intrinsic.Control.If(V.ODBC.Con!rstMatLoad.EOF,<>,True)
	'if something was Valid then populate the general fields and query for the rest of the info from the custom table
	F.Intrinsic.Control.CallSub(Load_part,"Part",V.Local.sPart.Trim,"Loc",V.Local.sLoc.Trim,"Desc",V.ODBC.Con!rstMatLoad.FieldValTrim!DESCRIPTION,"SC",V.ODBC.Con!rstMatLoad.FieldValTrim!CODE_SORT)
F.Intrinsic.Control.Else
	F.Intrinsic.UI.InvokeWaitDialog("Invalid Part/Location","Invalid Part/Location")
	F.Intrinsic.UI.Sleep(1)
	F.Intrinsic.UI.CloseWaitDialog
	Gui.F_Est_Maint.txtMatPart.SetFocus
F.Intrinsic.Control.EndIf
F.ODBC.Con!rstMatLoad.Close

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("txtmatloc_lostfocus_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	Function.Intrinsic.String.Concat("Project: GCG_3623_Custom_Maintenance.g2u",V.Ambient.Newline,V.Ambient.Newline,"Subroutine: ",V.Ambient.CurrentSubroutine,V.Ambient.NewLine,"Error Occurred ",V.Ambient.ErrorNumber," with description ",V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
Function.Intrinsic.Control.EndIf


Program.Sub.txtmatloc_lostfocus.End

Program.Sub.txttolloc_lostfocus.Start
F.Intrinsic.Control.SetErrorHandler("txttolloc_lostfocus_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String)
V.Local.sSql.Declare(String)
V.Local.sPart.Declare(String)
V.Local.sLoc.Declare(String)
'Lost Focus from Material Location calls this from Material Tab
V.Local.sPart.Set(V.Screen.F_Est_Maint!txtTolPart.Text)
V.Local.sLoc.Set(V.Screen.F_Est_Maint!txtTolLoc.Text)

F.Intrinsic.Control.CallSub(Clear,"Clear","Material")
'This will populate the fields on the Material tab from both standard and custom inventory tables
F.Intrinsic.String.Build("SELECT PART,LOCATION,CODE_SORT,DESCRIPTION FROM V_INVENTORY_MSTR where Part = '{0}' and Location = '{1}' ",V.local.sPart.Trim,V.local.sLoc.Trim,V.local.sSql)
F.ODBC.Connection!Con.OpenRecordsetRO("rstMatLoad",V.Local.sSql)
F.Intrinsic.Control.If(V.ODBC.Con!rstMatLoad.EOF,<>,True)
	'if something was Valid then populate the general fields and query for the rest of the info from the custom table
	F.Intrinsic.Control.CallSub(Load_part,"Part",V.Local.sPart.Trim,"Loc",V.Local.sLoc.Trim,"Desc",V.ODBC.Con!rstMatLoad.FieldValTrim!DESCRIPTION,"SC",V.ODBC.Con!rstMatLoad.FieldValTrim!CODE_SORT)
F.Intrinsic.Control.Else
	F.Intrinsic.UI.InvokeWaitDialog("Invalid Part/Location","Invalid Part/Location")
	F.Intrinsic.UI.Sleep(1)
	F.Intrinsic.UI.CloseWaitDialog
	Gui.F_Est_Maint.txtTolPart.SetFocus
F.Intrinsic.Control.EndIf
F.ODBC.Con!rstMatLoad.Close

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("txttolloc_lostfocus_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	Function.Intrinsic.String.Concat("Project: GCG_3623_Custom_Maintenance.g2u",V.Ambient.Newline,V.Ambient.Newline,"Subroutine: ",V.Ambient.CurrentSubroutine,V.Ambient.NewLine,"Error Occurred ",V.Ambient.ErrorNumber," with description ",V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
Function.Intrinsic.Control.EndIf


Program.Sub.txttolloc_lostfocus.End

Program.Sub.Verify_SC_Selection.Start
F.Intrinsic.Control.SetErrorHandler("Verify_SC_Selection_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String)
V.Local.iC.Declare(Long)
V.Local.sSelection.Declare(String)
V.Local.sPL.Declare(String)
V.Local.sSortCompare.Declare(String)
V.Local.iUBound.Declare(Long)
V.Local.bMatch.Declare(Boolean)
V.Local.iRow.Declare(Long)

V.Local.sPL.Set(V.Screen.F_Est_Maint!txtSortPL.Text)

V.Local.iRow.Set(V.Args.Row)
'Get the selected selected Sort Code
Gui.F_Est_Maint.gsfgSortCode.GetTextMatrix(0,V.Local.iRow,V.Local.sSelection)
'Check to make sure a blank value hasn't been selected since there are allowed to be multiple blank values in the grid
F.Intrinsic.Control.If(V.Local.sSelection.Trim,<>,"")
	'Get the upper bound of the flex grid
	F.Intrinsic.Math.Sub(V.Screen.F_Est_Maint!gsfgSortCode.Rows,1,V.Local.iUBound)

	'Loop through each row in the table except the one you are currently modifying
	F.Intrinsic.Control.For(V.Local.iC,1,V.Local.iUBound,1)
		'Check to make sure the row isn't the one we are currently modifying
		F.Intrinsic.Control.If(V.Local.iC,<>,V.Local.iRow)
			'Get the current rows Sort Code to compare to the one they changed
			Gui.F_Est_Maint.gsfgSortCode.GetTextMatrix(0,V.Local.iC,V.Local.sSortCompare)
			'Check to see if the two match
			F.Intrinsic.Control.If(V.Local.sSelection,=,V.Local.sSortCompare)
				'If they are equal then set match to true
				V.Local.bMatch.Set(True)
			F.Intrinsic.Control.EndIf
		F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.Next(V.Local.iC)
F.Intrinsic.Control.EndIf

'Get UDT row
F.Intrinsic.Math.Sub(V.Local.iRow,1,V.Local.iC)

F.Intrinsic.Control.If(V.Local.bMatch,=,True)
	'Reset value
	Gui.F_Est_Maint.gsfgSortCode.TextMatrix(0,V.Local.iRow,V.uGlobal.uSortCode(V.Local.iC))
F.Intrinsic.Control.Else

	'Update the value of the changed row
	V.uGlobal.uSortCode(V.Local.iC)!SortCode.Set(V.Local.sSelection)
	'Check to see if this was the last value in the grid
	F.Intrinsic.Control.If(V.Local.iC,=,V.uGlobal.uSortCode.UBound,"AND",V.Local.sSelection.Trim,<>,"")
		'Add an additional row to the UDT
		V.uGlobal.uSortCode.RedimPreserve(0,V.Local.iRow)
		V.uGlobal.uSortCode(V.Local.iRow)!ProductLine.Set(V.Local.sPL.Trim)
		'Add an additional row to the flex grid for an additional Sort Code, add 2 since this is the final element value, need to add one for the header and one for the additional row
		F.Intrinsic.Math.Add(V.Local.iRow,2,V.Local.iUBound)
		Gui.F_Est_Maint.gsfgSortCode.Rows(V.Local.iUBound)
		'Apply style to the new row
		'Get new record ordinal
		F.Intrinsic.Math.Add(V.Local.iRow,1,V.Local.iC)
		Gui.F_Est_Maint.gsfgSortCode.ApplyStyle(V.Local.iC,2)
	F.Intrinsic.Control.EndIf
F.Intrinsic.Control.EndIf


F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("Verify_SC_Selection_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	Function.Intrinsic.String.Concat("Project: GCG_3623_Custom_Maintenance.g2u",V.Ambient.Newline,V.Ambient.Newline,"Subroutine: ",V.Ambient.CurrentSubroutine,V.Ambient.NewLine,"Error Occurred ",V.Ambient.ErrorNumber," with description ",V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.CallSub(F_est_maint_unload)
Function.Intrinsic.Control.EndIf

Program.Sub.Verify_SC_Selection.End

Program.Sub.Check_Sort_Type.Start
F.Intrinsic.Control.SetErrorHandler("Check_Sort_Type_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String)
V.Local.sSortType.Declare(String)
V.Local.sPL.Declare(String)
V.Local.sSQL.Declare(String)

F.Intrinsic.Control.BlockEvents

V.Local.sSortType.Set(V.Screen.F_Est_Maint!ddlSortType.Text)
V.Local.sPL.Set(V.Screen.F_Est_Maint!txtSortPL.Text)

'Load the PL Grid with any Product Lines associated with the Sort Type
F.Intrinsic.Control.CallSub(Load_sort_pl)

'See if the combination exists
F.Intrinsic.String.Build("SELECT * FROM GCG_3623_SORTTYPE_PL WHERE SORT_TYPE = '{0}' AND PRODUCT_LINE = '{1}'",V.Local.sSortType.Trim,V.Local.sPL.Trim,V.Local.sSQL)
F.ODBC.Connection!Con.OpenLocalRecordsetRW("rstSort",V.Local.sSQL)

'If so then load the Sort Codes
F.Intrinsic.Control.If(V.ODBC.Con!rstSort.EOF,<>,True)
	F.Intrinsic.Control.CallSub(Load_sort_code)
F.Intrinsic.Control.Else
	'Check to see if the PL is assigned to another Sort Type, if so clear out the text box
	F.Intrinsic.String.Build("SELECT * FROM GCG_3623_SORTTYPE_PL WHERE PRODUCT_LINE = '{0}'",V.Local.sPL.Trim,V.Local.sSQL)
	F.ODBC.Connection!Con.OpenLocalRecordsetRW("rstPL",V.Local.sSQL)

	F.Intrinsic.Control.If(V.ODBC.Con!rstPL.EOF,<>,True)
		Gui.F_Est_Maint.txtSortPL.Text("")
		'Show Save PL instead of Remove
		Gui.F_Est_Maint.cmdSortSavePL.Visible(True)
		Gui.F_Est_Maint.cmdRemoveSortPL.Visible(False)
	F.Intrinsic.Control.EndIf

	F.ODBC.Con!rstPL.Close
	'If no record then hide the sort code objects
	Gui.F_Est_Maint.gsfgSortCode.Visible(False)
	Gui.F_Est_Maint.lblSortCode.Visible(False)
	Gui.F_Est_Maint.cmdSaveSortCode.Visible(False)
F.Intrinsic.Control.EndIf

F.ODBC.Con!rstSort.Close

F.Intrinsic.Control.UnBlockEvents

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("Check_Sort_Type_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	Function.Intrinsic.String.Concat("Project: GCG_3623_Custom_Maintenance.g2u",V.Ambient.Newline,V.Ambient.Newline,"Subroutine: ",V.Ambient.CurrentSubroutine,V.Ambient.NewLine,"Error Occurred ",V.Ambient.ErrorNumber," with description ",V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.CallSub(F_est_maint_unload)
Function.Intrinsic.Control.EndIf

Program.Sub.Check_Sort_Type.End

Program.Sub.Load_Sort_Code.Start
F.Intrinsic.Control.SetErrorHandler("Load_Sort_Code_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String)
V.Local.sPL.Declare(String)
V.Local.iRow.Declare(Long)
V.Local.iRows.Declare(Long)
V.Local.sSQL.Declare(String)

V.Local.sPL.Set(V.Screen.F_Est_Maint!txtSortPL.Text)
V.uGlobal.uSortCode.Redim(-1,-1)

'Load BuildStyle
F.Intrinsic.Control.CallSub(Buildstyle_sort_code)
'Open Recordset to get sort codes
F.Intrinsic.String.Build("Select SORT_CODE, PL FROM GCG_3623_PL_SORT WHERE PL = '{0}' ORDER BY SORT_CODE",V.Local.sPL.Trim,V.Local.sSQL)
F.ODBC.Connection!Con.OpenLocalRecordsetRW("rstSort",V.Local.sSQL)
Gui.F_Est_Maint.gsfgSortCode.Visible(False)

F.Intrinsic.Control.If(V.ODBC.Con!rstSort.EOF,<>,True)
	F.Intrinsic.Variable.LoadUDTFromRecordset("con","rstSort","uGlobal.uSortCode",False)
	'Load grid
	Gui.F_Est_Maint.gsfgSortCode.LoadFromUDT("uGlobal.uSortCode","SORTCODE",2)
	'Add an extra row to the grid for the user to select an additional Sort Code if needed
	'Get the original number of rows since this will be the new row that needs the buildstyle applied to it
	V.Local.iRow.Set(V.Screen.F_Est_Maint!gsfgSortCode.Rows)
	F.Intrinsic.Math.Add(V.Local.iRow,1,V.Local.iRows)
	Gui.F_Est_Maint.gsfgSortCode.Rows(V.Local.iRows)
	'Apply Style
	Gui.F_Est_Maint.gsfgSortCode.ApplyStyle(V.Local.iRow,2)
	'Subtract one from the previous number of rows to get the new amount of records in the UDT
	F.Intrinsic.Math.Sub(V.Local.iRow,1,V.Local.iRows)
	'Add Blank Row to UDT for validation purposes later
	V.uGlobal.uSortCode.RedimPreserve(0,V.Local.iRows)
	'Set the Product Line of the blank record
	V.uGlobal.uSortCode(V.Local.iRows)!PRODUCTLINE.Set(V.Local.sPL.Trim)
F.Intrinsic.Control.Else
	'If no records returned then we need to add a blank row to the UDT
	V.uGlobal.uSortCode.Redim(0,0)
	'Set PL for the blank record
	V.uGlobal.uSortCode(0)!ProductLine.Set(V.Local.sPL.Trim)
F.Intrinsic.Control.EndIf

'Unhide the Sort Code Grid items
Gui.F_Est_Maint.gsfgSortCode.Visible(True)
Gui.F_Est_Maint.cmdSaveSortCode.Visible(True)
Gui.F_Est_Maint.lblSortCode.Visible(True)
'Reset focus to Add Sort Type since it doesn't have any events tied to it to avoid the Part/Loc on the other tabs geting focus
Gui.F_Est_Maint.txtSortType.SetFocus
'Unhide the Remove PL button and hide the save PL button
Gui.F_Est_Maint.cmdSortSavePL.Visible(False)
Gui.F_Est_Maint.cmdRemoveSortPL.Visible(True)

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("Load_Sort_Code_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	Function.Intrinsic.String.Concat("Project: GCG_3623_Custom_Maintenance.g2u",V.Ambient.Newline,V.Ambient.Newline,"Subroutine: ",V.Ambient.CurrentSubroutine,V.Ambient.NewLine,"Error Occurred ",V.Ambient.ErrorNumber," with description ",V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.CallSub(F_est_maint_unload)
Function.Intrinsic.Control.EndIf

Program.Sub.Load_Sort_Code.End

Program.Sub.Load_Sort_PL.Start
F.Intrinsic.Control.SetErrorHandler("Load_Sort_PL_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String)
V.Local.sSortType.Declare(String)
V.Local.iUBound.Declare(Long)
V.Local.sSQL.Declare(String)

V.Local.sSortType.Set(V.Screen.F_Est_Maint!ddlSortType.Text)

'Reset grid
Gui.F_Est_Maint.gsfgSortPL.Visible(False)
F.Intrinsic.Control.CallSub(Buildstyle_pl)

'Get all Product Lines associated with the Sort Type
F.Intrinsic.String.Build("SELECT PRODUCT_LINE FROM GCG_3623_SORTTYPE_PL WHERE SORT_TYPE = '{0}'",V.Local.sSortType.Trim,V.Local.sSQL)
F.ODBC.Connection!Con.OpenLocalRecordsetRW("rstPL",V.Local.sSQL)

F.Intrinsic.Control.If(V.ODBC.Con!rstPL.EOF,<>,True)
	Gui.F_Est_Maint.gsfgSortPL.LoadRecordset("Con!rstPL",2)
	'If there is a value, remove the additonal row at the end
	F.Intrinsic.Control.If(V.Screen.F_Est_Maint!gsfgSortPL.Rows,>,2)
		F.Intrinsic.Math.Sub(V.Screen.F_Est_Maint!gsfgSortPL.Rows,1,V.Local.iUBound)
		Gui.F_Est_Maint.gsfgSortPL.Rows(V.Local.iUBound)
	F.Intrinsic.Control.EndIf
F.Intrinsic.Control.EndIf

Gui.F_Est_Maint.gsfgSortPL.Visible(True)

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("Load_Sort_PL_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	Function.Intrinsic.String.Concat("Project: GCG_3623_Custom_Maintenance.g2u",V.Ambient.Newline,V.Ambient.Newline,"Subroutine: ",V.Ambient.CurrentSubroutine,V.Ambient.NewLine,"Error Occurred ",V.Ambient.ErrorNumber," with description ",V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.CallSub(F_est_maint_unload)
Function.Intrinsic.Control.EndIf

Program.Sub.Load_Sort_PL.End

Program.Sub.DataTableCreation.Start
F.Intrinsic.Control.SetErrorHandler("DataTableCreation_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String)

'We need to load in our datatable.
f.Data.DataTable.CreateFromSQL("OPCode","Con","SELECT CAST(IF(GCG.OPERATION1 = OP.OPERATION,1,0) AS BIT) AS Active, RTRIM(OP.OPERATION) AS OPERATION, RTRIM(OP.DESCRIPTION) AS Description, GCG.MVALUE, GCG.LVALUE FROM V_OP_CODES AS OP LEFT JOIN GCG_3623_OP_CODES AS GCG ON OP.OPERATION = GCG.OPERATION1 WHERE OP.LMO = 'C' ORDER BY OP.OPERATION ASC",True)

f.Data.DataView.Create("OPCode","OPView",22)

Gui.F_Est_Maint.GsGcOPCode.AddGridviewFromDataview("OPGrid","OPCode","OPView")
Gui.F_Est_Maint.GsGcOPCode.MainView("OPGrid")

Gui.F_Est_Maint.GsGcOPCode.SetColumnProperty("OPGrid","Active","MaxWidth",40)
Gui.F_Est_Maint.GsGcOPCode.SetColumnProperty("OPGrid","Active","ReadOnly",False)
Gui.F_Est_Maint.GsGcOPCode.SetColumnProperty("OPGrid","Active","AllowEdit",True)
Gui.F_Est_Maint.GsGcOPCode.SetColumnProperty("OPGrid","OPERATION","Caption","OP Code")
Gui.F_Est_Maint.GsGcOPCode.SetColumnProperty("OPGrid","OPERATION","MaxWidth",50)
Gui.F_Est_Maint.GsGcOPCode.SetColumnProperty("OPGrid","Description","MaxWidth",200)
Gui.F_Est_Maint.GsGcOPCode.SetColumnProperty("OPGrid","MVALUE","Caption","Material Value")
Gui.F_Est_Maint.GsGcOPCode.SetColumnProperty("OPGrid","MVALUE","MaxWidth",80)
Gui.F_Est_Maint.GsGcOPCode.SetColumnProperty("OPGrid","MVALUE","ReadOnly",False)
Gui.F_Est_Maint.GsGcOPCode.SetColumnProperty("OPGrid","MVALUE","AllowEdit",True)
Gui.F_Est_Maint.GsGcOPCode.SetColumnProperty("OPGrid","MVALUE","DisplayFormatType","Numeric")
Gui.F_Est_Maint.GsGcOPCode.SetColumnProperty("OPGrid","LVALUE","Caption","Labor Value")
Gui.F_Est_Maint.GsGcOPCode.SetColumnProperty("OPGrid","LVALUE","MaxWidth",80)
Gui.F_Est_Maint.GsGcOPCode.SetColumnProperty("OPGrid","LVALUE","ReadOnly",False)
Gui.F_Est_Maint.GsGcOPCode.SetColumnProperty("OPGrid","LVALUE","AllowEdit",True)
Gui.F_Est_Maint.GsGcOPCode.SetColumnProperty("OPGrid","LVALUE","DisplayFormatType","Numeric")

Gui.F_Est_Maint.GsGcOPCode.SetGridviewProperty("OPGrid","EnableAppearanceEvenRow",True)


F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("DataTableCreation_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	Function.Intrinsic.String.Concat("Project: GCG_3623_Custom_Maintenance.g2u",V.Ambient.Newline,V.Ambient.Newline,"Subroutine: ",V.Ambient.CurrentSubroutine,V.Ambient.NewLine,"Error Occurred ",V.Ambient.ErrorNumber," with description ",V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	f.Intrinsic.Control.CallSub(f_est_maint_unload)
Function.Intrinsic.Control.EndIf


Program.Sub.DataTableCreation.End

Program.Sub.DTSave.Start
F.Intrinsic.Control.SetErrorHandler("DTSave_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String)

'We need to save the datatable
'We first need to create a view of only the selected ones
f.Data.DataView.Create("OPCode","OPCodeSave",22,"Active = True","")
f.Data.DataView.ToDataTable("OPCode","OPCodeSave","OPCodeSave")
f.Data.DataView.Close("OPCode","OPCodeSave")

'We are going to delete everything from the table before we save it.
f.ODBC.Connection!Con.Execute("DELETE FROM GCG_3623_OP_CODES")
'Now we can save
f.Data.DataTable.SaveToDB("OPCodeSave","Con","GCG_3623_OP_CODES","OPERATION",1,"OPERATION@!@OPERATION1*!*MVALUE@!@MVALUE*!*LVALUE@!@LVALUE")

'Close the table we created to save
f.Data.DataTable.Close("OPCodeSave")


F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("DTSave_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	Function.Intrinsic.String.Concat("Project: GCG_3623_Custom_Maintenance.g2u",V.Ambient.Newline,V.Ambient.Newline,"Subroutine: ",V.Ambient.CurrentSubroutine,V.Ambient.NewLine,"Error Occurred ",V.Ambient.ErrorNumber," with description ",V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.CallSub(f_est_maint_unload)
Function.Intrinsic.Control.EndIf


Program.Sub.DTSave.End

Program.Sub.ColorCreation.Start
F.Intrinsic.Control.SetErrorHandler("ColorCreation_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String)

F.Data.DataTable.CreateFromSQL("Color","Con","SELECT * FROM GCG_3623_COLOR ORDER BY NUM_COLOR ASC",True)
f.Data.DataView.Create("Color","ColorView",22)

Gui.F_Est_Maint.GSGCColor.AddGridviewFromDataview("ColorGrid","Color","ColorView")
Gui.F_Est_Maint.GSGCColor.MainView("ColorGrid")

Gui.F_Est_Maint.GSGCColor.SetColumnProperty("ColorGrid","NUM_COLOR","MaxWidth",60)
Gui.F_Est_Maint.GSGCColor.SetColumnProperty("ColorGrid","NUM_COLOR","DisplayFormatType","Numeric")
Gui.F_Est_Maint.GSGCColor.SetColumnProperty("ColorGrid","NUM_COLOR","Caption","# Colors")
Gui.F_Est_Maint.GSGCColor.SetColumnProperty("ColorGrid","NUM_COLOR","ReadOnly",False)
Gui.F_Est_Maint.GSGCColor.SetColumnProperty("ColorGrid","NUM_COLOR","AllowEdit",True)
Gui.F_Est_Maint.GSGCColor.SetColumnProperty("ColorGrid","RW","MaxWidth",60)
Gui.F_Est_Maint.GSGCColor.SetColumnProperty("ColorGrid","RW","DisplayFormatType","Numeric")
'Gui.F_Est_Maint.GSGCColor.SetColumnProperty("ColorGrid","RW","Caption","")
Gui.F_Est_Maint.GSGCColor.SetColumnProperty("ColorGrid","RW","ReadOnly",False)
Gui.F_Est_Maint.GSGCColor.SetColumnProperty("ColorGrid","RW","AllowEdit",True)
Gui.F_Est_Maint.GSGCColor.SetColumnProperty("ColorGrid","RW_4CP","MaxWidth",60)
Gui.F_Est_Maint.GSGCColor.SetColumnProperty("ColorGrid","RW_4CP","DisplayFormatType","Numeric")
'Gui.F_Est_Maint.GSGCColor.SetColumnProperty("ColorGrid","RW_4CP","Caption","# Colors")
Gui.F_Est_Maint.GSGCColor.SetColumnProperty("ColorGrid","RW_4CP","ReadOnly",False)
Gui.F_Est_Maint.GSGCColor.SetColumnProperty("ColorGrid","RW_4CP","AllowEdit",True)
Gui.F_Est_Maint.GSGCColor.SetColumnProperty("ColorGrid","RSPD","MaxWidth",60)
Gui.F_Est_Maint.GSGCColor.SetColumnProperty("ColorGrid","RSPD","DisplayFormatType","Numeric")
'Gui.F_Est_Maint.GSGCColor.SetColumnProperty("ColorGrid","RSPD","Caption","# Colors")
Gui.F_Est_Maint.GSGCColor.SetColumnProperty("ColorGrid","RSPD","ReadOnly",False)
Gui.F_Est_Maint.GSGCColor.SetColumnProperty("ColorGrid","RSPD","AllowEdit",True)
Gui.F_Est_Maint.GSGCColor.SetColumnProperty("ColorGrid","RSPD_4CP","MaxWidth",60)
Gui.F_Est_Maint.GSGCColor.SetColumnProperty("ColorGrid","RSPD_4CP","DisplayFormatType","Numeric")
'Gui.F_Est_Maint.GSGCColor.SetColumnProperty("ColorGrid","RSPD_4CP","Caption","# Colors")
Gui.F_Est_Maint.GSGCColor.SetColumnProperty("ColorGrid","RSPD_4CP","ReadOnly",False)
Gui.F_Est_Maint.GSGCColor.SetColumnProperty("ColorGrid","RSPD_4CP","AllowEdit",True)


Gui.F_Est_Maint.GSGCColor.SetGridviewProperty("ColorGrid","EnableAppearanceEvenRow",True)

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("ColorCreation_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	Function.Intrinsic.String.Concat("Project: GCG_3623_Custom_Maintenance.g2u",V.Ambient.Newline,V.Ambient.Newline,"Subroutine: ",V.Ambient.CurrentSubroutine,V.Ambient.NewLine,"Error Occurred ",V.Ambient.ErrorNumber," with description ",V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.CallSub(f_est_maint_unload)
Function.Intrinsic.Control.EndIf
Program.Sub.ColorCreation.End

Program.Sub.cmdColorSave_Click.Start
F.Intrinsic.Control.SetErrorHandler("cmdColorSave_Click_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String)

f.Data.DataView.ToDataTableDistinct("Color","ColorView","DistColor","NUM_COLOR",True)
'if our row count is the same as our count then we can save, we don't have any duplicates
f.Intrinsic.Control.If(v.DataTable.Color.RowCount,=,v.DataTable.DistColor.RowCount)

	'We need to save the datatable
	f.Data.DataView.ToDataTable("Color","ColorView","ColorSave")
	
	'We are going to delete everything from the table before we save it.
	f.ODBC.Connection!Con.Execute("DELETE FROM GCG_3623_COLOR")
	'Now we can save
	f.Data.DataTable.SaveToDB("ColorSave","Con","GCG_3623_COLOR","NUM_COLOR",1,"NUM_COLOR@!@NUM_COLOR*!*RW@!@RW*!*RW_4CP@!@RW_4CP*!*RSPD@!@RSPD*!*RSPD_4CP@!@RSPD_4CP")
	
	'Close the table we created to save
	f.Data.DataTable.Close("ColorSave")

f.Intrinsic.Control.Else
	'we have non distinct values
	f.Intrinsic.UI.MsgBox("A Color Number has been listed twice. Values have not been saved.","Attention")
f.Intrinsic.Control.EndIf

f.Data.DataTable.Close("DistColor")

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("cmdColorSave_Click_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	Function.Intrinsic.String.Concat("Project: GCG_3623_Custom_Maintenance.g2u",V.Ambient.Newline,V.Ambient.Newline,"Subroutine: ",V.Ambient.CurrentSubroutine,V.Ambient.NewLine,"Error Occurred ",V.Ambient.ErrorNumber," with description ",V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.CallSub(f_est_maint_unload)
Function.Intrinsic.Control.EndIf
Program.Sub.cmdColorSave_Click.End

Program.Sub.MenuClick.Start
F.Intrinsic.Control.SetErrorHandler("MenuClick_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String)
v.Local.sPos.Declare(String)

f.Intrinsic.Control.SelectCase(v.Args.MenuName)
	'Color Grid
	f.Intrinsic.Control.Case("CTXCOLOR")
		f.Intrinsic.Control.SelectCase(v.Args.ItemName)
			f.Intrinsic.Control.Case("ADD")
				f.Data.DataTable.AddRow("Color")
			f.Intrinsic.Control.Case("DELETE")
				Gui.F_Est_Maint.GSGCColor.GetSelectedRows("ColorGrid",v.Local.sPos)
				'Gui.f_est_maint.gsgcolor.getselectedrowsinfocus(v.local.spos)
				f.Intrinsic.Control.If(v.Local.sPos,<>,"")
					'f.Data.DataTable.DeleteRow("Color",v.DataView.Color!ColorView(v.Local.sPos.Long).DataTableIndex)
					f.Data.DataTable.DeleteRow("Color",v.Local.sPos.Long)
					
				f.Intrinsic.Control.EndIf
		f.Intrinsic.Control.EndSelect

f.Intrinsic.Control.EndSelect



F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("MenuClick_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	Function.Intrinsic.String.Concat("Project: GCG_3623_Custom_Maintenance.g2u",V.Ambient.Newline,V.Ambient.Newline,"Subroutine: ",V.Ambient.CurrentSubroutine,V.Ambient.NewLine,"Error Occurred ",V.Ambient.ErrorNumber," with description ",V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.CallSub(f_est_maint_unload)
Function.Intrinsic.Control.EndIf
Program.Sub.MenuClick.End

Program.Sub.Comments.Start
${$0$}$$}$$}$12:00:00 AM$}$True
${$3$}$0$}$$}$0$}$-1$}$$}$12:00:00 AM$}$This will be a custom project that at time of shipment will, based on the Serial Numbers being shipped, retrieve the document control pdf.  Once the pdf are retrieved each file will be split into individual pages, the page size changed to legal, and a watermark added to the bottom right of the page that includes the Customer PO, Serial Number of Finished Goods, Sales Order Number, and Batch ID.  After the Split files are generated for all the document control PDF the user can then select either print, email, or save the collection to the shipment, and any combination can be selected.

Program.Sub.Comments.End